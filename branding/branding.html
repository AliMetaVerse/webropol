<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Branding - Webropol</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'webropol-primary': { 50: '#f0fdff', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 900: '#164e63' },
            'webropol-gray': { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 900: '#0f172a' }
          },
          fontFamily: { 'sans': ['Inter', 'system-ui', 'sans-serif'] }
        }
      }
    }
  </script>
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <script src="../design-system/components/navigation/Sidebar.js" type="module"></script>
  <script src="../design-system/components/navigation/Header.js" type="module"></script>
  <script src="../design-system/components/navigation/Breadcrumbs.js" type="module"></script>
  <script src="../design-system/components/interactive/FloatingButton.js" type="module"></script>
  <script src="../design-system/components/buttons/Button.js" type="module"></script>
  <script src="../design-system/components/forms/Input.js" type="module"></script>
</head>
<body x-data="brandingApp()" class="text-slate-900">
  <div class="flex h-screen">
    <webropol-sidebar active="branding" base="../"></webropol-sidebar>
    <div class="flex-1 flex flex-col overflow-hidden">
      <webropol-header username="Admin User" show-notifications show-help show-user-menu show-theme-selector></webropol-header>
      <div class="bg-white/70 backdrop-blur px-0 sm:px-4 border-b border-gray-200">
        <webropol-breadcrumbs trail='[{"label":"Home","url":"../index.html"},{"label":"Branding","url":"#"}]'></webropol-breadcrumbs>
      </div>
      
      <main class="flex-1 overflow-y-auto p-4 sm:p-8 space-y-8" role="main">
        
        <!-- Header Section -->
        <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
          <div>
            <h1 class="text-2xl font-bold text-webropol-gray-900">Branding Management</h1>
            <p class="text-webropol-gray-500 mt-1">Manage your organization's visual identity and templates.</p>
          </div>
          
          <!-- Admin Toggle for Demo -->
          <div class="flex items-center gap-3 bg-white p-2 rounded-lg border border-gray-200 shadow-sm">
            <span class="text-sm font-medium text-gray-600">View as:</span>
            <button @click="isAdmin = false" :class="{'bg-gray-100 text-gray-900': !isAdmin, 'text-gray-500 hover:text-gray-700': isAdmin}" class="px-3 py-1.5 rounded-md text-sm transition-colors">User</button>
            <button @click="isAdmin = true" :class="{'bg-webropol-primary-500 text-white shadow-sm': isAdmin, 'text-gray-500 hover:text-gray-700': !isAdmin}" class="px-3 py-1.5 rounded-md text-sm transition-colors font-medium">Admin</button>
          </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                <template x-for="tab in tabs" :key="tab.id">
                    <button 
                        @click="currentTab = tab.id"
                        :class="currentTab === tab.id 
                            ? 'border-webropol-primary-500 text-webropol-primary-600' 
                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                        class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2"
                    >
                        <i :class="tab.icon"></i>
                        <span x-text="tab.label"></span>
                    </button>
                </template>
            </nav>
        </div>

        <!-- Content Area -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden min-h-[400px]">
            
            <!-- GENERAL TAB (Logo & Colors) -->
            <div x-show="currentTab === 'general'"  class="p-6 space-y-8">
                <!-- Logo Section -->
                <div class="space-y-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Organization Logo</h3>
                            <p class="text-sm text-gray-500">Used on surveys, reports, and emails.</p>
                        </div>
                        <template x-if="isAdmin">
                            <webropol-button variant="secondary" icon="fa-upload" @click="$refs.logoInput.click()">Upload New</webropol-button>
                        </template>
                        <input type="file" x-ref="logoInput" class="hidden" accept="image/*" @change="handleLogoUpload">
                    </div>
                    
                    <div class="p-8 border-2 border-dashed border-gray-200 rounded-lg flex items-center justify-center bg-gray-50 min-h-[200px]">
                        <template x-if="data.logo">
                            <div class="relative group">
                                <img :src="data.logo" class="max-h-32 object-contain" alt="Brand Logo">
                                <template x-if="isAdmin">
                                    <button @click="removeLogo" class="absolute -top-2 -right-2 bg-white text-red-500 rounded-full p-1 shadow-md opacity-0 group-hover:opacity-100 transition-opacity">
                                        <i class="fa-solid fa-times-circle text-xl"></i>
                                    </button>
                                </template>
                            </div>
                        </template>
                        <template x-if="!data.logo">
                            <div class="text-center text-gray-400">
                                <i class="fa-thin fa-image text-4xl mb-2"></i>
                                <p>No logo uploaded</p>
                            </div>
                        </template>
                    </div>
                </div>

                <hr class="border-gray-100">

                <!-- Brand Colors -->
                <div class="space-y-4">
                     <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Brand Colors</h3>
                            <p class="text-sm text-gray-500">Primary colors for charts and interface elements.</p>
                        </div>
                        <template x-if="isAdmin">
                            <webropol-button variant="secondary" icon="fa-plus" @click="addColor">Add Color</webropol-button>
                        </template>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <template x-for="(color, index) in data.colors" :key="index">
                            <div class="group relative bg-white border border-gray-200 rounded-lg p-3 flex flex-col gap-2 shadow-sm hover:shadow-md transition-shadow">
                                <div class="h-16 w-full rounded-md shadow-inner" :style="`background-color: ${color}`"></div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-mono text-gray-600 uppercase" x-text="color"></span>
                                    <template x-if="isAdmin">
                                        <input type="color" x-model="data.colors[index]" @change="saveToLocalStorage" class="w-6 h-6 p-0 border-0 rounded cursor-pointer">
                                    </template>
                                </div>
                                <template x-if="isAdmin && data.colors.length > 1">
                                    <button @click="removeColor(index)" class="absolute top-1 right-1 bg-white/90 text-red-500 hover:text-red-700 rounded p-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                        <i class="fa-solid fa-trash-can"></i>
                                    </button>
                                </template>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

            <!-- DOCUMENT TEMPLATES TAB -->
            <div x-show="currentTab === 'templates'"  class="p-6 space-y-8" x-cloak>
                 <!-- Word Templates -->
                 <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
                                <i class="fa-solid fa-file-word text-blue-700"></i> Word Templates
                            </h3>
                        </div>
                        <template x-if="isAdmin">
                            <webropol-button variant="secondary" icon="fa-upload" @click="addTemplate('word')">Upload Word Template</webropol-button>
                        </template>
                    </div>
                    
                    <div class="overflow-hidden border border-gray-200 rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Template Name</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Modified</th>
                                    <th scope="col" class="relative px-6 py-3"><span class="sr-only">Actions</span></th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <template x-if="data.wordTemplates.length === 0">
                                    <tr><td colspan="3" class="px-6 py-8 text-center text-gray-500">No Word templates available.</td></tr>
                                </template>
                                <template x-for="(tpl, idx) in data.wordTemplates" :key="idx">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900" x-text="tpl.name"></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="tpl.date"></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <a href="#" class="text-webropol-primary-600 hover:text-webropol-primary-900 mr-4">Download</a>
                                            <template x-if="isAdmin">
                                                <button @click="removeTemplate('word', idx)" class="text-red-600 hover:text-red-900">Delete</button>
                                            </template>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- PPT Templates -->
                 <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
                                <i class="fa-solid fa-file-powerpoint text-orange-600"></i> PowerPoint Templates
                            </h3>
                        </div>
                        <template x-if="isAdmin">
                            <webropol-button variant="secondary" icon="fa-upload" @click="addTemplate('ppt')">Upload PPT Template</webropol-button>
                        </template>
                    </div>
                    
                    <div class="overflow-hidden border border-gray-200 rounded-lg">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Template Name</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Modified</th>
                                    <th scope="col" class="relative px-6 py-3"><span class="sr-only">Actions</span></th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <template x-if="data.pptTemplates.length === 0">
                                    <tr><td colspan="3" class="px-6 py-8 text-center text-gray-500">No PowerPoint templates available.</td></tr>
                                </template>
                                <template x-for="(tpl, idx) in data.pptTemplates" :key="idx">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900" x-text="tpl.name"></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="tpl.date"></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <a href="#" class="text-webropol-primary-600 hover:text-webropol-primary-900 mr-4">Download</a>
                                            <template x-if="isAdmin">
                                                <button @click="removeTemplate('ppt', idx)" class="text-red-600 hover:text-red-900">Delete</button>
                                            </template>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SURVEY TEMPLATES TAB -->
            <div x-show="currentTab === 'surveys'" class="p-6 space-y-6" x-cloak>
                 <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900">Survey Templates</h3>
                        <p class="text-sm text-gray-500">Pre-styled survey bases for your users.</p>
                    </div>
                    <template x-if="isAdmin">
                        <webropol-button variant="secondary" icon="fa-plus" @click="addSurveyTemplate">Create New Template</webropol-button>
                    </template>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <template x-for="(survey, idx) in data.surveyTemplates" :key="idx">
                        <div class="group border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-all">
                            <div class="h-32 bg-gray-100 flex items-center justify-center relative">
                                <i class="fa-thin fa-clipboard-list text-5xl text-gray-300"></i>
                                <div class="absolute top-2 right-2 flex gap-2" x-show="isAdmin">
                                    <button @click="removeTemplate('survey', idx)" class="bg-white text-red-500 p-2 rounded-full shadow-sm hover:bg-red-50 transition-colors">
                                        <i class="fa-solid fa-trash-can text-sm"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="p-4">
                                <h4 class="font-semibold text-gray-900" x-text="survey.name"></h4>
                                <p class="text-xs text-gray-500 mt-1" x-text="'Created: ' + survey.date"></p>
                                <div class="mt-4 flex justify-between items-center">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        Active
                                    </span>
                                    <button class="text-webropol-primary-600 hover:text-webropol-primary-800 text-sm font-medium">Preview</button>
                                </div>
                            </div>
                        </div>
                    </template>
                     <template x-if="data.surveyTemplates.length === 0">
                        <div class="col-span-full text-center py-12 text-gray-500">
                            No survey templates found.
                        </div>
                    </template>
                </div>
            </div>

             <!-- FONTS TAB -->
             <div x-show="currentTab === 'fonts'" class="p-6 space-y-6" x-cloak>
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900">Custom Fonts</h3>
                        <p class="text-sm text-gray-500">Manage custom fonts available in surveys and reports.</p>
                    </div>
                    <template x-if="isAdmin">
                        <webropol-button variant="secondary" icon="fa-font" @click="addFont">Upload Font</webropol-button>
                    </template>
                </div>

                <div class="overflow-hidden border border-gray-200 rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Font Family</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Formats</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th scope="col" class="relative px-6 py-3"><span class="sr-only">Actions</span></th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <template x-for="(font, idx) in data.fonts" :key="idx">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="h-10 w-10 flex-shrink-0 flex items-center justify-center bg-gray-100 rounded-lg text-gray-500 font-bold border border-gray-200">
                                                Aa
                                            </div>
                                            <div class="ml-4">
                                                <div class="text-sm font-medium text-gray-900" x-text="font.name"></div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="font.formats"></td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                            Installed
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <template x-if="isAdmin">
                                            <button @click="removeFont(idx)" class="text-red-600 hover:text-red-900">Remove</button>
                                        </template>
                                    </td>
                                </tr>
                            </template>
                            <template x-if="data.fonts.length === 0">
                                <tr><td colspan="4" class="px-6 py-8 text-center text-gray-500">No custom fonts installed.</td></tr>
                            </template>
                        </tbody>
                    </table>
                </div>
             </div>

        </div>

      </main>
    </div>
  </div>
  
  <webropol-floating-button position="bottom-center" theme="primary-blue" items='[]'></webropol-floating-button>

  <script>
    function brandingApp() {
        return {
            isAdmin: true, // Default to admin for demo
            currentTab: 'general',
            tabs: [
                { id: 'general', label: 'General Styling', icon: 'fa-regular fa-palette' },
                { id: 'templates', label: 'Document Templates', icon: 'fa-regular fa-file-contract' },
                { id: 'surveys', label: 'Survey Themes', icon: 'fa-regular fa-clipboard-list' },
                { id: 'fonts', label: 'Custom Fonts', icon: 'fa-regular fa-font' }
            ],
            data: {
                logo: null,
                colors: ['#06b6d4', '#0f172a', '#ffffff'],
                wordTemplates: [
                    { name: 'Corporate Report 2024.docx', date: '2024-10-15' },
                    { name: 'Letterhead.docx', date: '2023-05-20' }
                ],
                pptTemplates: [
                    { name: 'Sales Presentation.pptx', date: '2024-09-01' }
                ],
                surveyTemplates: [
                    { name: 'Employee Satisfaction', date: '2024-01-10' },
                    { name: 'Customer Feedback', date: '2024-02-15' }
                ],
                fonts: [
                     { name: 'Circular Std', formats: 'WOFF, WOFF2' }
                ]
            },

            init() {
                this.loadFromLocalStorage();
                // Watch for changes to save automatically
                this.$watch('data', () => this.saveToLocalStorage());
            },

            loadFromLocalStorage() {
                try {
                    const stored = localStorage.getItem('webropol_branding_data');
                    if (stored) {
                        // Merge with default structure to prevent errors if schematic changes
                        const parsed = JSON.parse(stored);
                        this.data = { ...this.data, ...parsed };
                    }
                } catch (e) {
                    console.error('Failed to load branding data', e);
                }
            },

            saveToLocalStorage() {
                try {
                    localStorage.setItem('webropol_branding_data', JSON.stringify(this.data));
                } catch (e) {
                    console.error('Failed to save branding data', e);
                    alert('Could not save changes (Storage full?)');
                }
            },

            // Logo methods
            handleLogoUpload(e) {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    this.data.logo = event.target.result;
                };
                reader.readAsDataURL(file);
            },
            removeLogo() {
                if(confirm('Remove logo?')) {
                    this.data.logo = null;
                }
            },

            // Color methods
            addColor() {
                this.data.colors.push('#000000');
            },
            removeColor(index) {
                this.data.colors.splice(index, 1);
            },

            // Template methods
            addTemplate(type) {
                const name = prompt(`Enter ${type.toUpperCase()} template name:`);
                if (!name) return;
                const newTpl = {
                    name: name + (type === 'word' ? '.docx' : '.pptx'),
                    date: new Date().toISOString().split('T')[0]
                };
                if (type === 'word') this.data.wordTemplates.push(newTpl);
                else this.data.pptTemplates.push(newTpl);
            },
            removeTemplate(type, index) {
                if(!confirm('Delete this template?')) return;
                if (type === 'word') this.data.wordTemplates.splice(index, 1);
                else if (type === 'ppt') this.data.pptTemplates.splice(index, 1);
                else if (type === 'survey') this.data.surveyTemplates.splice(index, 1);
            },

            addSurveyTemplate() {
                const name = prompt('Enter Survey Template name:');
                 if (!name) return;
                 this.data.surveyTemplates.push({
                     name: name,
                     date: new Date().toISOString().split('T')[0]
                 });
            },

            // Font methods
            addFont() {
                const name = prompt('Enter font family name:');
                if(!name) return;
                this.data.fonts.push({
                    name: name,
                    formats: 'WOFF2' // Simulation
                });
            },
            removeFont(index) {
                if(confirm('Remove this font?')) {
                    this.data.fonts.splice(index, 1);
                }
            }
        }
    }
  </script>
</body>
</html>
