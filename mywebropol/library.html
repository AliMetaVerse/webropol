<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question & Survey Library - Webropol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'webropol-teal': { 50: '#f0fdff', 100: '#ccf7fe', 200: '#99effd', 300: '#66e0fa', 400: '#22ccf1', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 800: '#155e75', 900: '#164e63' },
                        'webropol-gray': { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' },
                        'webropol-blue': { 50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd', 400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 800: '#1e40af', 900: '#1e3a8a' },
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        [x-cloak] {
            display: none !important;
        }

        body {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f8fafc;
            font-family: 'Inter', sans-serif;
        }

        body::-webkit-scrollbar {
            width: 6px;
        }

        body::-webkit-scrollbar-track {
            background: #f8fafc;
        }

        body::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 6px;
        }

        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }

        .hover-lift {
            transition: all 0.2s ease;
        }

        .hover-lift:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.15);
        }
    </style>
    <script src="../design-system/components/navigation/Sidebar.js" type="module"></script>
    <script src="../design-system/components/navigation/Header.js" type="module"></script>
    <script src="../design-system/components/navigation/Breadcrumbs.js" type="module"></script>
    <script src="../design-system/components/interactive/FloatingButton.js" type="module"></script>
</head>

<body class="bg-gradient-to-br from-webropol-teal-50 to-webropol-teal-50/30" style="background-color: #ebf4f7;"
    x-data="libraryApp()" @click="showContextMenu = null">

    <div class="flex h-screen">
        <webropol-sidebar active="mywebropol" base="../"></webropol-sidebar>
        <div class="flex-1 flex flex-col overflow-hidden xl:ml-0 ml-0">
            <webropol-header username="Ali Al-Zuhairi" show-notifications="true" show-help="true" show-user-menu="true"></webropol-header>
            <div class="bg-white/70 backdrop-blur px-0 sm:px-4">
                <webropol-breadcrumbs trail='[{"label":"Home","url":"../index.html"},{"label":"MyWebropol","url":"index.html"},{"label":"Library","url":"library.html"}]'></webropol-breadcrumbs>
            </div>
            <!-- Page Content -->
            <main class="flex-1 overflow-y-auto p-4 md:p-8 pb-24">
                <div class="max-w-8xl mx-auto">
                    <!-- Page Header -->
                    <div class="flex flex-col md:flex-row md:items-center justify-between mb-8">
                        <div class="flex items-center">
                            <div>
                                <h1 class="text-2xl md:text-3xl font-bold text-webropol-gray-900 mb-2">Question & Survey Library</h1>
                                <p class="text-webropol-gray-600">Manage and organize your survey questions and templates
                                </p>
                            </div>
                            
                            <!-- Kebab Menu -->
                            <div class="relative ml-4" @click.away="showLibraryMenu = false">
                                <button @click="showLibraryMenu = !showLibraryMenu"
                                        class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:hover:bg-webropol-teal-300 rounded-lg transition-all">
                                    <i class="fal fa-ellipsis-v text-base"></i>
                                </button>
                                
                                <!-- Dropdown Menu -->
                                <div x-show="showLibraryMenu" 
                                     @click.stop
                                     x-transition:enter="transition ease-out duration-100"
                                     x-transition:enter-start="transform opacity-0 scale-95"
                                     x-transition:enter-end="transform opacity-100 scale-100"
                                     x-transition:leave="transition ease-in duration-75"
                                     x-transition:leave-start="transform opacity-100 scale-100"
                                     x-transition:leave-end="transform opacity-0 scale-95"
                                     class="absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border border-webropol-gray-200 z-50">
                                    <div class="py-2">
                                        <div class="px-4 py-2 text-xs font-medium text-webropol-gray-500 uppercase tracking-wider border-b border-webropol-gray-100">
                                            Tab Layout
                                        </div>
                                        <button @click="setTabsOrientation('horizontal'); showLibraryMenu = false"
                                                :class="tabsOrientation === 'horizontal' ? 'bg-webropol-teal-50 text-webropol-teal-700' : 'text-webropol-gray-700 hover:bg-webropol-gray-50'"
                                                class="flex items-center w-full px-4 py-3 text-sm transition-colors">
                                            <i class="fa-light fa-rectangle mr-3 text-base w-4"></i>
                                            <span class="flex-1 text-left">Horizontal Layout</span>
                                            <i x-show="tabsOrientation === 'horizontal'" class="fal fa-check text-webropol-teal-600 text-sm"></i>
                                        </button>
                                        <button @click="setTabsOrientation('vertical'); showLibraryMenu = false"
                                                :class="tabsOrientation === 'vertical' ? 'bg-webropol-teal-50 text-webropol-teal-700' : 'text-webropol-gray-700 hover:bg-webropol-gray-50'"
                                                class="flex items-center w-full px-4 py-3 text-sm transition-colors">
                                            <i class="fa-light fa-rectangle-vertical mr-3 text-base-base w-4"></i>
                                            <span class="flex-1 text-left">Vertical Layout</span>
                                            <i x-show="tabsOrientation === 'vertical'" class="fal fa-check text-webropol-teal-600 text-sm"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div> 
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                        <!-- Library Folder Tree -->
                        <div class="lg:col-span-3">
                            <div
                                class="bg-white/70 backdrop-blur-sm p-6 rounded-2xl shadow-card border border-webropol-gray-200/50 hover-lift">
                                <!-- Enhanced Tab Navigation -->
                                <div :class="tabsOrientation === 'horizontal' ? 
                                    'flex items-center space-x-2 mb-6 p-1.5 bg-webropol-gray-100 rounded-xl border border-webropol-gray-200 shadow-sm' : 
                                    'flex flex-col space-y-2 mb-6 p-1.5 bg-webropol-gray-100 rounded-xl border border-webropol-gray-200 shadow-sm'">
                                    <button @click="setView('surveys')"
                                        :class="currentView === 'surveys' ? 
                                            'bg-webropol-teal-600 text-white shadow-lg shadow-webropol-teal-200/50 border-webropol-teal-600' : 
                                            'text-webropol-gray-600 hover:text-webropol-teal-700 hover:bg-white/70 border-transparent focus:bg-white focus:text-webropol-teal-700 focus:border-webropol-teal-300'"
                                        :class="tabsOrientation === 'horizontal' ? 'flex-1' : 'w-full'"
                                        class="flex items-center justify-center px-2 sm:px-4 py-3 text-xs sm:text-sm font-semibold rounded-xl transition-all duration-300 ease-out border-2 focus:outline-none focus:ring-2 focus:ring-webropol-teal-300 focus:ring-offset-2 transform hover:scale-[1.02] active:scale-[0.98]">
                                        <i class="fal fa-chart-bar mr-1 sm:mr-2"></i>
                                        <span class="hidden sm:inline">Surveys</span>
                                        <span class="sm:hidden">Survey</span>
                                        <span
                                            class="ml-1 sm:ml-2 text-xs rounded-full px-1.5 sm:px-2.5 py-1 font-semibold min-w-[1.25rem] sm:min-w-[1.5rem] text-center"
                                            :class="currentView === 'surveys' ? 
                                                'bg-white/20 text-white backdrop-blur-sm' : 
                                                'bg-webropol-gray-200 text-webropol-gray-700'"
                                            x-text="getFilteredSurveys().length"></span>
                                    </button>
                                    <button @click="setView('questions')"
                                        :class="currentView === 'questions' ? 
                                            'bg-webropol-teal-600 text-white shadow-lg shadow-webropol-teal-200/50 border-webropol-teal-600' : 
                                            'text-webropol-gray-600 hover:text-webropol-teal-700 hover:bg-white/70 border-transparent focus:bg-white focus:text-webropol-teal-700 focus:border-webropol-teal-300'"
                                        :class="tabsOrientation === 'horizontal' ? 'flex-1' : 'w-full'"
                                        class="flex items-center justify-center px-2 sm:px-4 py-3 text-xs sm:text-sm font-semibold rounded-xl transition-all duration-300 ease-out border-2 focus:outline-none focus:ring-2 focus:ring-webropol-teal-300 focus:ring-offset-2 transform hover:scale-[1.02] active:scale-[0.98]">
                                        <i class="fal fa-message-question mr-1 sm:mr-2"></i>
                                        <span class="hidden sm:inline">Questions</span>
                                        <span class="sm:hidden">Question</span>
                                        <span
                                            class="ml-1 sm:ml-2 text-xs rounded-full px-1.5 sm:px-2.5 py-1 font-semibold min-w-[1.25rem] sm:min-w-[1.5rem] text-center"
                                            :class="currentView === 'questions' ? 
                                                'bg-white/20 text-white backdrop-blur-sm' : 
                                                'bg-webropol-gray-200 text-webropol-gray-700'"
                                            x-text="getFilteredQuestions().length"></span>
                                    </button>
                                </div> <!-- Language Selection -->
                                <div class="relative mb-4">
                                    <select x-model="selectedLanguage"
                                        :disabled="currentView === 'questions'"
                                        :title="currentView === 'questions' ? 'Language for Questions is not supported' : ''"
                                        class="w-full px-4 py-3 pr-10 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent bg-white/50 backdrop-blur-sm transition-all appearance-none text-sm font-medium">
                                        <option value="en">English</option>
                                        <option value="fi">Finnish</option>
                                    </select>
                                    <i
                                        class="fal fa-chevron-down absolute right-4 top-1/2 transform -translate-y-1/2 text-webropol-gray-400 pointer-events-none"></i>
                                </div>

                                <div class="relative mb-6">
                                    <i
                                        class="fal fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-webropol-gray-400"></i>
                                    <input type="text" x-model="searchTerm"
                                        :placeholder="currentView === 'questions' ? 'Search for folders...' : 'Search for folders...'"
                                        class="w-full pl-12 pr-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent bg-white/50 backdrop-blur-sm transition-all">
                                </div>
                                <!-- Folder Management -->
                                <div class="space-y-3">
                                    <!-- Root Level Items -->
                                    <div class="space-y-2">
                                        <template x-for="folder in getFilteredFolders()" :key="folder.id">
                                            <div class="group">
                                                <!-- Main Folder Header -->
                                                <div @click="toggleFolder(folder.id)"
                                                    class="flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all duration-200"
                                                    :class="expandedFolders.includes(folder.id) ? 'bg-gradient-to-r from-webropol-teal-50 to-webropol-teal-50 text-webropol-teal-700' : 'hover:bg-webropol-gray-50'">
                                                    <div class="flex items-center">
                                                        <div class="w-8 h-8 flex items-center justify-center rounded-lg mr-3"
                                                            :class="expandedFolders.includes(folder.id) ? 'bg-webropol-teal-100' : 'bg-webropol-gray-100 group-hover:bg-webropol-teal-50'">
                                                            <i :class="folder.name === 'Organisation Library' ? 'fal fa-building text-webropol-teal-600' : 
                                                                      folder.name === 'My Templates' ? 'fal fa-file-alt text-webropol-teal-600' : 
                                                                      'fal fa-folder text-webropol-teal-600'"></i>
                                                        </div>
                                                        <span class="font-medium" x-text="folder.name"></span>
                                                    </div>
                                                    <div class="flex items-center space-x-2">
                                                        <span
                                                            class="text-xs bg-webropol-gray-200 text-webropol-gray-700 rounded-full px-2 py-1 font-medium"
                                                            x-text="getTotalFolderItemCount(folder)"></span>
                                                        <div class="relative">
                                                            <button @click.stop="toggleContextMenu('folder-' + folder.id, 'folder')"
                                                                class="opacity-0 group-hover:opacity-100 w-6 h-6 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 rounded transition-all">
                                                                <i class="fal fa-ellipsis-v text-xs"></i>
                                                            </button>
                                                            <!-- Context Menu for Main Folder -->
                                                            <div x-show="showContextMenu === 'folder-' + folder.id" 
                                                                @click.stop
                                                                x-transition:enter="transition ease-out duration-100"
                                                                x-transition:enter-start="transform opacity-0 scale-95"
                                                                x-transition:enter-end="transform opacity-100 scale-100"
                                                                x-transition:leave="transition ease-in duration-75"
                                                                x-transition:leave-start="transform opacity-100 scale-100"
                                                                x-transition:leave-end="transform opacity-0 scale-95"
                                                                class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-webropol-gray-200 z-30">
                                                                <div class="py-1">
                                                                    <button @click="openAddSubfolderModal(folder.id)"
                                                                        class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                        <i class="fal fa-folder-plus mr-3 text-black"></i>
                                                                        Add Sub Folder
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <i class="fal fa-chevron-right text-xs transition-transform"
                                                            :class="expandedFolders.includes(folder.id) ? 'rotate-90' : ''"></i>
                                                    </div>
                                                </div>

                                                <!-- Nested Subfolders -->
                                                <div x-show="expandedFolders.includes(folder.id)" x-collapse class="ml-4">
                                                    <template x-for="subfolder in folder.children" :key="subfolder.id">
                                                        <div class="mt-2">
                                                            <!-- Level 1 Subfolder -->
                                                            <div @click="toggleFolder(subfolder.id)"
                                                                class="flex items-center justify-between p-2 pl-6 rounded-lg cursor-pointer transition-all duration-200 group"
                                                                :class="expandedFolders.includes(subfolder.id) ? 'bg-gradient-to-r from-webropol-teal-50/70 to-webropol-teal-50/70 text-webropol-teal-700' : 'hover:bg-webropol-gray-50'">
                                                                <div class="flex items-center">
                                                                    <div class="w-6 h-6 flex items-center justify-center rounded-md mr-3"
                                                                        :class="expandedFolders.includes(subfolder.id) ? 'bg-webropol-teal-100' : 'bg-webropol-gray-100 group-hover:bg-webropol-teal-50'">
                                                                        <i class="fal fa-folder text-webropol-teal-600"></i>
                                                                    </div>
                                                                    <span class="text-sm font-medium" x-text="subfolder.name"></span>
                                                                </div>
                                                                <div class="flex items-center space-x-2">
                                                                    <span
                                                                        class="text-xs bg-webropol-gray-200 text-webropol-gray-700 rounded-full px-2 py-0.5 font-medium"
                                                                        x-text="getTotalFolderItemCount(subfolder)"></span>
                                                                    <div class="relative">
                                                                        <button @click.stop="toggleContextMenu('subfolder-' + subfolder.id, 'subfolder')"
                                                                            class="opacity-0 group-hover:opacity-100 w-5 h-5 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 rounded transition-all">
                                                                            <i class="fal fa-ellipsis-v text-xs"></i>
                                                                        </button>
                                                                        <!-- Context Menu for Subfolder -->
                                                                        <div x-show="showContextMenu === 'subfolder-' + subfolder.id" 
                                                                            @click.stop
                                                                            x-transition:enter="transition ease-out duration-100"
                                                                            x-transition:enter-start="transform opacity-0 scale-95"
                                                                            x-transition:enter-end="transform opacity-100 scale-100"
                                                                            x-transition:leave="transition ease-in duration-75"
                                                                            x-transition:leave-start="transform opacity-100 scale-100"
                                                                            x-transition:leave-end="transform opacity-0 scale-95"
                                                                            class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-webropol-gray-200 z-30">
                                                                            <div class="py-1">
                                                                                <button @click="openAddSubfolderModal(subfolder.id)"
                                                                                    :disabled="subfolder.level >= 3"
                                                                                    :class="subfolder.level >= 3 ? 'opacity-50 cursor-not-allowed' : ''"
                                                                                    class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                    <i class="fal fa-folder-plus mr-3 text-black"></i>
                                                                                    Add Sub Folder
                                                                                </button>
                                                                                <button @click="openMoveModal(subfolder.id, subfolder.name)"
                                                                                    class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                    <i class="fal fa-arrows mr-3 text-black"></i>
                                                                                    Move
                                                                                </button>
                                                                                <button @click="openRenameModal(subfolder.id, subfolder.name)"
                                                                                    class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                    <i class="fal fa-edit mr-3 text-black"></i>
                                                                                    Rename
                                                                                </button>
                                                                                <button @click="openDeleteConfirmationModal(subfolder.id, subfolder.name)"
                                                                                    class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-red-50 transition-colors">
                                                                                    <i class="fal fa-trash mr-3 text-black"></i>
                                                                                    Delete
                                                                                </button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <i class="fal fa-chevron-right text-xs transition-transform"
                                                                        :class="expandedFolders.includes(subfolder.id) ? 'rotate-90' : ''"></i>
                                                                </div>
                                                            </div>

                                                            <!-- Level 2 Subfolders -->
                                                            <div x-show="expandedFolders.includes(subfolder.id)" x-collapse class="ml-6">
                                                                <template x-for="subsubfolder in subfolder.children" :key="subsubfolder.id">
                                                                    <div class="mt-2">
                                                                        <!-- Level 2 Subfolder -->
                                                                        <div @click="toggleFolder(subsubfolder.id)"
                                                                            class="flex items-center justify-between p-2 pl-6 rounded-lg cursor-pointer transition-all duration-200 group"
                                                                            :class="expandedFolders.includes(subsubfolder.id) ? 'bg-gradient-to-r from-webropol-teal-50/50 to-webropol-teal-50/50 text-webropol-teal-700' : 'hover:bg-webropol-gray-50'">
                                                                            <div class="flex items-center">
                                                                                <div class="w-6 h-6 flex items-center justify-center rounded-md mr-3"
                                                                                    :class="expandedFolders.includes(subsubfolder.id) ? 'bg-webropol-teal-100' : 'bg-webropol-gray-100 group-hover:bg-webropol-teal-50'">
                                                                                    <i class="fal fa-folder text-webropol-teal-600"></i>
                                                                                </div>
                                                                                <span class="text-sm font-medium" x-text="subsubfolder.name"></span>
                                                                            </div>
                                                                            <div class="flex items-center space-x-2">
                                                                                <span
                                                                                    class="text-xs bg-webropol-gray-200 text-webropol-gray-700 rounded-full px-1.5 py-0.5 font-medium"
                                                                                    x-text="getTotalFolderItemCount(subsubfolder)"></span>
                                                                                <div class="relative">
                                                                                    <button @click.stop="toggleContextMenu('subsubfolder-' + subsubfolder.id, 'subsubfolder')"
                                                                                        class="opacity-0 group-hover:opacity-100 w-4 h-4 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 rounded transition-all">
                                                                                        <i class="fal fa-ellipsis-v text-xs"></i>
                                                                                    </button>
                                                                                    <!-- Context Menu for Level 2 Subfolder -->
                                                                                    <div x-show="showContextMenu === 'subsubfolder-' + subsubfolder.id" 
                                                                                        @click.stop
                                                                                        x-transition:enter="transition ease-out duration-100"
                                                                                        x-transition:enter-start="transform opacity-0 scale-95"
                                                                                        x-transition:enter-end="transform opacity-100 scale-100"
                                                                                        x-transition:leave="transition ease-in duration-75"
                                                                                        x-transition:leave-start="transform opacity-100 scale-100"
                                                                                        x-transition:leave-end="transform opacity-0 scale-95"
                                                                                        class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-webropol-gray-200 z-30">
                                                                                        <div class="py-1">
                                                                                            <button @click="openAddSubfolderModal(subsubfolder.id)"
                                                                                                :disabled="subsubfolder.level >= 3"
                                                                                                :class="subsubfolder.level >= 3 ? 'opacity-50 cursor-not-allowed' : ''"
                                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                                <i class="fal fa-folder-plus mr-3 text-black"></i>
                                                                                                Add Sub Folder
                                                                                            </button>
                                                                                            <button @click="openMoveModal(subsubfolder.id, subsubfolder.name)"
                                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                                <i class="fal fa-arrows mr-3 text-black"></i>
                                                                                                Move
                                                                                            </button>
                                                                                            <button @click="openRenameModal(subsubfolder.id, subsubfolder.name)"
                                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                                <i class="fal fa-edit mr-3 text-black"></i>
                                                                                                Rename
                                                                                            </button>
                                                                                            <button @click="openDeleteConfirmationModal(subsubfolder.id, subsubfolder.name)"
                                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-red-50 transition-colors">
                                                                                                <i class="fal fa-trash mr-3 text-black"></i>
                                                                                                Delete
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <i class="fal fa-chevron-right text-xs transition-transform"
                                                                                    :class="expandedFolders.includes(subsubfolder.id) ? 'rotate-90' : ''"></i>
                                                                            </div>
                                                                        </div>

                                                                        <!-- Level 3 Subfolders (Final level) -->
                                                                        <div x-show="expandedFolders.includes(subsubfolder.id)" x-collapse class="ml-6">
                                                                            <template x-for="finalfolder in subsubfolder.children" :key="finalfolder.id">
                                                                                <div class="mt-2">
                                                                                    <!-- Level 3 Subfolder (No expansion, just display) -->
                                                                                    <div class="flex items-center justify-between p-2 pl-6 rounded-lg cursor-pointer transition-all duration-200 group hover:bg-webropol-gray-50">
                                                                                        <div class="flex items-center">
                                                                                            <div class="w-6 h-6 flex items-center justify-center rounded-sm mr-3 bg-webropol-gray-100 group-hover:bg-webropol-teal-50">
                                                                                                <i class="fal fa-folder text-webropol-teal-600"></i>
                                                                                            </div>
                                                                                            <span class="text-sm font-medium" x-text="finalfolder.name"></span>
                                                                                        </div>
                                                                                        <div class="flex items-center space-x-2">
                                                                                            <span
                                                                                                class="text-xs bg-webropol-gray-200 text-webropol-gray-700 rounded-full px-1.5 py-0.5 font-medium"
                                                                                                x-text="getTotalFolderItemCount(finalfolder)"></span>
                                                                                            <div class="relative">
                                                                                                <button @click.stop="toggleContextMenu('finalfolder-' + finalfolder.id, 'finalfolder')"
                                                                                                    class="opacity-0 group-hover:opacity-100 w-4 h-4 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 rounded transition-all">
                                                                                                    <i class="fal fa-ellipsis-v text-xs"></i>
                                                                                                </button>
                                                                                                <!-- Context Menu for Level 3 Subfolder -->
                                                                                                <div x-show="showContextMenu === 'finalfolder-' + finalfolder.id" 
                                                                                                    @click.stop
                                                                                                    x-transition:enter="transition ease-out duration-100"
                                                                                                    x-transition:enter-start="transform opacity-0 scale-95"
                                                                                                    x-transition:enter-end="transform opacity-100 scale-100"
                                                                                                    x-transition:leave="transition ease-in duration-75"
                                                                                                    x-transition:leave-start="transform opacity-100 scale-100"
                                                                                                    x-transition:leave-end="transform opacity-0 scale-95"
                                                                                                    class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-webropol-gray-200 z-30">
                                                                                                    <div class="py-1">
                                                                                                        <button @click="openMoveModal(finalfolder.id, finalfolder.name)"
                                                                                                            class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                                            <i class="fal fa-arrows mr-3 text-black"></i>
                                                                                                            Move
                                                                                                        </button>
                                                                                                        <button @click="openRenameModal(finalfolder.id, finalfolder.name)"
                                                                                                            class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                                            <i class="fal fa-edit mr-3 text-black"></i>
                                                                                                            Rename
                                                                                                        </button>
                                                                                                        <button @click="openDeleteConfirmationModal(finalfolder.id, finalfolder.name)"
                                                                                                            class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-red-50 transition-colors">
                                                                                                            <i class="fal fa-trash mr-3 text-black"></i>
                                                                                                            Delete
                                                                                                        </button>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </template>
                                                                        </div>
                                                                    </div>
                                                                </template>
                                                            </div>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- Content Area -->
                        <div class="lg:col-span-9"> <!-- Content Area -->
                            <!-- Questions View -->
                            <div x-show="currentView === 'questions'" x-cloak>
                                <div
                                    class="bg-white/70 backdrop-blur-sm rounded-2xl shadow-card border border-webropol-gray-200/50 hover-lift">
                                    <!-- Header -->
                                    <div
                                        class="px-4 md:px-8 py-6 border-b border-webropol-gray-200/50 bg-gradient-to-r from-webropol-gray-50 to-webropol-teal-50/30">
                                        <div class="flex flex-col md:items-center md:justify-between space-y-4 md:space-y-0 md:flex-row">
                                            <div>
                                                <h2 class="text-xl md:text-2xl font-bold text-webropol-gray-900 mb-1">Questions
                                                    Library</h2>
                                            </div>
                                            <div class="flex flex-col sm:flex-row items-stretch sm:items-center space-y-3 sm:space-y-0 sm:space-x-4">
                                                <div class="relative">
                                                    <i class="fal fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-webropol-gray-400"></i>
                                                    <input type="text" x-model="questionSearchTerm" placeholder="Search questions..."
                                                        class="pl-10 pr-4 py-2 w-full sm:w-64 border border-webropol-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent bg-white text-sm">
                                                </div>
                                                <div @click="showOnlyTitles = !showOnlyTitles" class="flex items-center bg-white rounded-xl px-4 py-2 shadow-sm border border-webropol-gray-200 cursor-pointer hover:shadow-md hover:border-webropol-gray-300 transition-all duration-200">
                                                    <span class="text-sm font-medium text-webropol-gray-700 mr-3">Show only question titles</span>
                                                    <label class="relative inline-flex items-center pointer-events-none">
                                                        <input type="checkbox" x-model="showOnlyTitles" class="sr-only peer">
                                                        <div class="peer h-5 w-9 rounded-full bg-webropol-gray-200 after:absolute after:top-[2px] after:left-[2px] after:h-4 after:w-4 after:rounded-full after:border after:border-webropol-gray-300 after:bg-white after:transition-all after:content-[''] peer-checked:bg-gradient-to-r peer-checked:from-webropol-teal-500 peer-checked:to-webropol-teal-600 peer-checked:after:translate-x-full peer-checked:after:border-white peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-webropol-teal-300"></div>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Action Buttons Bar -->
                                        <div x-show="hasSelectedItems()" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 transform -translate-y-2" x-transition:enter-end="opacity-100 transform translate-y-0" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100 transform translate-y-0" x-transition:leave-end="opacity-0 transform -translate-y-2" class="mt-4 flex items-center justify-between p-4 bg-webropol-teal-50 border border-webropol-teal-200 rounded-xl">
                                            <div class="flex items-center space-x-3">
                                                <span class="text-sm font-medium text-webropol-gray-700" x-text="selectedQuestions.length + ' questions selected'"></span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <button @click="deleteSelectedItems()" class="inline-flex items-center px-4 py-2 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors duration-200">
                                                    <i class="fal fa-trash mr-2"></i>
                                                    Delete
                                                </button>
                                                <button @click="freezeSelectedItems()" class="inline-flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors duration-200">
                                                    <i class="fal fa-snowflake mr-2"></i>
                                                    Freeze
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Questions List -->
                                    <div class="p-4 md:p-6 space-y-4">
                                        <!-- Select All Checkbox -->
                                        <div class="flex items-center p-3 md:p-4 bg-webropol-gray-50 rounded-xl border border-webropol-gray-200">
                                            <label class="flex items-center cursor-pointer">
                                                <input type="checkbox" 
                                                    x-model="selectAllQuestions" 
                                                    @change="toggleSelectAllQuestions()"
                                                    class="h-5 w-5 rounded border-webropol-gray-300 text-webropol-teal-600 focus:ring-webropol-teal-500 mr-3">
                                                <span class="text-sm font-medium text-webropol-gray-700">Select All Questions</span>
                                            </label>
                                        </div>
                                        <template x-for="question in getFilteredQuestions()" :key="question.id">
                                            <div
                                                class="group border border-webropol-gray-200 rounded-xl p-4 md:p-6 bg-white hover:border-webropol-teal-300 hover:shadow-medium transition-all duration-200"
                                                :class="selectedQuestions.includes(question.id) ? 'ring-2 ring-webropol-teal-500 border-webropol-teal-500' : ''">
                                                <div class="flex items-start justify-between">
                                                    <div class="flex items-start flex-1">
                                                        <input type="checkbox"
                                                            :checked="selectedQuestions.includes(question.id)"
                                                            @change="toggleQuestionSelection(question.id)"
                                                            class="h-5 w-5 mt-1 rounded border-webropol-gray-300 text-webropol-teal-600 focus:ring-webropol-teal-500 mr-3 md:mr-4">
                                                        <div class="flex-1">
                                                            <div class="flex flex-col sm:flex-row sm:items-center mb-3 space-y-2 sm:space-y-0">
                                                                <h3 class="text-lg font-semibold text-webropol-gray-900 mr-3"
                                                                    x-text="question.name"></h3>
                                                                <div class="flex flex-wrap items-center gap-2">
                                                                    <span
                                                                        class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-webropol-teal-100 text-webropol-teal-800"
                                                                        x-text="question.questionType"></span>
                                                                    <span x-show="question.folderId"
                                                                        class="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700">
                                                                        <i class="fal fa-folder mr-1"></i>
                                                                        <span
                                                                            x-text="folders.find(f => f.id === question.folderId)?.name || 'Unknown'"></span>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Question Options - Hidden when showOnlyTitles is true -->
                                                            <div x-show="!showOnlyTitles">
                                                                <!-- Selection Questions -->
                                                                <div x-show="question.type === 'selection'" class="space-y-3">
                                                                    <template x-for="option in question.options" :key="option">
                                                                        <label class="flex items-center">
                                                                            <input type="radio" :name="'q' + question.id"
                                                                                class="form-radio h-4 w-4 text-webropol-teal-600 mr-3"
                                                                                disabled>
                                                                            <span class="text-webropol-gray-700" x-text="option"></span>
                                                                        </label>
                                                                    </template>
                                                                </div>
                                                                
                                                                <!-- Multiple Choice Questions -->
                                                                <div x-show="question.type === 'multiple'" class="space-y-3">
                                                                    <template x-for="option in question.options" :key="option">
                                                                        <label class="flex items-center">
                                                                            <input type="checkbox"
                                                                                class="h-4 w-4 rounded border-webropol-gray-300 text-webropol-teal-600 mr-3"
                                                                                disabled>
                                                                            <span class="text-webropol-gray-700" x-text="option"></span>
                                                                        </label>
                                                                    </template>
                                                                </div>
                                                                
                                                                <!-- Rating Questions -->
                                                                <div x-show="question.type === 'rating'" class="space-y-3">
                                                                    <div class="flex items-center space-x-4">
                                                                        <template x-for="(option, index) in question.options" :key="option">
                                                                            <label class="flex flex-col items-center">
                                                                                <input type="radio" :name="'q' + question.id"
                                                                                    class="form-radio h-4 w-4 text-webropol-teal-600 mb-2"
                                                                                    disabled>
                                                                                <span class="text-xs text-webropol-gray-600 text-center" x-text="index + 1"></span>
                                                                            </label>
                                                                        </template>
                                                                    </div>
                                                                    <div class="flex justify-between text-xs text-webropol-gray-500">
                                                                        <span>Poor</span>
                                                                        <span>Excellent</span>
                                                                    </div>
                                                                </div>
                                                                
                                                                <!-- Text Questions -->
                                                                <div x-show="question.type === 'text'">
                                                                    <textarea
                                                                        class="w-full p-4 border border-webropol-gray-200 rounded-lg bg-webropol-gray-50"
                                                                        rows="2" placeholder="Your answer..."
                                                                        disabled></textarea>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="flex items-center space-x-2">
                                                        <button @click="openEditQuestionModal(question.id)"
                                                            class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-teal-600 hover:bg-webropol-teal-50 rounded-lg transition-all">
                                                            <i class="fal fa-edit"></i>
                                                        </button>
                                                        <div class="relative">
                                                            <button @click.stop="toggleContextMenu(question.id, 'question')"
                                                                class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-50 rounded-lg transition-all">
                                                                <i class="fal fa-ellipsis-v"></i>
                                                            </button>
                                                            <!-- Context Menu -->
                                                            <div x-show="showContextMenu === question.id" 
                                                                @click.stop
                                                                x-transition:enter="transition ease-out duration-100"
                                                                x-transition:enter-start="transform opacity-0 scale-95"
                                                                x-transition:enter-end="transform opacity-100 scale-100"
                                                                x-transition:leave="transition ease-in duration-75"
                                                                x-transition:leave-start="transform opacity-100 scale-100"
                                                                x-transition:leave-end="transform opacity-0 scale-95"
                                                                style="position: fixed; z-index: 9999;"
                                                                class="right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-webropol-gray-200"
                                                                @click.away="showContextMenu = null">
                                                                <div class="py-1">
                                                                    <button @click="showQuestionInfo(question.id)"
                                                                        class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                        <i class="fal fa-info-circle mr-3 text-black"></i>
                                                                        Question Details
                                                                    </button>
                                                                    <button @click="openMoveModal(question.id, question.name, 'question')"
                                                                        class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                        <i class="fal fa-arrows mr-3 text-black"></i>
                                                                        Move Question
                                                                    </button>
                                                                    <button @click="freezeItem(question.id, 'question')"
                                                                        class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-blue-50 transition-colors">
                                                                        <i class="fal fa-snowflake mr-3 text-black"></i>
                                                                        Freeze Question
                                                                    </button>
                                                                    <button @click="openDeleteConfirmationModal(question.id, question.name, 'question')"
                                                                        class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-red-50 transition-colors">
                                                                        <i class="fal fa-trash mr-3 text-black"></i>
                                                                        Delete Question
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>

                                        <div x-show="getFilteredQuestions().length === 0" class="text-center py-12">
                                            <i class="fal fa-question-circle text-4xl text-webropol-gray-300 mb-4"></i>
                                            <h3 class="text-lg font-semibold text-webropol-gray-900 mb-2">No questions
                                                found</h3>
                                            <p class="text-webropol-gray-600">Try adjusting your language filter or
                                                search terms.</p>
                                        </div>
                                    </div>
                                </div>
                            </div><!-- Surveys View -->
                            <div x-show="currentView === 'surveys'" x-cloak>
                                <div
                                    class="relative bg-white/70 backdrop-blur-sm rounded-2xl shadow-card border border-webropol-gray-200/50 hover-lift">
                                    <!-- Header -->
                                    <div
                                        class="px-4 md:px-8 py-6 border-b border-webropol-gray-200/50 bg-gradient-to-r from-webropol-gray-50 to-webropol-teal-50/30">
                                        <div class="flex flex-col md:items-center md:justify-between space-y-4 md:space-y-0 md:flex-row">
                                            <div>
                                                <h2 class="text-xl md:text-2xl font-bold text-webropol-gray-900 mb-1">Surveys
                                                    Library</h2>
                                            </div>
                                            <div class="flex items-center space-x-4">
                                                <div class="relative">
                                                    <i class="fal fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-webropol-gray-400"></i>
                                                    <input type="text" x-model="surveySearchTerm" placeholder="Search surveys..."
                                                        class="pl-10 pr-4 py-2 w-full sm:w-64 border border-webropol-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent bg-white text-sm">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Action Buttons Bar -->
                                        <div x-show="hasSelectedItems()" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 transform -translate-y-2" x-transition:enter-end="opacity-100 transform translate-y-0" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100 transform translate-y-0" x-transition:leave-end="opacity-0 transform -translate-y-2" class="mt-4 flex items-center justify-between p-4 bg-webropol-teal-50 border border-webropol-teal-200 rounded-xl">
                                            <div class="flex items-center space-x-3">
                                                <span class="text-sm font-medium text-webropol-gray-700" x-text="selectedSurveys.length + ' surveys selected'"></span>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <button @click="deleteSelectedItems()" class="inline-flex items-center px-4 py-2 bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors duration-200">
                                                    <i class="fal fa-trash mr-2"></i>
                                                    Delete
                                                </button>
                                                <button @click="freezeSelectedItems()" class="inline-flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-lg transition-colors duration-200">
                                                    <i class="fal fa-snowflake mr-2"></i>
                                                    Freeze
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Enhanced Table -->
                                    <div class="overflow-x-auto">
                                        <table class="w-full">
                                            <thead class="bg-webropol-gray-50/50">
                                                <tr class="text-left">
                                                    <th class="px-4 sm:px-8 py-4 font-semibold text-webropol-gray-700 text-sm">
                                                        <input type="checkbox"
                                                            x-model="selectAllSurveys"
                                                            @change="toggleSelectAllSurveys()"
                                                            class="h-5 w-5 rounded border-webropol-gray-300 text-webropol-teal-600">
                                                    </th>
                                                    <th class="px-2 sm:px-4 py-4 font-semibold text-webropol-gray-700 text-sm">
                                                        Survey name</th>
                                                    <th class="hidden md:table-cell px-2 sm:px-4 py-4 font-semibold text-webropol-gray-700 text-sm">
                                                        Languages</th>
                                                    <th class="hidden lg:table-cell px-2 sm:px-4 py-4 font-semibold text-webropol-gray-700 text-sm">
                                                        Questions</th>
                                                    <th class="hidden md:table-cell px-2 sm:px-4 py-4 font-semibold text-webropol-gray-700 text-sm">
                                                        Survey type</th>
                                                    <th class="hidden xl:table-cell px-2 sm:px-4 py-4 font-semibold text-webropol-gray-700 text-sm">
                                                        Created by</th>
                                                    <th
                                                        class="px-4 sm:px-8 py-4 font-semibold text-webropol-gray-700 text-sm text-right">
                                                        Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-webropol-gray-100">
                                                <template x-for="survey in getFilteredSurveys()" :key="survey.id">
                                                    <tr class="group hover:bg-webropol-teal-50/30 transition-colors"
                                                        :class="selectedSurveys.includes(survey.id) ? 'ring-2 ring-webropol-teal-500 bg-webropol-teal-50/50' : ''">
                                                        <td class="px-4 sm:px-8 py-6">
                                                            <input type="checkbox"
                                                                :checked="selectedSurveys.includes(survey.id)"
                                                                @change="toggleSurveySelection(survey.id)"
                                                                class="h-5 w-5 rounded border-webropol-gray-300 text-webropol-teal-600">
                                                        </td>
                                                        <td class="px-2 sm:px-4 py-6">
                                                            <div class="font-semibold text-webropol-gray-900" x-text="survey.name"></div>
                                                            <!-- Mobile info -->
                                                            <div class="md:hidden mt-1 space-y-1">
                                                                <div class="flex items-center space-x-2">
                                                                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-webropol-teal-100 text-webropol-teal-800">
                                                                        <span x-text="getSurveyLanguageCount(survey)"></span> <span x-text="getSurveyLanguageCount(survey) === 1 ? 'language' : 'languages'"></span>
                                                                    </span>
                                                                    <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-webropol-teal-100 text-webropol-teal-800">
                                                                        Survey
                                                                    </span>
                                                                </div>
                                                                <div class="lg:hidden text-xs text-webropol-gray-500">
                                                                    6 questions
                                                                </div>
                                                                <div class="xl:hidden text-xs text-webropol-gray-500" x-text="'By ' + survey.createdBy"></div>
                                                            </div>
                                                        </td>
                                                        <td class="hidden md:table-cell px-2 sm:px-4 py-6">
                                                            <span
                                                                class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-webropol-teal-100 text-webropol-teal-800">
                                                                <span x-text="getSurveyLanguageCount(survey)"></span> <span x-text="getSurveyLanguageCount(survey) === 1 ? 'language' : 'languages'"></span>
                                                            </span>
                                                        </td>
                                                        <td class="hidden lg:table-cell px-2 sm:px-4 py-6">
                                                            <span class="font-medium text-webropol-gray-900">6</span>
                                                            <span class="text-webropol-gray-500 text-sm">questions</span>
                                                        </td>
                                                        <td class="hidden md:table-cell px-2 sm:px-4 py-6">
                                                            <span
                                                                class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-webropol-teal-100 text-webropol-teal-800">
                                                                Survey
                                                            </span>
                                                        </td>
                                                        <td class="hidden xl:table-cell px-2 sm:px-4 py-6">
                                                            <div class="flex items-center">
                                                                <span class="text-webropol-gray-900 font-medium" x-text="survey.createdBy"></span>
                                                            </div>
                                                        </td>
                                                        <td class="px-4 sm:px-8 py-6">
                                                            <div class="flex items-center justify-end space-x-2">
                                                                <button @click="showPreviewModal = true"
                                                                    class="w-9 h-9 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-teal-600 hover:bg-webropol-teal-50 rounded-lg transition-all">
                                                                    <i class="fal fa-eye"></i>
                                                                </button>
                                                                <div class="relative">
                                                                    <button @click.stop="toggleContextMenu(survey.id, 'survey')"
                                                                        class="w-9 h-9 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-50 rounded-lg transition-all">
                                                                        <i class="fal fa-ellipsis-v"></i>
                                                                    </button>
                                                                    <!-- Context Menu -->
                                                                    <div x-show="showContextMenu === survey.id" 
                                                                        @click.stop
                                                                        x-transition:enter="transition ease-out duration-100"
                                                                        x-transition:enter-start="transform opacity-0 scale-95"
                                                                        x-transition:enter-end="transform opacity-100 scale-100"
                                                                        x-transition:leave="transition ease-in duration-75"
                                                                        x-transition:leave-start="transform opacity-100 scale-100"
                                                                        x-transition:leave-end="transform opacity-0 scale-95"
                                                                        style="position: fixed; z-index: 9999;"
                                                                        class="right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-webropol-gray-200"
                                                                        @click.away="showContextMenu = null">
                                                                        <div class="py-1">
                                                                            <button @click="showSurveyInfo(survey.id)"
                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                <i class="fal fa-info-circle mr-3 text-black"></i>
                                                                                Survey Details
                                                                            </button>
                                                                            <button @click="openRenameModal(survey.id, survey.name, 'survey')"
                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                <i class="fal fa-edit mr-3 text-black"></i>
                                                                                Rename Survey
                                                                            </button>
                                                                            <button @click="openMoveModal(survey.id, survey.name, 'survey')"
                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                <i class="fal fa-arrows mr-3 text-black"></i>
                                                                                Move Survey
                                                                            </button>
                                                                            <button @click="freezeItem(survey.id, 'survey')"
                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-webropol-gray-50 transition-colors">
                                                                                <i class="fal fa-snowflake mr-3 text-black"></i>
                                                                                Freeze Survey
                                                                            </button>
                                                                            <button @click="openDeleteConfirmationModal(survey.id, survey.name, 'survey')"
                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-red-50 transition-colors">
                                                                                <i class="fal fa-trash mr-3 text-black"></i>
                                                                                Delete Survey
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </template>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Enhanced Pagination -->
                                    <div class="px-4 md:px-8 py-6 border-t border-webropol-gray-200/50 bg-webropol-gray-50/30">
                                        <div class="flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0">
                                            <div class="flex items-center space-x-4">
                                                <span class="text-sm text-webropol-gray-700 font-medium">Page 1 of
                                                    1</span>
                                                <div class="flex items-center space-x-2">
                                                    <button
                                                        class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-teal-600 hover:bg-webropol-teal-50 rounded-lg transition-all disabled:opacity-50"
                                                        disabled>
                                                        <i class="fal fa-chevron-left"></i>
                                                    </button>
                                                    <button
                                                        class="w-8 h-8 flex items-center justify-center bg-webropol-teal-500 text-white rounded-lg font-medium">
                                                        1
                                                    </button>
                                                    <button
                                                        class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-teal-600 hover:bg-webropol-teal-50 rounded-lg transition-all disabled:opacity-50"
                                                        disabled>
                                                        <i class="fal fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="flex items-center space-x-3">
                                                <span class="text-sm text-webropol-gray-700 font-medium hidden sm:inline">Show on
                                                    page</span>
                                                <select
                                                    class="border border-webropol-gray-300 rounded-lg text-sm px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-webropol-teal-500">
                                                    <option>5</option>
                                                    <option selected>20</option>
                                                    <option>50</option>
                                                    <option>100</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Floating Create Button Component -->
    <webropol-floating-button></webropol-floating-button>

    <!-- Create Folder Modal -->
    <div x-show="showCreateFolder" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showCreateFolder = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <div class="p-6 border-b border-webropol-gray-200">
                <h3 class="text-xl font-bold text-webropol-gray-900">Create New Folder</h3>
                <p class="text-webropol-gray-600 mt-1">Organize your questions and surveys</p>
            </div>

            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Folder Name</label>
                        <input x-model="newFolderName" type="text" placeholder="Enter folder name..."
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Description
                            (Optional)</label>
                        <textarea x-model="newFolderDescription" rows="3"
                            placeholder="Describe what this folder contains..."
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent resize-none"></textarea>
                    </div>
                </div>
            </div>

            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showCreateFolder = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="createFolder()"
                    class="px-6 py-2 bg-gradient-to-r from-webropol-teal-500 to-webropol-teal-600 hover:from-webropol-teal-600 hover:to-webropol-teal-700 text-white font-semibold rounded-lg transition-all">
                    Create Folder
                </button>
            </div>
        </div>
    </div>

    <!-- Move Folder Modal -->
    <div x-show="showMoveModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showMoveModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-folder-open text-orange-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900" x-text="'Move ' + (moveItemType === 'folder' ? 'Folder' : moveItemType === 'question' ? 'Question' : 'Survey')"></h3>
                        <p class="text-sm text-webropol-gray-600" x-text="'Select a new location for this ' + moveItemType"></p>
                    </div>
                </div>
                <button @click="showMoveModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="p-6">
                <!-- Current Item Info -->
                <div class="mb-4">
                    <div class="bg-webropol-gray-50 rounded-xl p-4 border border-webropol-gray-200">
                        <div class="flex items-center mb-2">
                            <span class="text-sm font-medium text-webropol-gray-600" x-text="(moveItemType === 'folder' ? 'Folder' : moveItemType === 'question' ? 'Question' : 'Survey') + ' you\\'re moving:'"></span>
                        </div>
                        <div class="flex items-center ml-4">
                            <div class="w-6 h-6 bg-webropol-teal-100 rounded-lg flex items-center justify-center mr-3">
                                <i class="fal" :class="moveItemType === 'folder' ? 'fa-folder' : moveItemType === 'question' ? 'fa-question-circle' : 'fa-chart-bar'" class="text-webropol-teal-600"></i>
                            </div>
                            <span class="font-medium text-webropol-gray-900" x-text="moveItemName"></span>
                        </div>
                    </div>
                </div>

                <!-- New Location Info -->
                <div class="mb-6">
                    <div class="bg-webropol-gray-50 rounded-xl p-4 border border-webropol-gray-200">
                        <div class="flex items-center mb-2">
                            <span class="text-sm font-medium text-webropol-gray-600">New location:</span>
                        </div>
                        <div class="flex items-center text-webropol-gray-500 ml-4">
                            <span x-text="selectedMoveLocation || 'Not selected yet'"></span>
                        </div>
                    </div>
                </div>

                <!-- Location Selection -->
                <div class="mb-6">
                    <h4 class="text-lg font-semibold text-webropol-gray-900 mb-4">Select a new location</h4>
                    <div class="space-y-2 max-h-64 overflow-y-auto">
                        <!-- Root Folders -->
                        <template x-for="folder in folders" :key="folder.id">
                            <div class="border border-webropol-gray-200 rounded-xl overflow-hidden"
                                x-show="folder.id !== moveItemId">
                                <!-- Root Folder -->
                                <button @click.stop="selectMoveLocation(folder.name, folder.id)"
                                    class="w-full flex items-center p-3 hover:bg-webropol-teal-50 transition-all text-left group"
                                    :class="selectedMoveLocationId === folder.id ? 'bg-webropol-teal-50 ring-2 ring-webropol-teal-200' : ''">
                                    <div class="w-8 h-8 bg-webropol-teal-100 rounded-lg flex items-center justify-center mr-3 group-hover:bg-webropol-teal-200 transition-colors">
                                        <i class="fal fa-building text-webropol-teal-600" x-show="folder.name === 'Organisation Library'"></i>
                                        <i class="fal fa-file-alt text-webropol-teal-600" x-show="folder.name === 'My Templates'"></i>
                                    </div>
                                    <span class="font-medium text-webropol-gray-900" x-text="folder.name"></span>
                                </button>
                                
                                <!-- Level 1 Subfolders -->
                                <div class="bg-webropol-gray-50 border-t border-webropol-gray-200">
                                    <template x-for="subfolder in folder.children" :key="subfolder.id">
                                        <div x-show="subfolder.id !== moveItemId">
                                            <button @click.stop="selectMoveLocation(subfolder.name, subfolder.id)"
                                                class="w-full flex items-center p-3 pl-8 hover:bg-webropol-teal-50 transition-all text-left group"
                                                :class="selectedMoveLocationId === subfolder.id ? 'bg-webropol-teal-50 ring-2 ring-webropol-teal-200' : ''">
                                                <div class="w-4 h-6 flex items-center justify-start mr-1">
                                                    <div class="w-3 h-px bg-webropol-gray-300"></div>
                                                </div>
                                                <div class="w-6 h-6 bg-webropol-teal-100 rounded-md flex items-center justify-center mr-3 group-hover:bg-webropol-teal-200 transition-colors">
                                                    <i class="fal fa-folder text-webropol-teal-600"></i>
                                                </div>
                                                <span class="text-sm font-medium text-webropol-gray-800" x-text="subfolder.name"></span>
                                            </button>
                                            
                                            <!-- Level 2 Subfolders -->
                                            <template x-for="subsubfolder in subfolder.children" :key="subsubfolder.id">
                                                <div x-show="subsubfolder.id !== moveItemId">
                                                    <button @click.stop="selectMoveLocation(subsubfolder.name, subsubfolder.id)"
                                                        class="w-full flex items-center p-3 pl-12 hover:bg-webropol-teal-50 transition-all text-left group border-t border-webropol-gray-200"
                                                        :class="selectedMoveLocationId === subsubfolder.id ? 'bg-webropol-teal-50 ring-2 ring-webropol-teal-200' : ''">
                                                        <div class="w-4 h-6 flex items-center justify-start mr-1">
                                                            <div class="w-3 h-px bg-webropol-gray-300"></div>
                                                        </div>
                                                        <div class="w-6 h-6 bg-webropol-teal-100 rounded-md flex items-center justify-center mr-3 group-hover:bg-webropol-teal-200 transition-colors">
                                                            <i class="fal fa-folder text-webropol-teal-600"></i>
                                                        </div>
                                                        <span class="text-sm font-medium text-webropol-gray-800" x-text="subsubfolder.name"></span>
                                                    </button>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-between">
                <button @click="openCreateNewFolderFromMove()"
                    :disabled="!selectedMoveLocation"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700 disabled:bg-webropol-gray-200 disabled:text-webropol-gray-400 disabled:cursor-not-allowed text-webropol-gray-700 font-medium rounded-full transition-all border border-webropol-gray-300 disabled:border-webropol-gray-200">
                    <i class="fal fa-folder-plus mr-2"></i>
                    Create New Folder
                </button>
                <div class="flex items-center space-x-3">
                    <button @click="showMoveModal = false"
                        class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                        Cancel
                    </button>
                    <button @click="confirmMove()"
                        :disabled="!selectedMoveLocation"
                        class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 disabled:bg-webropol-gray-300 disabled:cursor-not-allowed text-white font-medium rounded-full transition-all">
                        Move
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Preview Modal -->
    <div x-show="showPreviewModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showPreviewModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div
                class="flex items-center justify-between p-4 md:p-8 border-b border-webropol-gray-200 bg-gradient-to-r from-webropol-gray-50 to-webropol-teal-50/30">
                <div class="flex items-center">
                    <div
                        class="w-12 h-12 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-eye text-orange-600 text-lg"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-webropol-gray-900">Preview</h2>
                    </div>
                </div>
                <button @click="showPreviewModal = false"
                    class="w-10 h-10 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-xl transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="flex-1 overflow-y-auto p-8">
                <div class="max-w-3xl mx-auto space-y-8">
                    <div class="text-center mb-8">
                        <h3 class="text-3xl font-bold text-webropol-gray-900 mb-2">360</h3>
                    </div>

                    <!-- Question 1: Gender -->
                    <div
                        class="bg-white border border-webropol-gray-200 rounded-xl p-6 hover:border-webropol-teal-300 transition-colors">
                        <h4 class="text-lg font-semibold text-webropol-gray-900 mb-4">1. Gender</h4>
                        <div class="space-y-3">
                            <label
                                class="flex items-center p-3 rounded-lg hover:bg-webropol-teal-50 transition-colors cursor-pointer">
                                <input type="radio" name="gender"
                                    class="form-radio h-5 w-5 text-webropol-teal-600 mr-4">
                                <span class="text-webropol-gray-700 font-medium">Male</span>
                            </label>
                            <label
                                class="flex items-center p-3 rounded-lg hover:bg-webropol-teal-50 transition-colors cursor-pointer">
                                <input type="radio" name="gender"
                                    class="form-radio h-5 w-5 text-webropol-teal-600 mr-4">
                                <span class="text-webropol-gray-700 font-medium">Female</span>
                            </label>
                        </div>
                    </div>

                    <!-- Question 2: Rate -->
                    <div
                        class="bg-white border border-webropol-gray-200 rounded-xl p-6 hover:border-webropol-teal-300 transition-colors">
                        <h4 class="text-lg font-semibold text-webropol-gray-900 mb-6">2. Rate</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-webropol-gray-200">
                                        <th class="text-left py-3 px-4 font-medium text-webropol-gray-700"></th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            1</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            2</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            3</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            4</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            5</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-webropol-gray-100">
                                    <tr class="hover:bg-webropol-teal-50/50 transition-colors">
                                        <td class="py-4 px-4 font-medium text-webropol-gray-900">A</td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_a"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_a"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_a"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_a"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_a"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                    </tr>
                                    <tr class="hover:bg-webropol-teal-50/50 transition-colors">
                                        <td class="py-4 px-4 font-medium text-webropol-gray-900">B</td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_b"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_b"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_b"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_b"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="rate_b"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Question 3: Recommend -->
                    <div
                        class="bg-white border border-webropol-gray-200 rounded-xl p-6 hover:border-webropol-teal-300 transition-colors">
                        <h4 class="text-lg font-semibold text-webropol-gray-900 mb-6">3. Recommend</h4>
                        <div class="flex flex-col space-y-4">
                            <div class="flex items-center justify-between text-sm text-webropol-gray-600 font-medium">
                                <span>Not at all likely</span>
                                <span>Extremely likely</span>
                            </div>
                            <div class="flex items-center justify-center space-x-2">
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">0</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">1</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">2</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">3</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">4</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">5</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">6</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">7</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">8</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">9</button>
                                <button
                                    class="w-12 h-12 border-2 border-webropol-gray-300 rounded-lg hover:border-webropol-teal-500 hover:bg-webropol-teal-50 transition-all font-semibold text-webropol-gray-700">10</button>
                            </div>
                        </div>
                    </div>

                    <!-- Question 4: Leadership -->
                    <div
                        class="bg-white border border-webropol-gray-200 rounded-xl p-6 hover:border-webropol-teal-300 transition-colors">
                        <h4 class="text-lg font-semibold text-webropol-gray-900 mb-6">4. Leadership and charisma</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b border-webropol-gray-200">
                                        <th
                                            class="text-left py-3 px-4 font-medium text-webropol-gray-700 min-w-[200px]">
                                        </th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            1</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            2</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            3</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            4</th>
                                        <th
                                            class="text-center py-3 px-2 font-medium text-webropol-gray-700 min-w-[60px]">
                                            5</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-webropol-gray-100">
                                    <tr class="hover:bg-webropol-teal-50/50 transition-colors">
                                        <td class="py-4 px-4 text-webropol-gray-900">Possesses dignity and authority
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_1"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_1"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_1"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_1"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_1"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                    </tr>
                                    <tr class="hover:bg-webropol-teal-50/50 transition-colors">
                                        <td class="py-4 px-4 text-webropol-gray-900">Sets clear goals</td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_2"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_2"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_2"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_2"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                        <td class="text-center py-4 px-2">
                                            <input type="radio" name="lead_2"
                                                class="form-radio h-5 w-5 text-webropol-teal-600">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div
                class="p-8 border-t border-webropol-gray-200 bg-webropol-gray-50/50 flex items-center justify-end space-x-4">
                <button @click="showPreviewModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Close
                </button>
                <button
                    class="hidden px-6 py-3 bg-gradient-to-r from-webropol-teal-500 to-webropol-teal-600 hover:from-webropol-teal-600 hover:to-webropol-teal-700 text-white font-semibold rounded-xl shadow-medium transition-all">
                    Use This Survey
                </button>
            </div>
        </div>
    </div>

    <!-- Create New Modal -->
    <div x-show="showCreateModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showCreateModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div
                class="p-8 border-b border-webropol-gray-200 bg-gradient-to-r from-webropol-gray-50 to-webropol-teal-50/30">
                <h3 class="text-2xl font-bold text-webropol-gray-900 mb-2">Create New Survey or Question Library</h3>
                <p class="text-webropol-gray-600">Choose what you want to create. This will take to create new page of
                    each survey</p>
            </div>

            <!-- Modal Content -->
            <div class="p-8">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <!-- Surveys -->
                    <button @click="createItem('surveys')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-chart-bar text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">Surveys</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Create custom surveys</span>
                    </button>

                    <!-- Events -->
                    <button @click="createItem('events')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-calendar-alt text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">Events</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Event management</span>
                    </button>

                    <!-- EXW Surveys -->
                    <button @click="createItem('exw-surveys')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-chart-line text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">EXW Surveys</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Employee experience</span>
                    </button>

                    <!-- Case Management -->
                    <button @click="createItem('case-management')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-briefcase text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">Case Management</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Manage cases</span>
                    </button>

                    <!-- eTests -->
                    <button @click="createItem('etests')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-clipboard-check text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">eTests</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Online testing</span>
                    </button>

                    <!-- Assessments -->
                    <button @click="createItem('assessments')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-tasks text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">Assessments</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Performance review</span>
                    </button>

                    <!-- Touch Tablets -->
                    <button @click="createItem('touch-tablets')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-tablet-alt text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">Touch Tablets</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Tablet surveys</span>
                    </button>

                    <!-- Direct Mobile Surveys -->
                    <button @click="createItem('mobile-surveys')"
                        class="group flex flex-col items-center p-6 rounded-xl border-2 border-webropol-gray-200 hover:border-webropol-teal-300 hover:bg-webropol-teal-50 transition-all duration-200">
                        <div
                            class="w-12 h-12 bg-gradient-to-br from-webropol-teal-500 to-webropol-teal-600 rounded-xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                            <i class="fal fa-mobile-alt text-white text-lg"></i>
                        </div>
                        <span class="font-semibold text-webropol-gray-900 text-center">Direct Mobile Surveys</span>
                        <span class="text-xs text-webropol-gray-500 text-center mt-1">Mobile optimized</span>
                    </button>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-8 border-t border-webropol-gray-200 bg-webropol-gray-50/50 flex items-center justify-end">
                <button @click="showCreateModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Freeze Survey Modal -->
    <div x-show="showFreezeModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showFreezeModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-4 md:p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-snowflake text-orange-600 text-lg"></i>
                    </div>
                    <div class="block">
                        <h3 class="text-lg md:text-xl font-bold text-webropol-gray-900">Freeze Survey Question(s) or Page(s)</h3>
                    </div>
                </div>
                <button @click="showFreezeModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="flex flex-col h-full max-h-[80vh]">
                
                <!-- Survey Information Bar -->
                <div class="px-8 py-6 bg-white border-b border-webropol-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div>
                                <h4 class="text-lg font-semibold text-webropol-gray-900" x-text="freezeItemName || 'Report Check'"></h4>
                                <p class="text-sm text-webropol-gray-500">Survey to be frozen</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Content -->
                    <div class="mt-6 pt-6 border-t border-webropol-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- User Permissions -->
                            <div>
                                <h5 class="text-sm font-semibold text-webropol-gray-700 mb-3">User Permissions</h5>
                                <div class="space-y-3">
                                    <label class="flex items-center group cursor-pointer">
                                        <div class="relative">
                                            <input type="checkbox" x-model="allowQuestions" checked class="sr-only peer">
                                            <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                                <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                            </div>
                                        </div>
                                        <span class="ml-3 text-sm text-webropol-gray-700">Allow adding questions</span>
                                    </label>
                                    <label class="flex items-center group cursor-pointer">
                                        <div class="relative">
                                            <input type="checkbox" x-model="allowPages" checked class="sr-only peer">
                                            <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                                <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                            </div>
                                        </div>
                                        <span class="ml-3 text-sm text-webropol-gray-700">Allow adding pages</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Display Options -->
                            <div>
                                <h5 class="text-sm font-semibold text-webropol-gray-700 mb-3">Display Options</h5>
                                <div class="space-y-3">
                                    <label class="flex items-center group cursor-pointer">
                                        <div class="relative">
                                            <input type="checkbox" x-model="showOnlyTitles" checked class="sr-only peer">
                                            <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                                <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                            </div>
                                        </div>
                                        <span class="ml-3 text-sm text-webropol-gray-700">Show titles only</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question Selection Header -->
                <div class="px-8 py-4 bg-webropol-gray-50 border-b border-webropol-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <label class="flex items-center group cursor-pointer mr-6">
                                <div class="relative">
                                    <input type="checkbox" x-model="selectAllQuestions" @change="toggleSelectAllFrozenQuestions()" class="sr-only peer">
                                    <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                        <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                    </div>
                                </div>
                                <span class="ml-3 text-sm font-medium text-webropol-gray-700">Select all</span>
                            </label>
                            <span class="text-sm text-webropol-gray-500">Choose questions to include in frozen survey</span>
                        </div>
                        
                        <!-- Search -->
                        <div class="relative">
                            <i class="fal fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-webropol-gray-400"></i>
                            <input type="text" x-model="searchTerm" placeholder="Search questions..."
                                class="pl-10 pr-4 py-2 w-64 border border-webropol-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 bg-white text-sm">
                        </div>
                    </div>
                </div>

                <!-- Questions Content -->
                <div class="flex-1 overflow-y-auto">
                    
                    <!-- Page Container -->
                    <div class="p-6">
                        <div class="bg-white rounded-xl border border-webropol-gray-200 shadow-sm">
                            
                            <!-- Page Header -->
                            <div class="p-6 border-b border-webropol-gray-200 bg-gradient-to-r from-webropol-gray-50 to-webropol-teal-50/20">
                                <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <label class="flex items-center group cursor-pointer mr-4" @click.stop>
                                                <div class="relative">
                                                    <input type="checkbox" :checked="isQuestionSelected(1)" @change="toggleFrozenQuestionSelection(1)" class="sr-only peer">
                                                    <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                                        <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                                    </div>
                                                </div>
                                            </label>                                        <div class="flex items-center">
                                            <div class="w-8 h-8 bg-webropol-teal-500 rounded-lg flex items-center justify-center mr-3">
                                                <i class="fal fa-file-alt text-white"></i>
                                            </div>
                                            <div>
                                                <h4 class="text-base font-semibold text-webropol-gray-900">Page 1</h4>
                                                <p class="text-xs text-webropol-gray-500">2 questions</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <button @click="expandedPages.includes('page-1') ? expandedPages = expandedPages.filter(id => id !== 'page-1') : expandedPages.push('page-1')"
                                        class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-white/50 rounded-lg transition-all">
                                        <i class="fal fa-chevron-down transition-transform duration-200"
                                           :class="expandedPages.includes('page-1') ? 'rotate-180' : ''"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Questions List -->
                            <div x-show="expandedPages.includes('page-1')" x-collapse>
                                
                                <!-- Question 1 -->
                                <div class="border-b border-webropol-gray-100 last:border-b-0">
                                    <div class="p-6 hover:bg-webropol-gray-50/50 transition-colors">
                                        <div class="flex items-start">
                                            <label class="flex items-center group cursor-pointer mr-4 mt-1" @click.stop>
                                                <div class="relative">
                                                    <input type="checkbox" :checked="isQuestionSelected(1)" @change="toggleFrozenQuestionSelection(1)" class="sr-only peer">
                                                    <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                                        <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                                    </div>
                                                </div>
                                            </label>
                                            
                                            <div class="flex-1">
                                                <div class="flex items-center mb-3">
                                                    <span class="w-6 h-6 bg-webropol-teal-100 text-webropol-teal-700 text-xs font-bold rounded-full flex items-center justify-center mr-3">1</span>
                                                    <h5 class="text-sm font-semibold text-webropol-gray-900">Are you satisfied with our services?</h5>
                                                </div>
                                                
                                                <div x-show="!showOnlyTitles" class="ml-9 space-y-2">
                                                    <div class="flex items-center text-xs text-webropol-gray-600">
                                                        <div class="w-3 h-3 border border-webropol-gray-300 rounded-full mr-2"></div>
                                                        <span>Yes</span>
                                                    </div>
                                                    <div class="flex items-center text-xs text-webropol-gray-600">
                                                        <div class="w-3 h-3 border border-webropol-gray-300 rounded-full mr-2"></div>
                                                        <span>No</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Question 2 -->
                                <div class="border-b border-webropol-gray-100 last:border-b-0">
                                    <div class="p-6 hover:bg-webropol-gray-50/50 transition-colors">
                                        <div class="flex items-start">
                                            <label class="flex items-center group cursor-pointer mr-4 mt-1" @click.stop>
                                                <div class="relative">
                                                    <input type="checkbox" :checked="isQuestionSelected(2)" @change="toggleFrozenQuestionSelection(2)" class="sr-only peer">
                                                    <div class="w-6 h-6 bg-white border-2 border-webropol-gray-300 rounded-lg peer-checked:bg-webropol-teal-500 peer-checked:border-webropol-teal-500 transition-all duration-200 flex items-center justify-center group-hover:border-webropol-teal-400">
                                                        <i class="fal fa-check text-white text-sm opacity-100 transition-opacity"></i>
                                                    </div>
                                                </div>
                                            </label>
                                            
                                            <div class="flex-1">
                                                <div class="flex items-center mb-3">
                                                    <span class="w-6 h-6 bg-webropol-teal-100 text-webropol-teal-700 text-xs font-bold rounded-full flex items-center justify-center mr-3">2</span>
                                                    <h5 class="text-sm font-semibold text-webropol-gray-900">How would you rate our service quality?</h5>
                                                </div>
                                                
                                                <div x-show="!showOnlyTitles" class="ml-9 space-y-2">
                                                    <div class="flex items-center text-xs text-webropol-gray-600">
                                                        <div class="w-3 h-3 border border-webropol-gray-300 rounded-full mr-2"></div>
                                                        <span>Excellent</span>
                                                    </div>
                                                    <div class="flex items-center text-xs text-webropol-gray-600">
                                                        <div class="w-3 h-3 border border-webropol-gray-300 rounded-full mr-2"></div>
                                                        <span>Good</span>
                                                    </div>
                                                    <div class="flex items-center text-xs text-webropol-gray-600">
                                                        <div class="w-3 h-3 border border-webropol-gray-300 rounded-full mr-2"></div>
                                                        <span>Fair</span>
                                                    </div>
                                                    <div class="flex items-center text-xs text-webropol-gray-600">
                                                        <div class="w-3 h-3 border border-webropol-gray-300 rounded-full mr-2"></div>
                                                        <span>Poor</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal Footer -->
                <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                    <button @click="showFreezeModal = false"
                        class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                        Cancel
                    </button>
                    <button @click="confirmFreeze()"
                        class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 text-white font-medium rounded-full transition-all">
                        <i class="fal fa-snowflake mr-2"></i>
                        Freeze
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Subfolder Modal -->
    <div x-show="showAddSubfolderModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showAddSubfolderModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-folder-plus text-orange-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900">Add Subfolder</h3>
                        <p class="text-sm text-webropol-gray-600">Create a new subfolder to organize your content</p>
                    </div>
                </div>
                <button @click="showAddSubfolderModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Parent Folder</label>
                        <div class="p-3 bg-webropol-gray-50 border border-webropol-gray-200 rounded-xl">
                            <div class="flex items-center">
                                <i class="fal fa-folder text-webropol-teal-600 mr-3"></i>
                                <span class="font-medium text-webropol-gray-900" x-text="addSubfolderParentName"></span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Subfolder Name</label>
                        <input x-model="newSubfolderName" type="text" placeholder="Enter subfolder name..."
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Description (Optional)</label>
                        <textarea x-model="newSubfolderDescription" rows="3"
                            placeholder="Describe what this subfolder contains..."
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent resize-none"></textarea>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showAddSubfolderModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="createSubfolder()"
                    class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 text-white font-medium rounded-full transition-all">
                    Create Subfolder
                </button>
            </div>
        </div>
    </div>

    <!-- Rename Folder Modal -->
    <div x-show="showRenameModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showRenameModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-edit text-orange-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900" x-text="'Rename ' + (renameItemType === 'folder' ? 'Folder' : renameItemType === 'question' ? 'Question' : 'Survey')"></h3>
                        <p class="text-sm text-webropol-gray-600" x-text="'Update the ' + renameItemType + ' name'"></p>
                    </div>
                </div>
                <button @click="showRenameModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Current Name</label>
                        <div class="p-3 bg-webropol-gray-50 border border-webropol-gray-200 rounded-xl">
                            <div class="flex items-center">
                                <i class="fal fa-folder text-webropol-teal-600 mr-3"></i>
                                <span class="font-medium text-webropol-gray-900" x-text="renameCurrentName"></span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">New Name</label>
                        <input x-model="renameNewName" type="text" :placeholder="'Enter new ' + renameItemType + ' name...'"
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showRenameModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="confirmRename()"
                    class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 text-white font-medium rounded-full transition-all">
                    Rename
                </button>
            </div>
        </div>
    </div>

    <!-- Create Folder from Move Modal -->
    <div x-show="showCreateFolderFromMove" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showCreateFolderFromMove = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div
                class="flex items-center justify-between p-6 border-b border-webropol-gray-200 bg-gradient-to-r from-webropol-gray-50 to-webropol-teal-50/30">
                <div class="flex items-center">
                    <div
                        class="w-12 h-12 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-folder-plus text-orange-600 text-lg"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-webropol-gray-900">Create New Folder</h2>
                        <p class="text-sm text-webropol-gray-600">Organize your content better</p>
                    </div>
                </div>
                <button @click="showCreateFolderFromMove = false"
                    class="w-10 h-10 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-xl transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Body -->
            <div class="p-6">
                <!-- Location Display -->
                <div class="mb-6 p-4 bg-webropol-gray-50 rounded-xl border border-webropol-gray-200">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-webropol-teal-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fal fa-map-marker-alt text-webropol-teal-600"></i>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-webropol-gray-700 mb-1">Creating folder at:</p>
                            <span class="text-sm font-medium" 
                                  :class="selectedMoveLocation ? 'text-webropol-teal-700' : 'text-orange-600'"
                                  x-text="getLocationDisplayName(selectedMoveLocation)"></span>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Folder Name</label>
                        <input type="text" x-model="newMovefolderName" placeholder="Enter folder name..."
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent"
                            @keyup.enter="createFolderAndMove()">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Description (Optional)</label>
                        <textarea x-model="newMoveFolderDescription" placeholder="Enter folder description..."
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent resize-none"></textarea>
                    </div>
                </div>
            </div>

            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showCreateFolderFromMove = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="createFolderAndMove()"
                    :disabled="!selectedMoveLocation || !newMovefolderName.trim()"
                    class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 disabled:bg-webropol-gray-300 disabled:cursor-not-allowed text-white font-medium rounded-full transition-all">
                    Create & Move
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div x-show="showDeleteModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showDeleteModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-100 to-red-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-exclamation-triangle text-red-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900" x-text="'Delete ' + (deleteItemType === 'folder' ? 'Folder' : deleteItemType === 'question' ? 'Question' : deleteItemType === 'survey' ? 'Survey' : 'Item')"></h3>
                        <p class="text-sm text-webropol-gray-600">This action cannot be undone</p>
                    </div>
                </div>
                <button @click="showDeleteModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="p-6">
                <div class="space-y-4">
                    <div class="p-4 bg-red-50 border border-red-200 rounded-xl">
                        <div class="flex items-start">
                            <i class="fal fa-exclamation-triangle text-red-500 text-lg mr-3 mt-0.5"></i>
                            <div>
                                <h4 class="text-sm font-semibold text-red-800 mb-1">Warning</h4>
                                <p class="text-sm text-red-700">
                                    Are you sure you want to delete "<span class="font-medium" x-text="deleteItemName"></span>"?
                                    <span x-show="deleteItemType === 'folder'">This will permanently remove the folder and all its contents including surveys and questions.</span>
                                    <span x-show="deleteItemType === 'question'">This question will be permanently removed from your library.</span>
                                    <span x-show="deleteItemType === 'survey'">This survey will be permanently removed from your library.</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-3 bg-webropol-gray-50 border border-webropol-gray-200 rounded-xl">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fal text-webropol-teal-600 mr-3" :class="deleteItemType === 'folder' ? 'fa-folder' : deleteItemType === 'question' ? 'fa-question-circle' : 'fa-chart-bar'"></i>
                                <span class="font-medium text-webropol-gray-900 ml-3" x-text="deleteItemName"></span>
                            </div>
                            <span x-show="deleteItemType === 'folder'" class="text-xs bg-webropol-gray-200 text-webropol-gray-700 rounded-full px-2 py-1 font-medium"
                                x-text="deleteItemCount + ' items'"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showDeleteModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="confirmDelete()"
                    class="px-6 py-2.5 bg-red-600 hover:bg-red-700 text-white font-medium rounded-full transition-all">
                    <i class="fal fa-trash mr-2"></i>
                    <span x-text="'Delete ' + (deleteItemType === 'folder' ? 'Folder' : deleteItemType === 'question' ? 'Question' : deleteItemType === 'survey' ? 'Survey' : 'Item')"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Survey Information Modal -->
    <div x-show="showSurveyInfoModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showSurveyInfoModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header - Sticky -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200 bg-white rounded-t-2xl">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-info-circle text-orange-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900">Survey Details</h3>
                        <p class="text-sm text-webropol-gray-600">Survey information and settings</p>
                    </div>
                </div>
                <button @click="showSurveyInfoModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content - Scrollable -->
            <div class="flex-1 overflow-y-auto p-6">
                <!-- Basic Information Section -->
                <div class="mb-6">
                    <h4 class="text-lg font-semibold text-webropol-gray-900 mb-4">Basic information</h4>
                    
                    <div class="space-y-4">
                        <!-- Survey Name -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                            <label class="text-sm font-medium text-webropol-gray-700">Name:</label>
                            <div class="md:col-span-2">
                                <input type="text" :value="surveyInfoData?.name || ''" readonly
                                    class="w-full px-3 py-2 border border-webropol-gray-200 rounded-lg bg-webropol-gray-50 text-webropol-gray-700">
                                <span class="text-xs text-webropol-gray-500 mt-1 block">(The name in survey folder list)</span>
                            </div>
                        </div>

                        <!-- Survey ID -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                            <label class="text-sm font-medium text-webropol-gray-700">Survey ID:</label>
                            <div class="md:col-span-2">
                                <input type="text" :value="'Fns' + (surveyInfoData?.id || '')" readonly
                                    class="w-full px-3 py-2 border border-webropol-gray-200 rounded-lg bg-webropol-gray-50 text-webropol-gray-700">
                            </div>
                        </div>

                        <!-- Location -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                            <label class="text-sm font-medium text-webropol-gray-700">Location:</label>
                            <div class="md:col-span-2">
                                <input type="text" :value="surveyInfoData?.location || 'My Folder \\ Surveys \\ AI's Survey'" readonly
                                    class="w-full px-3 py-2 border border-webropol-gray-200 rounded-lg bg-webropol-gray-50 text-webropol-gray-700">
                            </div>
                        </div>

                        <!-- Created by -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                            <label class="text-sm font-medium text-webropol-gray-700">Created by:</label>
                            <div class="md:col-span-2">
                                <input type="text" :value="surveyInfoData?.createdBy || 'Unknown User'" readonly
                                    class="w-full px-3 py-2 border border-webropol-gray-200 rounded-lg bg-webropol-gray-50 text-webropol-gray-700">
                            </div>
                        </div>

                        <!-- Keywords Accordion -->
                        <div class="border border-webropol-gray-200 rounded-lg overflow-hidden">
                            <button @click="keywordsExpanded = !keywordsExpanded" 
                                class="w-full flex items-center justify-between p-4 bg-webropol-gray-50 hover:bg-webropol-gray-100 transition-colors text-left">
                                <span class="text-sm font-medium text-webropol-gray-700" x-text="'Keywords (' + surveyKeywords.length + ')'"></span>
                                <i class="fal fa-chevron-down transition-transform duration-200" 
                                   :class="keywordsExpanded ? 'rotate-180' : ''"></i>
                            </button>
                            
                            <div x-show="keywordsExpanded" x-collapse>
                                <div class="p-4 border-t border-webropol-gray-200">
                                    <div class="mb-3">
                                        <div class="flex space-x-2">
                                            <input type="text" x-model="currentKeywordInput" placeholder="Add one keyword"
                                                @keydown.enter="addKeyword()"
                                                class="flex-1 px-3 py-2 border border-webropol-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent">
                                            <button @click="addKeyword()" 
                                                :disabled="!currentKeywordInput.trim()"
                                                class="px-4 py-2 bg-webropol-teal-600 hover:bg-webropol-teal-700 disabled:bg-webropol-gray-300 disabled:cursor-not-allowed text-white text-sm rounded-lg transition-all">
                                                Add
                                            </button>
                                        </div>
                                        <p class="text-xs text-webropol-gray-500 mt-1">Keywords can be used to later search for this survey on Surveys -page.</p>
                                    </div>

                                    <!-- Keywords Display -->
                                    <div x-show="surveyKeywords.length > 0" class="mb-4">
                                        <div class="flex flex-wrap gap-2">
                                            <template x-for="keyword in surveyKeywords" :key="keyword">
                                                <div class="inline-flex items-center bg-webropol-teal-100 text-webropol-teal-800 px-3 py-1 rounded-full text-sm">
                                                    <span x-text="keyword"></span>
                                                    <button @click="removeKeyword(keyword)" 
                                                        class="ml-2 text-webropol-teal-600 hover:text-webropol-teal-800 transition-colors">
                                                        <i class="fal fa-times text-xs"></i>
                                                    </button>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                    
                                    <!-- Keywords Management Section -->
                                    <div class="bg-webropol-gray-50 border border-webropol-gray-200 rounded-lg p-4">
                                        <p class="text-sm font-medium text-webropol-gray-700 mb-3">Manage survey, question and option keywords (for this survey) via Excel</p>
                                        
                                        <div class="space-y-3">
                                            <!-- Export Section -->
                                            <div>
                                                <p class="text-sm text-webropol-gray-600 mb-2">1. Export excel to get current keywords</p>
                                                <div class="flex items-center space-x-3">
                                                    <p class="text-sm text-webropol-gray-600">Select questions to Excel template to add question and option keywords</p>
                                                </div>
                                                <div class="flex items-center space-x-3 mt-2">
                                                    <select class="px-3 py-2 border border-webropol-gray-200 rounded-lg text-sm">
                                                        <option>-- Select question --</option>
                                                    </select>
                                                    <button class="px-4 py-2 bg-webropol-gray-200 hover:bg-webropol-gray-300 text-webropol-gray-700 text-sm rounded-lg transition-all">
                                                        Get template
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Import Section -->
                                            <div>
                                                <p class="text-sm text-webropol-gray-600 mb-2">2. Import Excel with added keywords (separate multiple keywords with comma)</p>
                                                <div class="flex items-center space-x-3">
                                                    <input type="file" accept=".xlsx,.xls" class="text-sm text-webropol-gray-600">
                                                    <button class="px-4 py-2 bg-webropol-gray-200 hover:bg-webropol-gray-300 text-webropol-gray-700 text-sm rounded-lg transition-all">
                                                        Upload file
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Survey Description Accordion -->
                        <div class="border border-webropol-gray-200 rounded-lg overflow-hidden">
                            <button @click="descriptionExpanded = !descriptionExpanded" 
                                class="w-full flex items-center justify-between p-4 bg-webropol-gray-50 hover:bg-webropol-gray-100 transition-colors text-left">
                                <span class="text-sm font-medium text-webropol-gray-700">Survey Description</span>
                                <i class="fal fa-chevron-down transition-transform duration-200" 
                                   :class="descriptionExpanded ? 'rotate-180' : ''"></i>
                            </button>
                            
                            <div x-show="descriptionExpanded" x-collapse>
                                <div class="p-4 border-t border-webropol-gray-200">
                                    <!-- Description Type Selector -->
                                    <div class="mb-4">
                                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Description Type:</label>
                                        <select class="text-sm border border-webropol-gray-200 rounded-lg px-3 py-2">
                                            <option>Survey description (empty)</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Rich Text Editor -->
                                    <div class="border border-webropol-gray-200 rounded-lg min-h-[200px] p-3">
                                        <!-- Rich text editor toolbar -->
                                        <div class="border-b border-webropol-gray-200 pb-2 mb-3">
                                            <div class="flex items-center space-x-2 text-sm">
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-code"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-undo"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-redo"></i></button>
                                                <span class="w-px h-4 bg-webropol-gray-300"></span>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded font-bold">B</button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded italic">I</button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded underline">U</button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded line-through">S</button>
                                                <span class="w-px h-4 bg-webropol-gray-300"></span>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-list-ul"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-list-ol"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-indent"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-outdent"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-quote-right"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-link"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-image"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-table"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-align-left"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-expand-arrows-alt"></i></button>
                                            </div>
                                            <div class="flex items-center space-x-3 mt-2">
                                                <select class="text-xs border border-webropol-gray-200 rounded px-2 py-1">
                                                    <option>Styles</option>
                                                </select>
                                                <select class="text-xs border border-webropol-gray-200 rounded px-2 py-1">
                                                    <option>Format</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- Content area -->
                                        <div class="min-h-[120px] text-sm text-webropol-gray-600 focus:outline-none" contenteditable="true">
                                            <!-- Empty content area -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer - Sticky -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3 bg-white rounded-b-2xl">
                <button @click="showSurveyInfoModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="showSurveyInfoModal = false"
                    class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 text-white font-medium rounded-full transition-all">
                    Apply
                </button>
            </div>
        </div>
    </div>

    <!-- Question Information Modal -->
    <div x-show="showQuestionInfoModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showQuestionInfoModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-100 to-blue-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-info-circle text-blue-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900">Question Details</h3>
                        <p class="text-sm text-webropol-gray-600">View question details and properties</p>
                    </div>
                </div>
                <button @click="showQuestionInfoModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="p-6">
                <div class="space-y-4">
                    <!-- Question Name -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                        <label class="text-sm font-medium text-webropol-gray-700">Question name:</label>
                        <div class="md:col-span-2">
                            <div class="flex items-center">
                                <span class="text-sm font-medium text-webropol-gray-900" x-text="questionInfoData?.name || ''"></span>
                                <i class="fal fa-lightbulb text-orange-500 ml-2" x-show="questionInfoData?.name?.includes('satisfied')"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Question Type -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                        <label class="text-sm font-medium text-webropol-gray-700">Question type:</label>
                        <div class="md:col-span-2">
                            <span class="text-sm text-webropol-gray-900" x-text="questionInfoData?.questionType || ''"></span>
                        </div>
                    </div>

                    <!-- Question Keywords -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                        <label class="text-sm font-medium text-webropol-gray-700">Question keyword(s):</label>
                        <div class="md:col-span-2">
                            <span class="text-sm text-webropol-gray-900" x-text="questionInfoData?.keywords || ''"></span>
                        </div>
                    </div>

                    <!-- Question Folder Name -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                        <label class="text-sm font-medium text-webropol-gray-700">Question folder name:</label>
                        <div class="md:col-span-2">
                            <span class="text-sm text-webropol-gray-900" x-text="questionInfoData?.folderPath || ''"></span>
                        </div>
                    </div>

                    <!-- Created By -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                        <label class="text-sm font-medium text-webropol-gray-700">Created by:</label>
                        <div class="md:col-span-2">
                            <span class="text-sm text-webropol-gray-900" x-text="questionInfoData?.createdBy || ''"></span>
                        </div>
                    </div>

                    <!-- Question Description Accordion -->
                    <div class="col-span-full">
                        <div class="border border-webropol-gray-200 rounded-lg overflow-hidden">
                            <button @click="descriptionExpanded = !descriptionExpanded" 
                                class="w-full flex items-center justify-between p-4 bg-webropol-gray-50 hover:bg-webropol-gray-100 transition-colors text-left">
                                <span class="text-sm font-medium text-webropol-gray-700">Question Description</span>
                                <i class="fal fa-chevron-down transition-transform duration-200" 
                                   :class="descriptionExpanded ? 'rotate-180' : ''"></i>
                            </button>
                            
                            <div x-show="descriptionExpanded" x-collapse>
                                <div class="p-4 border-t border-webropol-gray-200">
                                    <!-- Rich Text Editor -->
                                    <div class="border border-webropol-gray-200 rounded-lg min-h-[200px] p-3">
                                        <!-- Rich text editor toolbar -->
                                        <div class="border-b border-webropol-gray-200 pb-2 mb-3">
                                            <div class="flex items-center space-x-2 text-sm">
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-code"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-undo"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-redo"></i></button>
                                                <span class="w-px h-4 bg-webropol-gray-300"></span>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded font-bold">B</button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded italic">I</button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded underline">U</button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded line-through">S</button>
                                                <span class="w-px h-4 bg-webropol-gray-300"></span>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-list-ul"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-list-ol"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-indent"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-outdent"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-quote-right"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-link"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-image"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-table"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-align-left"></i></button>
                                                <button class="p-1 hover:bg-webropol-gray-100 rounded"><i class="fal fa-expand-arrows-alt"></i></button>
                                            </div>
                                            <div class="flex items-center space-x-3 mt-2">
                                                <select class="text-xs border border-webropol-gray-200 rounded px-2 py-1">
                                                    <option>Styles</option>
                                                </select>
                                                <select class="text-xs border border-webropol-gray-200 rounded px-2 py-1">
                                                    <option>Format</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- Content area -->
                                        <div class="min-h-[120px] text-sm text-webropol-gray-600 focus:outline-none" contenteditable="true">
                                            <!-- Empty content area -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showQuestionInfoModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="showQuestionInfoModal = false"
                    class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 text-white font-medium rounded-full transition-all">
                    Apply
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Question Modal -->
    <div x-show="showEditQuestionModal" x-cloak
        class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4"
        x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
        x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div @click.away="showEditQuestionModal = false"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden"
            x-transition:enter="ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-8 scale-95"
            x-transition:enter-end="opacity-100 translate-y-0 scale-100" x-transition:leave="ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0 scale-100"
            x-transition:leave-end="opacity-0 translate-y-8 scale-95">

            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-webropol-gray-200">
                <div class="flex items-center">
                    <div class="w-10 h-10 bg-gradient-to-br from-green-100 to-green-100 rounded-full flex items-center justify-center mr-4">
                        <i class="fal fa-edit text-green-600 text-lg"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-webropol-gray-900">Edit question</h3>
                        <p class="text-sm text-webropol-gray-600">Modify question properties and settings</p>
                    </div>
                </div>
                <button @click="showEditQuestionModal = false"
                    class="w-8 h-8 flex items-center justify-center text-webropol-gray-400 hover:text-webropol-gray-600 hover:bg-webropol-gray-100 rounded-lg transition-all">
                    <i class="fal fa-times text-lg"></i>
                </button>
            </div>

            <!-- Modal Content -->
            <div class="p-6">
                <div class="space-y-4">
                    <!-- Question Title -->
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Question title</label>
                        <div class="relative">
                            <select x-model="editQuestionData.title" 
                                class="w-full px-4 py-3 pr-10 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent bg-white appearance-none">
                                <option value="Open ended">Open ended</option>
                                <option value="Multiple choice">Multiple choice</option>
                                <option value="Rating scale">Rating scale</option>
                                <option value="Yes/No">Yes/No</option>
                            </select>
                            <i class="fal fa-chevron-down absolute right-4 top-1/2 transform -translate-y-1/2 text-webropol-gray-400 pointer-events-none"></i>
                        </div>
                    </div>

                    <!-- Question Text -->
                    <div>
                        <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Question text</label>
                        <input type="text" x-model="editQuestionData.name" 
                            class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent"
                            placeholder="Enter question text...">
                    </div>

                    <!-- Question is mandatory -->
                    <div class="flex items-center">
                        <input type="checkbox" x-model="editQuestionData.mandatory" id="mandatory" 
                            class="h-5 w-5 rounded border-webropol-gray-300 text-webropol-teal-600 focus:ring-webropol-teal-500 mr-3">
                        <label for="mandatory" class="text-sm font-medium text-webropol-gray-700">Question is mandatory</label>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-6 border-t border-webropol-gray-200 flex items-center justify-end space-x-3">
                <button @click="showEditQuestionModal = false"
                    class="px-6 py-2.5 text-webropol-gray-700 font-medium rounded-full hover:bg-webropol-teal-200 transition-all border border-webropol-teal-700">
                    Cancel
                </button>
                <button @click="showEditQuestionModal = false"
                    class="px-6 py-2.5 bg-webropol-teal-700 hover:bg-webropol-teal-800 text-white font-medium rounded-full transition-all">
                    Apply
                </button>
            </div>
        </div>
    </div>

    <script>
        function libraryApp() {
            return {
                currentView: 'surveys',
                selectedLanguage: 'en',
                searchTerm: '',
                questionSearchTerm: '',
                surveySearchTerm: '',
                showPreviewModal: false,
                showCreateFolder: false,
                showCreateFolderFromMove: false,
                showCreateModal: false,
                showMoveToFolder: null,
                showMoveModal: false,
                showFreezeModal: false,
                showAddToFolder: null,
                newFolderName: '',
                newFolderDescription: '',
                newMovefolderName: '',
                newMoveFolderDescription: '',
                expandedFolders: [],
                showOnlyTitles: false,
                
                // Library menu state
                showLibraryMenu: false,
                
                // Tab orientation state
                tabsOrientation: localStorage.getItem('webropol-tabs-orientation') || 'horizontal', // 'horizontal' or 'vertical'
                
                // Move modal state
                moveItemId: null,
                moveItemName: '',
                moveItemType: 'folder',
                selectedMoveLocation: null,
                selectedMoveLocationId: null,
                
                // Freeze modal state
                freezeItemId: null,
                freezeItemName: '',
                freezeItemType: '',
                selectedFreezeFolder: null,
                allowQuestions: true,
                allowPages: true,
                selectAllQuestions: true,
                showOnlyTitles: true,
                showSettings: false,
                expandedPages: ['page-1'], // Track which pages are expanded
                expandedQuestions: [], // Track which questions are expanded
                selectedFrozenQuestions: [1, 2], // Track selected questions in freeze modal
                
                // New modal states
                showAddSubfolderModal: false,
                showRenameModal: false,
                showDeleteModal: false,
                showSurveyInfoModal: false,
                showQuestionInfoModal: false,
                showEditQuestionModal: false,
                addSubfolderParentId: null,
                addSubfolderParentName: '',
                newSubfolderName: '',
                newSubfolderDescription: '',
                renameItemId: null,
                renameCurrentName: '',
                renameNewName: '',
                renameItemType: 'folder',
                deleteItemId: null,
                deleteItemName: '',
                deleteItemCount: 0,
                deleteItemType: 'folder',
                
                // Survey info modal state
                surveyInfoId: null,
                surveyInfoData: null,
                keywordsExpanded: false,
                descriptionExpanded: false,
                currentKeywordInput: '',
                surveyKeywords: [],
                
                // Question info modal state
                questionInfoId: null,
                questionInfoData: null,
                
                // Edit question modal state
                editQuestionId: null,
                editQuestionData: null,
                
                // Selection state
                selectedQuestions: [],
                selectedSurveys: [],
                selectAllQuestions: false,
                selectAllSurveys: false,
                showContextMenu: null,

                // Sample data with nested subfolder structure
                folders: [
                    { 
                        id: 1, 
                        name: 'Organisation Library', 
                        description: 'Central repository for organization-wide surveys and questions',
                        level: 0,
                        parentId: null,
                        children: [
                            {
                                id: 11,
                                name: 'Customer Satisfaction',
                                description: 'Customer feedback and satisfaction surveys',
                                level: 1,
                                parentId: 1,
                                children: [
                                    {
                                        id: 111,
                                        name: 'Product Feedback',
                                        description: 'Product-specific customer feedback',
                                        level: 2,
                                        parentId: 11,
                                        children: [
                                            {
                                                id: 1111,
                                                name: 'Software Products',
                                                description: 'Software product feedback surveys',
                                                level: 3,
                                                parentId: 111,
                                                children: []
                                            },
                                            {
                                                id: 1112,
                                                name: 'Hardware Products',
                                                description: 'Hardware product feedback surveys',
                                                level: 3,
                                                parentId: 111,
                                                children: []
                                            }
                                        ]
                                    },
                                    {
                                        id: 112,
                                        name: 'Service Quality',
                                        description: 'Service quality assessment surveys',
                                        level: 2,
                                        parentId: 11,
                                        children: [
                                            {
                                                id: 1121,
                                                name: 'Technical Support',
                                                description: 'Technical support quality surveys',
                                                level: 3,
                                                parentId: 112,
                                                children: []
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                id: 12,
                                name: 'Employee Engagement',
                                description: 'Employee satisfaction and engagement surveys',
                                level: 1,
                                parentId: 1,
                                children: [
                                    {
                                        id: 121,
                                        name: 'Annual Reviews',
                                        description: 'Yearly employee performance reviews',
                                        level: 2,
                                        parentId: 12,
                                        children: []
                                    },
                                    {
                                        id: 122,
                                        name: 'Team Dynamics',
                                        description: 'Team collaboration and dynamics assessment',
                                        level: 2,
                                        parentId: 12,
                                        children: []
                                    }
                                ]
                            },
                            {
                                id: 13,
                                name: 'Market Research',
                                description: 'Market analysis and research surveys',
                                level: 1,
                                parentId: 1,
                                children: [
                                    {
                                        id: 131,
                                        name: 'Competitive Analysis',
                                        description: 'Competitor research surveys',
                                        level: 2,
                                        parentId: 13,
                                        children: []
                                    }
                                ]
                            }
                        ]
                    },
                    { 
                        id: 2, 
                        name: 'My Templates', 
                        description: 'Personal survey templates and questions',
                        level: 0,
                        parentId: null,
                        children: [
                            {
                                id: 21,
                                name: '360 Degree Feedback',
                                description: '360-degree feedback survey templates',
                                level: 1,
                                parentId: 2,
                                children: [
                                    {
                                        id: 211,
                                        name: 'Leadership Assessment',
                                        description: 'Leadership skills assessment templates',
                                        level: 2,
                                        parentId: 21,
                                        children: []
                                    },
                                    {
                                        id: 212,
                                        name: 'Communication Skills',
                                        description: 'Communication assessment templates',
                                        level: 2,
                                        parentId: 21,
                                        children: []
                                    }
                                ]
                            },
                            {
                                id: 22,
                                name: 'Custom Surveys',
                                description: 'Custom survey templates',
                                level: 1,
                                parentId: 2,
                                children: []
                            }
                        ]
                    }
                ],

                questions: [
                    { 
                        id: 1, 
                        name: 'How satisfied are you with our fantastic services? ', 
                        type: 'selection', 
                        language: 'en', 
                        folderId: 1111,
                        questionType: 'CSAT',
                        keywords: 'csat, question',
                        folderPath: 'My Folder / Questions / Ali\'s Questions',
                        createdBy: 'Ali Al-Zuhairi',
                        title: 'Multiple choice',
                        mandatory: false,
                        options: ['Very Satisfied', 'Satisfied', 'Neutral', 'Dissatisfied', 'Very Dissatisfied']
                    },
                    { 
                        id: 2, 
                        name: 'Product Quality Assessment', 
                        type: 'rating', 
                        language: 'en', 
                        folderId: 1111,
                        questionType: 'Rating',
                        keywords: 'product, quality, assessment',
                        folderPath: 'My Folder / Questions / Product Feedback',
                        createdBy: 'Ali Al-Zuhairi',
                        title: 'Open ended',
                        mandatory: true,
                        options: ['1 - Poor', '2 - Fair', '3 - Good', '4 - Very Good', '5 - Excellent']
                    },
                    { 
                        id: 3, 
                        name: 'Feedback Survey', 
                        type: 'selection', 
                        language: 'fi', 
                        folderId: 1112,
                        questionType: 'Selection',
                        options: ['Vaihtoehto 1', 'Vaihtoehto 2', 'Vaihtoehto 3', 'Vaihtoehto 4']
                    },
                    { 
                        id: 4, 
                        name: 'Support Experience', 
                        type: 'text', 
                        language: 'en', 
                        folderId: 1121,
                        questionType: 'Text Question',
                        options: []
                    },
                    { 
                        id: 5, 
                        name: 'Team Collaboration Rating', 
                        type: 'rating', 
                        language: 'en', 
                        folderId: 122,
                        questionType: 'Rating',
                        options: ['1 - Poor', '2 - Fair', '3 - Good', '4 - Very Good', '5 - Excellent']
                    },
                    { 
                        id: 6, 
                        name: 'Leadership Effectiveness', 
                        type: 'multiple', 
                        language: 'en', 
                        folderId: 211,
                        questionType: 'Multiple Choice',
                        options: ['Strategic Thinking', 'Team Management', 'Communication', 'Decision Making', 'Delegation']
                    },
                    { 
                        id: 7, 
                        name: 'Communication Assessment', 
                        type: 'rating', 
                        language: 'en', 
                        folderId: 212,
                        questionType: 'Rating',
                        options: ['1 - Poor', '2 - Fair', '3 - Good', '4 - Very Good', '5 - Excellent']
                    },
                    { 
                        id: 8, 
                        name: 'Market Trends Analysis', 
                        type: 'text', 
                        language: 'en', 
                        folderId: 131,
                        questionType: 'Text Question',
                        options: []
                    },
                    { 
                        id: 9, 
                        name: 'Annual Performance Review', 
                        type: 'selection', 
                        language: 'en', 
                        folderId: 121,
                        questionType: 'Selection',
                        options: ['Exceeds Expectations', 'Meets Expectations', 'Below Expectations', 'Needs Improvement']
                    },
                    { 
                        id: 10, 
                        name: 'Custom Question Template', 
                        type: 'text', 
                        language: 'en', 
                        folderId: 22,
                        questionType: 'Text Question',
                        options: []
                    },
                    // Finnish translations of existing questions
                    { 
                        id: 11, 
                        name: 'Kuinka tyytyvinen olet fantastisiin palveluihimme? ', 
                        type: 'selection', 
                        language: 'fi', 
                        folderId: 1111,
                        questionType: 'CSAT',
                        keywords: 'csat, kysymys',
                        folderPath: 'Oma kansio / Kysymykset / Alin kysymykset',
                        createdBy: 'Ali Al-Zuhairi',
                        title: 'Monivalinta',
                        mandatory: false,
                        options: ['Erittin tyytyvinen', 'Tyytyvinen', 'Neutraali', 'Tyytymtn', 'Erittin tyytymtn'],
                        translationOf: 1
                    },
                    { 
                        id: 12, 
                        name: 'Tuotteen laadun arviointi', 
                        type: 'rating', 
                        language: 'fi', 
                        folderId: 1111,
                        questionType: 'Arviointi',
                        keywords: 'tuote, laatu, arviointi',
                        folderPath: 'Oma kansio / Kysymykset / Tuotepalaute',
                        createdBy: 'Ali Al-Zuhairi',
                        title: 'Avoin kysymys',
                        mandatory: true,
                        options: ['1 - Huono', '2 - Kohtalainen', '3 - Hyv', '4 - Erittin hyv', '5 - Erinomainen'],
                        translationOf: 2
                    },
                    { 
                        id: 13, 
                        name: 'Tiimityskentelyn arviointi', 
                        type: 'rating', 
                        language: 'fi', 
                        folderId: 122,
                        questionType: 'Arviointi',
                        keywords: 'tiimi, yhteisty, arviointi',
                        folderPath: 'Oma kansio / Kysymykset / Tiimity',
                        createdBy: 'Lisa Wang',
                        title: 'Arviointiasteikko',
                        mandatory: false,
                        options: ['1 - Huono', '2 - Kohtalainen', '3 - Hyv', '4 - Erittin hyv', '5 - Erinomainen'],
                        translationOf: 5
                    },
                    { 
                        id: 14, 
                        name: 'Johtajuuden tehokkuus', 
                        type: 'multiple', 
                        language: 'fi', 
                        folderId: 211,
                        questionType: 'Monivalinta',
                        keywords: 'johtajuus, tehokkuus',
                        folderPath: 'Oma kansio / Kysymykset / Johtajuus',
                        createdBy: 'Ali Al-Zuhairi',
                        title: 'Monivalinta',
                        mandatory: false,
                        options: ['Strateginen ajattelu', 'Tiimin johtaminen', 'Viestint', 'Ptksenteko', 'Delegointi'],
                        translationOf: 6
                    }
                ],

                surveys: [
                    { id: 1, name: '360 Leadership Assessment', type: 'survey', language: 'en', folderId: 211, createdBy: 'Ali Al-Zuhairi', keywords: ['leadership', 'assessment', '360'] },
                    { id: 2, name: 'Product Satisfaction Survey', type: 'survey', language: 'en', folderId: 1111, createdBy: 'Sarah Johnson', keywords: ['product', 'satisfaction'] },
                    { id: 3, name: 'Customer Service Quality', type: 'survey', language: 'en', folderId: 112, createdBy: 'Mike Chen', keywords: ['customer', 'service', 'quality'] },
                    { id: 4, name: 'Employee Engagement Survey', type: 'survey', language: 'en', folderId: 12, createdBy: 'Emma Davis', keywords: ['employee', 'engagement'] },
                    { id: 5, name: 'Technical Support Feedback', type: 'survey', language: 'en', folderId: 1121, createdBy: 'John Smith', keywords: ['technical', 'support', 'feedback'] },
                    { id: 6, name: 'Team Dynamics Assessment', type: 'survey', language: 'en', folderId: 122, createdBy: 'Lisa Wang', keywords: ['team', 'dynamics'] },
                    { id: 7, name: 'Market Research Survey', type: 'survey', language: 'en', folderId: 131, createdBy: 'David Brown', keywords: ['market', 'research'] },
                    { id: 8, name: 'Hardware Product Review', type: 'survey', language: 'en', folderId: 1112, createdBy: 'Anna Miller', keywords: ['hardware', 'product', 'review'] },
                    { id: 9, name: 'Communication Skills Review', type: 'survey', language: 'en', folderId: 212, createdBy: 'Tom Wilson', keywords: ['communication', 'skills'] },
                    { id: 10, name: 'Annual Performance Survey', type: 'survey', language: 'en', folderId: 121, createdBy: 'Grace Lee', keywords: ['performance', 'annual'] },
                    // Finnish translations of existing surveys
                    { id: 11, name: '360 Johtajuusarviointi', type: 'survey', language: 'fi', folderId: 211, createdBy: 'Ali Al-Zuhairi', keywords: ['johtajuus', 'arviointi', '360'], translationOf: 1 },
                    { id: 12, name: 'Tuotetyytyvisyyskysely', type: 'survey', language: 'fi', folderId: 1111, createdBy: 'Sarah Johnson', keywords: ['tuote', 'tyytyvisyys'], translationOf: 2 },
                    { id: 13, name: 'Henkilstn sitoutumiskysely', type: 'survey', language: 'fi', folderId: 12, createdBy: 'Emma Davis', keywords: ['henkilst', 'sitoutuminen'], translationOf: 4 },
                    { id: 14, name: 'Tiimidynamiikan arviointi', type: 'survey', language: 'fi', folderId: 122, createdBy: 'Lisa Wang', keywords: ['tiimi', 'dynamiikka'], translationOf: 6 }
                ],

                setView(view) {
                    this.currentView = view;
                },

                setTabsOrientation(orientation) {
                    this.tabsOrientation = orientation;
                    localStorage.setItem('webropol-tabs-orientation', this.tabsOrientation);
                },

                toggleFolder(folderId) {
                    if (this.expandedFolders.includes(folderId)) {
                        this.expandedFolders = this.expandedFolders.filter(id => id !== folderId);
                    } else {
                        this.expandedFolders.push(folderId);
                    }
                },

                createFolder() {
                    if (!this.newFolderName.trim()) return;

                    const newFolder = {
                        id: Date.now(),
                        name: this.newFolderName.trim(),
                        description: this.newFolderDescription.trim()
                    };

                    this.folders.push(newFolder);
                    this.newFolderName = '';
                    this.newFolderDescription = '';
                    this.showCreateFolder = false;
                },

                moveToFolder(itemId, folderId) {
                    const allItems = [...this.questions, ...this.surveys];
                    const item = allItems.find(item => item.id === itemId);
                    if (item) {
                        item.folderId = folderId;
                    }
                    this.showMoveToFolder = null;
                },

                // New move modal methods
                moveItem(itemId) {
                    // Find the item name
                    const allItems = [...this.questions, ...this.surveys];
                    const item = allItems.find(item => item.id === itemId);
                    
                    this.moveItemId = itemId;
                    this.moveItemName = item ? item.name : 'Unknown Item';
                    this.selectedMoveLocation = null;
                    this.showMoveModal = true;
                    this.showContextMenu = null;
                },

                selectMoveLocation(locationName, locationId) {
                    // Build the full path for better display
                    const fullPath = this.buildFolderPath(locationId);
                    this.selectedMoveLocation = fullPath || locationName;
                    this.selectedMoveLocationId = locationId;
                },

                buildFolderPath(folderId) {
                    const folder = this.findFolderById(folderId);
                    if (!folder) return null;
                    
                    let path = folder.name;
                    let currentFolder = folder;
                    
                    // Build path by traversing up the hierarchy
                    while (currentFolder.parentId) {
                        const parentFolder = this.findFolderById(currentFolder.parentId);
                        if (parentFolder) {
                            path = parentFolder.name + ' > ' + path;
                            currentFolder = parentFolder;
                        } else {
                            break;
                        }
                    }
                    
                    return path;
                },

                openCreateNewFolderFromMove() {
                    // Clear any previous data
                    this.newMovefolderName = '';
                    this.newMoveFolderDescription = '';
                    // Open the create folder from move modal
                    this.showCreateFolderFromMove = true;
                },

                createFolderAndMove() {
                    if (!this.newMovefolderName.trim() || !this.selectedMoveLocation || !this.moveItemId) return;
                    
                    // Create the new folder name/path
                    const newFolderLocation = this.selectedMoveLocation === 'Root' 
                        ? this.newMovefolderName 
                        : `${this.selectedMoveLocation}/${this.newMovefolderName}`;
                    
                    console.log(`Creating folder "${this.newMovefolderName}" at "${this.selectedMoveLocation}"`);
                    console.log(`Moving item ${this.moveItemId} (${this.moveItemName}) to the new folder: ${newFolderLocation}`);
                    
                    // Here you would implement the actual folder creation and move logic
                    // 1. Create the new folder
                    // 2. Move the item to the new folder
                    
                    // Find and update the item
                    const allItems = [...this.questions, ...this.surveys];
                    const item = allItems.find(item => item.id === this.moveItemId);
                    if (item) {
                        item.location = newFolderLocation;
                    }
                    
                    // Close both modals and reset state
                    this.showCreateFolderFromMove = false;
                    this.showMoveModal = false;
                    this.moveItemId = null;
                    this.moveItemName = '';
                    this.selectedMoveLocation = null;
                    this.selectedMoveLocationId = null;
                    this.newMovefolderName = '';
                    this.newMoveFolderDescription = '';
                    
                    // Show success message (you can customize this)
                    console.log('Folder created and item moved successfully!');
                },

                getLocationDisplayName(location) {
                    if (!location) {
                        return 'Please select a location first';
                    }
                    return location;
                },

                confirmMove() {
                    if (!this.selectedMoveLocationId || !this.moveItemId) return;
                    
                    if (this.moveItemType === 'folder') {
                        // Move folder logic - update the folder's parent
                        const folder = this.findFolderById(this.moveItemId);
                        if (folder) {
                            // Remove from current location
                            this.removeFolderById(this.moveItemId);
                            
                            // Add to new location
                            const targetFolder = this.findFolderById(this.selectedMoveLocationId);
                            if (targetFolder) {
                                if (!targetFolder.subfolders) {
                                    targetFolder.subfolders = [];
                                }
                                targetFolder.subfolders.push(folder);
                            }
                        }
                    } else if (this.moveItemType === 'question') {
                        const question = this.questions.find(q => q.id === this.moveItemId);
                        if (question) {
                            question.folderId = this.selectedMoveLocationId;
                        }
                    } else if (this.moveItemType === 'survey') {
                        const survey = this.surveys.find(s => s.id === this.moveItemId);
                        if (survey) {
                            survey.folderId = this.selectedMoveLocationId;
                        }
                    }
                    
                    // Close the modal and reset state
                    this.showMoveModal = false;
                    this.moveItemId = null;
                    this.moveItemName = '';
                    this.moveItemType = 'folder';
                    this.selectedMoveLocation = null;
                    this.selectedMoveLocationId = null;
                },

                removeFromFolder(itemId, folderId) {
                    const allItems = [...this.questions, ...this.surveys];
                    const item = allItems.find(item => item.id === itemId);
                    if (item && item.folderId === folderId) {
                        item.folderId = null;
                    }
                },

                getFilteredFolders() {
                    return this.folders.filter(folder => {
                        // Only show root level folders (level 0)
                        return folder.level === 0;
                    });
                },

                // Helper function to recursively count items in folder and subfolders
                getTotalFolderItemCount(folder) {
                    let count = 0;
                    
                    // Count direct items in this folder
                    const currentItems = this.currentView === 'questions' ? this.questions : this.surveys;
                    const directItems = currentItems.filter(item => {
                        const matchesFolder = item.folderId === folder.id;
                        const matchesLanguage = item.language === this.selectedLanguage;
                        const matchesSearch = !this.searchTerm || item.name.toLowerCase().includes(this.searchTerm.toLowerCase());
                        return matchesFolder && matchesLanguage && matchesSearch;
                    });
                    count += directItems.length;
                    
                    // Recursively count items in children
                    if (folder.children && folder.children.length > 0) {
                        folder.children.forEach(child => {
                            count += this.getTotalFolderItemCount(child);
                        });
                    }
                    
                    return count;
                },

                // Helper function to find folder by ID (searches recursively)
                findFolderById(folderId, folders = this.folders) {
                    for (let folder of folders) {
                        if (folder.id === folderId) {
                            return folder;
                        }
                        if (folder.children && folder.children.length > 0) {
                            const found = this.findFolderById(folderId, folder.children);
                            if (found) return found;
                        }
                    }
                    return null;
                },

                // Modal opening functions
                openAddSubfolderModal(parentId) {
                    const parentFolder = this.findFolderById(parentId);
                    if (parentFolder) {
                        this.addSubfolderParentId = parentId;
                        this.addSubfolderParentName = parentFolder.name;
                        this.newSubfolderName = '';
                        this.newSubfolderDescription = '';
                        this.showAddSubfolderModal = true;
                        this.showContextMenu = null;
                    }
                },

                openMoveModal(itemId, itemName, itemType = 'folder') {
                    this.moveItemId = itemId;
                    this.moveItemName = itemName;
                    this.moveItemType = itemType;
                    this.selectedMoveLocation = null;
                    this.selectedMoveLocationId = null;
                    this.showMoveModal = true;
                    this.showContextMenu = null;
                },

                openRenameModal(itemId, currentName, itemType = 'folder') {
                    this.renameItemId = itemId;
                    this.renameCurrentName = currentName;
                    this.renameNewName = currentName;
                    this.renameItemType = itemType;
                    this.showRenameModal = true;
                    this.showContextMenu = null;
                },

                openDeleteConfirmationModal(itemId, itemName, itemType = 'folder') {
                    this.deleteItemId = itemId;
                    this.deleteItemName = itemName;
                    this.deleteItemType = itemType;
                    
                    if (itemType === 'folder') {
                        const folder = this.findFolderById(itemId);
                        this.deleteItemCount = folder ? this.getTotalFolderItemCount(folder) : 0;
                    } else {
                        this.deleteItemCount = 0; // Questions and surveys don't have child items
                    }
                    
                    this.showDeleteModal = true;
                    this.showContextMenu = null;
                },

                showSurveyInfo(surveyId) {
                    const survey = this.surveys.find(s => s.id === surveyId);
                    if (survey) {
                        this.surveyInfoId = surveyId;
                        this.surveyInfoData = survey;
                        this.surveyKeywords = survey.keywords || [];
                        this.currentKeywordInput = '';
                        this.showSurveyInfoModal = true;
                        this.showContextMenu = null;
                    }
                },

                showQuestionInfo(questionId) {
                    const question = this.questions.find(q => q.id === questionId);
                    if (question) {
                        this.questionInfoId = questionId;
                        this.questionInfoData = question;
                        this.showQuestionInfoModal = true;
                        this.showContextMenu = null;
                    }
                },

                openEditQuestionModal(questionId) {
                    const question = this.questions.find(q => q.id === questionId);
                    if (question) {
                        this.editQuestionId = questionId;
                        this.editQuestionData = { ...question }; // Create a copy for editing
                        this.showEditQuestionModal = true;
                        this.showContextMenu = null;
                    }
                },

                addKeyword() {
                    const keyword = this.currentKeywordInput.trim();
                    if (keyword && !this.surveyKeywords.includes(keyword)) {
                        this.surveyKeywords.push(keyword);
                        this.currentKeywordInput = '';
                        
                        // Update the survey data
                        if (this.surveyInfoData) {
                            this.surveyInfoData.keywords = [...this.surveyKeywords];
                        }
                    }
                },

                removeKeyword(keyword) {
                    this.surveyKeywords = this.surveyKeywords.filter(k => k !== keyword);
                    
                    // Update the survey data
                    if (this.surveyInfoData) {
                        this.surveyInfoData.keywords = [...this.surveyKeywords];
                    }
                },

                // Modal action functions
                createSubfolder() {
                    if (!this.newSubfolderName.trim() || !this.addSubfolderParentId) return;
                    
                    const parentFolder = this.findFolderById(this.addSubfolderParentId);
                    if (parentFolder && parentFolder.level < 3) { // Max 4 levels (0-3)
                        const newSubfolder = {
                            id: Date.now(),
                            name: this.newSubfolderName.trim(),
                            description: this.newSubfolderDescription.trim(),
                            level: parentFolder.level + 1,
                            parentId: this.addSubfolderParentId,
                            children: []
                        };
                        
                        parentFolder.children.push(newSubfolder);
                        this.showAddSubfolderModal = false;
                        
                        // Reset form
                        this.newSubfolderName = '';
                        this.newSubfolderDescription = '';
                        this.addSubfolderParentId = null;
                        this.addSubfolderParentName = '';
                    }
                },

                confirmRename() {
                    if (!this.renameNewName.trim() || !this.renameItemId) return;
                    
                    if (this.renameItemType === 'folder') {
                        const folder = this.findFolderById(this.renameItemId);
                        if (folder) {
                            folder.name = this.renameNewName.trim();
                        }
                    } else if (this.renameItemType === 'question') {
                        const question = this.questions.find(q => q.id === this.renameItemId);
                        if (question) {
                            question.name = this.renameNewName.trim();
                        }
                    } else if (this.renameItemType === 'survey') {
                        const survey = this.surveys.find(s => s.id === this.renameItemId);
                        if (survey) {
                            survey.name = this.renameNewName.trim();
                        }
                    }
                    
                    this.showRenameModal = false;
                    
                    // Reset form
                    this.renameItemId = null;
                    this.renameCurrentName = '';
                    this.renameNewName = '';
                    this.renameItemType = 'folder';
                },

                confirmDelete() {
                    if (!this.deleteItemId) return;
                    
                    if (this.deleteItemType === 'folder') {
                        // Remove from folders structure recursively
                        this.removeFolderById(this.deleteItemId);
                        
                        // Remove all items that belong to this folder or its subfolders
                        const allDeletedFolderIds = this.getAllSubfolderIds(this.deleteItemId);
                        this.questions = this.questions.filter(q => !allDeletedFolderIds.includes(q.folderId));
                        this.surveys = this.surveys.filter(s => !allDeletedFolderIds.includes(s.folderId));
                    } else if (this.deleteItemType === 'question') {
                        this.questions = this.questions.filter(q => q.id !== this.deleteItemId);
                    } else if (this.deleteItemType === 'survey') {
                        this.surveys = this.surveys.filter(s => s.id !== this.deleteItemId);
                    }
                    
                    this.showDeleteModal = false;
                    
                    // Reset form
                    this.deleteItemId = null;
                    this.deleteItemName = '';
                    this.deleteItemCount = 0;
                    this.deleteItemType = 'folder';
                },

                // Helper function to remove folder from nested structure
                removeFolderById(folderId, folders = this.folders) {
                    for (let i = 0; i < folders.length; i++) {
                        if (folders[i].id === folderId) {
                            folders.splice(i, 1);
                            return true;
                        }
                        if (folders[i].children && folders[i].children.length > 0) {
                            if (this.removeFolderById(folderId, folders[i].children)) {
                                return true;
                            }
                        }
                    }
                    return false;
                },

                // Helper function to get all subfolder IDs recursively
                getAllSubfolderIds(folderId) {
                    const folder = this.findFolderById(folderId);
                    const ids = [folderId];
                    
                    if (folder && folder.children) {
                        folder.children.forEach(child => {
                            ids.push(...this.getAllSubfolderIds(child.id));
                        });
                    }
                    
                    return ids;
                },

                getUngroupedItems() {
                    const currentItems = this.currentView === 'questions' ? this.questions : this.surveys;
                    return currentItems.filter(item => {
                        const isUngrouped = item.folderId === null;
                        const matchesLanguage = item.language === this.selectedLanguage;
                        const matchesSearch = !this.searchTerm || item.name.toLowerCase().includes(this.searchTerm.toLowerCase());
                        return isUngrouped && matchesLanguage && matchesSearch;
                    });
                },

                getFilteredQuestions() {
                    return this.questions.filter(question => {
                        const matchesLanguage = question.language === this.selectedLanguage;
                        const matchesSearch = !this.searchTerm || question.name.toLowerCase().includes(this.searchTerm.toLowerCase());
                        return matchesLanguage && matchesSearch;
                    });
                },

                getFilteredSurveys() {
                    return this.surveys.filter(survey => {
                        const matchesLanguage = survey.language === this.selectedLanguage;
                        const matchesSearch = !this.searchTerm || survey.name.toLowerCase().includes(this.searchTerm.toLowerCase());
                        return matchesLanguage && matchesSearch;
                    });
                },

                createItem(type) {
                    // Close the modal first
                    this.showCreateModal = false;

                    // Handle the creation logic based on type
                    this.handleItemCreation(type);
                },

                handleItemCreation(type) {
                    switch (type) {
                        case 'surveys':
                            console.log('Creating new survey...');
                            // Add your survey creation logic here
                            break;
                        case 'events':
                            console.log('Creating new event...');
                            // Add your event creation logic here
                            break;
                        case 'exw-surveys':
                            console.log('Creating new EXW survey...');
                            // Add your EXW survey creation logic here
                            break;
                        case 'case-management':
                            console.log('Creating new case management...');
                            // Add your case management creation logic here
                            break;
                        case 'etests':
                            console.log('Creating new eTest...');
                            // Add your eTest creation logic here
                            break;
                        case 'assessments':
                            console.log('Creating new assessment...');
                            // Add your assessment creation logic here
                            break;
                        case 'touch-tablets':
                            console.log('Creating new touch tablet survey...');
                            // Add your touch tablet creation logic here
                            break;
                        case 'mobile-surveys':
                            console.log('Creating new mobile survey...');
                            // Add your mobile survey creation logic here
                            break;
                        default:
                            console.log('Unknown item type:', type);
                    }
                },

                editFolder(folderId) {
                    // Implement folder editing functionality
                    console.log('Edit folder:', folderId);
                },

                // Checkbox selection methods
                toggleQuestionSelection(questionId) {
                    if (this.selectedQuestions.includes(questionId)) {
                        this.selectedQuestions = this.selectedQuestions.filter(id => id !== questionId);
                    } else {
                        this.selectedQuestions.push(questionId);
                    }
                    this.updateSelectAllQuestions();
                },

                toggleSurveySelection(surveyId) {
                    if (this.selectedSurveys.includes(surveyId)) {
                        this.selectedSurveys = this.selectedSurveys.filter(id => id !== surveyId);
                    } else {
                        this.selectedSurveys.push(surveyId);
                    }
                    this.updateSelectAllSurveys();
                },

                toggleSelectAllQuestions() {
                    if (this.selectAllQuestions) {
                        this.selectedQuestions = this.getFilteredQuestions().map(q => q.id);
                    } else {
                        this.selectedQuestions = [];
                    }
                },

                toggleSelectAllSurveys() {
                    if (this.selectAllSurveys) {
                        this.selectedSurveys = this.getFilteredSurveys().map(s => s.id);
                    } else {
                        this.selectedSurveys = [];
                    }
                },

                updateSelectAllQuestions() {
                    const filteredQuestions = this.getFilteredQuestions();
                    this.selectAllQuestions = filteredQuestions.length > 0 && 
                        filteredQuestions.every(q => this.selectedQuestions.includes(q.id));
                },

                updateSelectAllSurveys() {
                    const filteredSurveys = this.getFilteredSurveys();
                    this.selectAllSurveys = filteredSurveys.length > 0 && 
                        filteredSurveys.every(s => this.selectedSurveys.includes(s.id));
                },

                // Action methods
                deleteSelectedItems() {
                    if (this.currentView === 'questions') {
                        this.questions = this.questions.filter(q => !this.selectedQuestions.includes(q.id));
                        this.selectedQuestions = [];
                        this.selectAllQuestions = false;
                    } else {
                        this.surveys = this.surveys.filter(s => !this.selectedSurveys.includes(s.id));
                        this.selectedSurveys = [];
                        this.selectAllSurveys = false;
                    }
                },

                freezeSelectedItems() {
                    // Implement freeze functionality
                    const selectedIds = this.currentView === 'questions' ? this.selectedQuestions : this.selectedSurveys;
                    console.log('Freezing items:', selectedIds);
                    // Clear selection after action
                    if (this.currentView === 'questions') {
                        this.selectedQuestions = [];
                        this.selectAllQuestions = false;
                    } else {
                        this.selectedSurveys = [];
                        this.selectAllSurveys = false;
                    }
                },

                // Context menu methods
                toggleContextMenu(itemId, itemType) {
                    if (this.showContextMenu === itemId) {
                        this.showContextMenu = null;
                    } else {
                        this.showContextMenu = itemId;
                    }
                },

                deleteItem(itemId, itemType) {
                    if (itemType === 'question') {
                        this.questions = this.questions.filter(q => q.id !== itemId);
                    } else if (itemType === 'survey') {
                        this.surveys = this.surveys.filter(s => s.id !== itemId);
                    }
                    this.showContextMenu = null;
                },

                freezeItem(itemId, itemType) {
                    // Find the item to get its name
                    const allItems = [...this.questions, ...this.surveys];
                    const item = allItems.find(item => item.id === itemId);
                    
                    this.freezeItemId = itemId;
                    this.freezeItemName = item ? item.name : 'Unknown Item';
                    this.freezeItemType = itemType;
                    this.selectedFreezeFolder = null;
                    
                    // Initialize freeze modal state
                    this.selectedFrozenQuestions = [1, 2]; // Start with all questions selected
                    this.selectAllQuestions = true;
                    
                    this.showFreezeModal = true;
                    this.showContextMenu = null;
                },

                confirmFreeze() {
                    if (!this.freezeItemId) return;
                    
                    // Here you would implement the actual freeze logic
                    console.log(`Freezing ${this.freezeItemType} ${this.freezeItemId} (${this.freezeItemName})`);
                    console.log('Allow questions:', this.allowQuestions);
                    console.log('Allow pages:', this.allowPages);
                    console.log('Select all questions:', this.selectAllQuestions);
                    console.log('Show only titles:', this.showOnlyTitles);
                    console.log('Selected frozen questions:', this.selectedFrozenQuestions);
                    
                    // Close the modal and reset state
                    this.showFreezeModal = false;
                    this.freezeItemId = null;
                    this.freezeItemName = '';
                    this.freezeItemType = '';
                    this.selectedFreezeFolder = null;
                    this.allowQuestions = true;
                    this.allowPages = false;
                },

                // Freeze modal question selection methods
                toggleSelectAllFrozenQuestions() {
                    if (this.selectAllQuestions) {
                        // Select all questions (in this case, questions 1 and 2)
                        this.selectedFrozenQuestions = [1, 2];
                    } else {
                        // Deselect all questions
                        this.selectedFrozenQuestions = [];
                    }
                },

                toggleFrozenQuestionSelection(questionId) {
                    if (this.selectedFrozenQuestions.includes(questionId)) {
                        this.selectedFrozenQuestions = this.selectedFrozenQuestions.filter(id => id !== questionId);
                    } else {
                        this.selectedFrozenQuestions.push(questionId);
                    }
                    // Update the select all checkbox state
                    this.updateSelectAllFrozenQuestions();
                },

                updateSelectAllFrozenQuestions() {
                    // Check if all available questions are selected
                    const allQuestionIds = [1, 2]; // Available questions in the freeze modal
                    this.selectAllQuestions = allQuestionIds.length > 0 && 
                        allQuestionIds.every(id => this.selectedFrozenQuestions.includes(id));
                },

                isQuestionSelected(questionId) {
                    return this.selectedFrozenQuestions.includes(questionId);
                },

                hasSelectedItems() {
                    return this.currentView === 'questions' 
                        ? this.selectedQuestions.length > 0 
                        : this.selectedSurveys.length > 0;
                },

                // Helper functions to count languages for surveys and questions
                getSurveyLanguageCount(survey) {
                    if (survey.translationOf) {
                        // This is a translation, find the original and all its translations
                        const originalId = survey.translationOf;
                        const original = this.surveys.find(s => s.id === originalId);
                        const translations = this.surveys.filter(s => s.translationOf === originalId);
                        return original ? translations.length + 1 : 1;
                    } else {
                        // This is an original, find all its translations
                        const translations = this.surveys.filter(s => s.translationOf === survey.id);
                        return translations.length + 1;
                    }
                },

                getQuestionLanguageCount(question) {
                    if (question.translationOf) {
                        // This is a translation, find the original and all its translations
                        const originalId = question.translationOf;
                        const original = this.questions.find(q => q.id === originalId);
                        const translations = this.questions.filter(q => q.translationOf === originalId);
                        return original ? translations.length + 1 : 1;
                    } else {
                        // This is an original, find all its translations
                        const translations = this.questions.filter(q => q.translationOf === question.id);
                        return translations.length + 1;
                    }
                },

                getSurveyLanguages(survey) {
                    const languages = new Set();
                    
                    if (survey.translationOf) {
                        // This is a translation, find the original and all its translations
                        const originalId = survey.translationOf;
                        const original = this.surveys.find(s => s.id === originalId);
                        const translations = this.surveys.filter(s => s.translationOf === originalId);
                        
                        if (original) languages.add(original.language);
                        translations.forEach(t => languages.add(t.language));
                    } else {
                        // This is an original, find all its translations
                        languages.add(survey.language);
                        const translations = this.surveys.filter(s => s.translationOf === survey.id);
                        translations.forEach(t => languages.add(t.language));
                    }
                    
                    return Array.from(languages);
                },

                getQuestionLanguages(question) {
                    const languages = new Set();
                    
                    if (question.translationOf) {
                        // This is a translation, find the original and all its translations
                        const originalId = question.translationOf;
                        const original = this.questions.find(q => q.id === originalId);
                        const translations = this.questions.filter(q => q.translationOf === originalId);
                        
                        if (original) languages.add(original.language);
                        translations.forEach(t => languages.add(t.language));
                    } else {
                        // This is an original, find all its translations
                        languages.add(question.language);
                        const translations = this.questions.filter(q => q.translationOf === question.id);
                        translations.forEach(t => languages.add(t.language));
                    }
                    
                    return Array.from(languages);
                }
            }
        }
    </script>

</body>

</html>
