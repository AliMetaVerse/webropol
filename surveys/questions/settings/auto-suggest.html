<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Auto-Suggest Settings - Webropol</title>
        <link rel="stylesheet" href="../../../design-system/styles/tokens.css">
        <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v6.0.0-beta3/css/all.css">
        <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, var(--neutral-50) 0%, var(--primary-50) 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .demo-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .demo-header h1 {
            color: var(--primary-700);
            font-size: var(--font-size-3xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: 0.5rem;
        }

        .demo-header p {
            color: var(--neutral-600);
            font-size: var(--font-size-lg);
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 0.625rem 1.5rem;
            border: none;
            border-radius: 9999px;
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--transition-normal) ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: var(--font-size-sm);
        }

        .btn-primary {
            background: var(--primary-600);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-700);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: white;
            color: var(--neutral-700);
            border: 1px solid #0891b2;
        }

        .btn-secondary:hover {
            background: #ccf7fe;
            border-color: var(--neutral-400);
        }

        .btn:disabled,
        .btn[disabled] {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-primary:disabled,
        .btn-primary[disabled] {
            background: var(--neutral-300);
            color: var(--neutral-500);
        }

        .btn-secondary:disabled,
        .btn-secondary[disabled] {
            background: var(--neutral-100);
            color: var(--neutral-400);
            border-color: var(--neutral-300);
        }

        .delete-btn:hover i {
            color: #dc2626 !important;
        }

        hr {
            border: none;
            height: 1px;
            background: var(--neutral-100);
            margin: -0.2rem 0 1.5rem;
        }

        .btn i {
            font-size: var(--font-size-lg);
        }

        .btn i.fal {
            color: var(--primary-600);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal) ease;
            padding: 1rem;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-2xl);
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            transform: scale(0.9) translateY(20px);
            transition: all var(--transition-normal) ease;
            display: flex;
            flex-direction: column;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1) translateY(0);
        }

        .modal-header {
            padding: 1.25rem 1.5rem;
            background: var(--neutral-0);
            border-bottom: 1px solid var(--neutral-200);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .modal-title-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 0.25rem;
        }

        .modal-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--primary-800);
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .modal-subtitle {
            font-size: var(--font-size-sm);
            color: var(--neutral-600);
            /* align subtitle with the title text (skip the icon) */
            margin-left: calc(2.5rem + 0.75rem);
        }

        .modal-close {
            width: 2.5rem;
            height: 2.5rem;
            border: none;
            background: var(--neutral-100);
            border-radius: var(--border-radius-lg);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--neutral-500);
            transition: all var(--transition-fast) ease;
        }

        .modal-close:hover {
            background: var(--neutral-200);
            color: var(--neutral-700);
        }

        .modal-body {
            padding: 1.5rem;
            overflow-y: auto;
            flex: 1;
        }

        .settings-section {
            margin-bottom: 2rem;
        }

        .settings-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--neutral-800);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: var(--font-weight-medium);
            color: var(--neutral-700);
            margin-bottom: 0.5rem;
            font-size: var(--font-size-sm);
        }

        .form-label .required {
            color: var(--error-500);
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        /* Orientation row: increase horizontal spacing between Vertical and Horizontal */
        .radio-group.orientation-row {
            gap: 1.75rem;
        }

        /* When a radio item contains an adjacent control (like the custom count), keep the title from flexing */
        .radio-item.has-input .radio-content {
            flex: 0 1 auto;
            margin-right: 0.5rem;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
        }

        /* For radio items that contain an inline control, keep content and control on same line */
        .radio-group .radio-item.has-input {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .radio-input {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: var(--primary-600);
        }

        .radio-content {
            flex: 1;
        }

        .radio-title {
            font-weight: var(--font-weight-medium);
            color: var(--neutral-800);
            margin-bottom: 0.25rem;
        }

        .input-row {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        /* Custom options: reduce vertical gap and tighten between number input and helper */
        .custom-input-row {
            margin-top: 0.4rem;
            /* set inline as well, kept here for clarity */
            gap: 0.4rem;
        }

        .form-input {
            padding: 0.75rem 1rem;
            border: 1px solid var(--neutral-300);
            border-radius: var(--border-radius-lg);
            font-size: var(--font-size-sm);
            transition: all var(--transition-fast) ease;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
        }

        .form-select {
            /* leave room on the right for the chevron and align text */
            padding: 0.75rem 1rem 0.75rem 1rem;
            padding-right: 2.5rem;
            border: 1px solid var(--neutral-300);
            border-radius: var(--border-radius-lg);
            font-size: var(--font-size-sm);
            background: white;
            cursor: pointer;
            min-width: 150px;
            /* remove native appearance so we can control the chevron spacing */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            /* lightweight inline SVG chevron (percent-encoded) */
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3Cpath fill='%23333' d='M31 192h258c28.4 0 42.8 34.5 22.6 54.6l-129 129c-12.5 12.5-32.8 12.5-45.3 0l-129-129C-11.8 226.5 4.6 192 31 192z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 12px 12px;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
        }

        .form-helper {
            font-size: var(--font-size-xs);
            color: var(--neutral-500);
            margin-top: 0.25rem;
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            transition: all var(--transition-fast) ease;
        }


        .checkbox-input {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: var(--primary-600);
            margin-top: 0.125rem;
        }

        .checkbox-content {
            flex: 1;
        }

        .checkbox-title {
            font-weight: var(--font-weight-medium);
            color: var(--neutral-800);
            margin-bottom: 0.5rem;
        }

        .placement-options {
            margin-left: 1.75rem;
            margin-top: 0.75rem;
        }

        .placement-radio {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .placement-radio .radio-item {
            margin: 0;
        }

        .file-upload-section-button {
            text-align: center;
            margin-bottom: 1rem;
        }

        .file-upload-section {
            background: var(--neutral-50);
            border: 2px dashed var(--neutral-300);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1rem;
        }

        .file-upload-icon {
            width: 3rem;
            height: 3rem;
            background: var(--primary-100);
            color: var(--primary-600);
            border-radius: var(--border-radius-lg);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }

        .upload-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--neutral-0);
            color: var(--neutral-900);
            border-radius: var(--border-radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            margin: 0;
        }

        .file-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin-top: 1rem;
        }

        .file-actions>* {
            display: inline-flex;
            align-items: center;
        }

        .visibility-section {
            background: var(--neutral-50);
            border: 1px solid var(--neutral-200);
            border-radius: var(--border-radius-lg);
            padding: 1rem;
        }

        /* Row layout for visibility: keep title and controls aligned horizontally */
        .settings-section.visibility-row {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .settings-section.visibility-row .section-title {
            margin-bottom: 0; /* remove default bottom spacing */
            flex: 0 0 auto;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .settings-section.visibility-row .visibility-options {
            display: flex;
            gap: 1.25rem; /* spacing between radio items */
            align-items: center; /* vertically center icons and labels */
            justify-content: flex-start;
            flex: 1 1 auto; /* take remaining horizontal space */
        }

        .visibility-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .visibility-icon {
            width: 1.5rem;
            height: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-md);
            font-size: var(--font-size-sm);
        }

        .visibility-visible .visibility-icon {
            background: var(--success-100);
            color: var(--success-600);
        }

        .visibility-hidden .visibility-icon {
            background: var(--warning-100);
            color: var(--warning-600);
        }

        .visibility-disabled .visibility-icon {
            background: var(--neutral-200);
            color: var(--neutral-500);
        }

        .modal-footer {
            padding: 1.5rem;
            background: var(--neutral-0);
            border-top: 1px solid var(--neutral-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .keywords-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .keywords-label {
            font-size: var(--font-size-sm);
            color: var(--neutral-600);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .keywords-count {
            background: var(--neutral-200);
            color: var(--neutral-700);
            padding: 0.25rem 0.5rem;
            border-radius: var(--border-radius-full);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
        }

        /* Inline keywords input and chips (UI-only, no JS behavior) */
        .keywords-input {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--neutral-0);
            padding: 0.5rem;
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--neutral-200);
        }

        .keywords-input input[type="text"] {
            border: none;
            outline: none;
            font-size: var(--font-size-sm);
            padding: 0.25rem 0.5rem;
            background: transparent;
            min-width: 160px;
        }

        .keywords-chips {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .keyword-chip {
            background: var(--neutral-100);
            color: var(--neutral-800);
            padding: 0.25rem 0.5rem;
            border-radius: var(--border-radius-full);
            font-size: var(--font-size-xs);
        }

        .footer-actions {
            display: flex;
            gap: 0.75rem;
            margin-left: auto;
            /* push actions to the right when possible */
        }

        .info-tooltip {
            position: relative;
            cursor: help;
        }

        /* Unified tooltip icon styling */
        .info-tooltip i {
            color: var(--primary-800);
            margin-left: 0.5rem;
            font-size: var(--font-size-lg);
            line-height: 1;
            vertical-align: middle;
        }

        /* Disable CSS pseudo tooltip; we'll use a JS floating tooltip appended to the document body */
        .info-tooltip::after {
            display: none !important;
            content: none !important;
        }

        .floating-tooltip {
            position: fixed;
            background: var(--neutral-800);
            color: white;
            padding: 0.75rem;
            border-radius: var(--border-radius-md);
            font-size: var(--font-size-xs);
            line-height: 1.3;
            max-width: 520px;
            box-shadow: 0 8px 26px rgba(0, 0, 0, 0.18);
            z-index: 99999;
            word-wrap: break-word;
            text-align: left;
            pointer-events: none;
            opacity: 0;
            transition: opacity 150ms ease;
        }

        .floating-tooltip.visible {
            opacity: 1;
        }

        .enhanced-feature {
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--accent-50) 100%);
            border: 1px solid var(--primary-200);
            border-radius: var(--border-radius-lg);
            padding: 1rem;
            margin-top: 1rem;
        }

        .feature-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .feature-icon {
            width: 1.5rem;
            height: 1.5rem;
            background: var(--primary-600);
            color: white;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xs);
        }

        .feature-title {
            font-weight: var(--font-weight-semibold);
            color: var(--primary-800);
        }

        .feature-description {
            font-size: var(--font-size-sm);
            color: var(--neutral-600);
            margin-bottom: 0.75rem;
        }

        .feature-benefits {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .benefit-tag {
            background: white;
            color: var(--primary-700);
            padding: 0.25rem 0.5rem;
            border-radius: var(--border-radius-full);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
        }

        @media (max-width: 768px) {
            .modal-content {
                margin: 1rem;
                max-height: calc(100vh - 2rem);
            }

            /* subtitle should align naturally on small screens */
            .modal-subtitle {
                margin-left: 0;
            }

            .visibility-options {
                flex-direction: column;
                gap: 0.75rem;
            }

            .footer-actions {
                flex-direction: column;
                width: 100%;
            }

            .btn {
                justify-content: center;
            }
        }

        /* Utility classes for icon backgrounds */
        .w-10 {
            width: 2.5rem;
        }

        .h-10 {
            height: 2.5rem;
        }

        .bg-sun-to-br {
            background: linear-gradient(to bottom right, var(--primary-100), var(--accent-100));
        }

        .from-orange-100 {
            --primary-100: #fed7aa;
        }

        .to-orange-100 {
            --accent-100: #fed7aa;
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .text-orange-600 {
            color: #ea580c;
        }

        .text-lg {
            font-size: 1.125rem;
        }

    /* Minimal spacing utilities used in templates */
    .ml-1 { margin-left: 0.25rem; }
    .ml-2 { margin-left: 0.5rem; }
    .ml-3 { margin-left: 0.75rem; }
    .ml-4 { margin-left: 1rem; }
    .ml-8 { margin-left: 2rem; }
        </style>
    </head>
    <body>
        <div class="demo-container">
            <div class="demo-header">
                <h1 class="page-title">Auto-Suggest Settings</h1>
                <p>Enhanced question settings with improved auto-suggestion flow</p>
            </div>
            <div class="demo-controls">
                <button class="btn btn-primary" onclick="openModal()">
                    <i class="fal fa-cog"></i>
                    Open Question Settings
                </button>
                <button class="btn btn-secondary" onclick="openUploadModal()">
                    <i class="fal fa-upload"></i>
                    Upload Auto-Suggest
                </button>
            </div>
        </div>
        <!-- Main Settings Modal -->
        <div id="settingsModal" class="modal-overlay">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <h2 class="modal-title">
                            <div class="w-10 h-10 bg-sun-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center">
                                <i class="fal fa-cog text-orange-600 text-lg"></i>
                            </div>
                            Question settings
                        </h2>
                    </div>
                    <button class="modal-close" onclick="closeModal()" aria-label="Close modal">
                        <i class="fal fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Option Orientation Section -->
                    <div class="settings-section">
                        <h3 class="section-title">
                            Option orientation
                        </h3>
                        <div class="form-group">
                            <div class="radio-group orientation-row" style="flex-direction: row;">
                                <label class="radio-item active">
                                    <input
                                        type="radio"
                                        name="orientation"
                                        value="vertical"
                                        class="radio-input"
                                        checked
                                    >
                                    <div class="radio-content">
                                        <div class="radio-title">Vertical</div>
                                    </div>
                                </label>
                                <label class="radio-item">
                                    <input
                                        type="radio"
                                        name="orientation"
                                        value="horizontal"
                                        class="radio-input"
                                    >
                                    <div class="radio-content">
                                        <div class="radio-title">Horizontal</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <!-- Column Configuration Section -->
                    <div class="settings-section">
                        <h3 class="section-title">
                            Number of options per column
                        </h3>
                        <div class="form-group">
                            <div class="radio-group">
                                <label class="radio-item active">
                                    <input
                                        type="radio"
                                        name="columns"
                                        value="all"
                                        class="radio-input"
                                        checked
                                    >
                                    <div class="radio-content">
                                        <div class="radio-title">All options in same column</div>
                                    </div>
                                </label>
                                <label class="radio-item has-input">
                                    <input
                                        type="radio"
                                        name="columns"
                                        value="custom"
                                        class="radio-input"
                                    >
                                    <div class="radio-content">
                                        <div class="radio-title">Custom options per column</div>
                                    </div>
                                    <div class="input-row custom-input-row">
                                        <input
                                            type="number"
                                            class="form-input"
                                            value="1"
                                            min="1"
                                            max="10"
                                            style="width: 60px; margin-top: -6px; margin-right: 4px;"
                                        >
                                        <span class="form-helper" style="margin-top: -8px;">options per column</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="flex" style="gap: 2rem;">
                        <!-- Option Placement Section -->
                        <div class="settings-section" style="flex: 1; margin-bottom: 0;">
                            <h3 class="section-title">
                                Option placement title
                            </h3>
                            <div class="form-group">
                                <label class="form-label">Title position</label>
                                <select class="form-select">
                                    <option value="left">Left</option>
                                    <option value="right">Right</option>
                                    <option value="center">Center</option>
                                    <option value="top">Top</option>
                                    <option value="bottom">Bottom</option>
                                </select>
                            </div>
                        </div>
                        <!-- Text Field Configuration -->
                        <div class="settings-section" style="flex: 1; margin-bottom: 0;">
                            <h3 class="section-title">
                                Text field size
                            </h3>
                            <div class="form-group">
                                <label class="form-label">Width</label>
                                <div class="input-row">
                                    <input
                                        type="number"
                                        class="form-input"
                                        value="40"
                                        min="1"
                                        max="150"
                                        style="width: 100px;"
                                    >
                                    <span class="form-helper">characters (range 1-150)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <!-- Question Description Section -->
                    <div class="settings-section">
                        <h3 class="section-title">
                            Question description
                            <span class="info-tooltip" data-tooltip="Additional information to help users understand the question">
                                <i class="fal fa-question-circle"></i>
                            </span>
                        </h3>
                        <div class="form-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="showDescription" class="checkbox-input">
                                <div class="checkbox-content">
                                    <label for="showDescription" class="checkbox-title">Show question description</label>
                                    <div class="placement-options" id="placementOptions" style="display: none;">
                                        <label class="form-label">Placement</label>
                                        <div class="placement-radio">
                                            <label class="radio-item">
                                                <input
                                                    type="radio"
                                                    name="description-placement"
                                                    value="below"
                                                    class="radio-input"
                                                    checked
                                                >
                                                <span>Show below question title</span>
                                            </label>
                                            <label class="radio-item">
                                                <input
                                                    type="radio"
                                                    name="description-placement"
                                                    value="above"
                                                    class="radio-input"
                                                >
                                                <span>Show above question title</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <!-- Auto-Suggest Section -->
                    <div class="settings-section">
                        <h3 class="section-title">
                            Auto-suggest File
                            <span class="info-tooltip" data-tooltip="When uploading an AutoSuggest file with more than 1,000 options, it will be placed into a processing queue. While processing you won't be able to send out your survey. Once complete, you'll receive an email notification.">
                                <i class="fal fa-question-circle"></i>
                            </span>
                        </h3>
                        <div class="file-upload-section-button">
                            <div class="file-actions">
                                <button class="btn btn-primary" onclick="openUploadModal()">
                                    Upload file
                                </button>
                                <div id="mainUploadStatus" class="upload-status">
                                    No file uploaded
                                </div>
                            </div>
                            <p class="form-helper" style="margin-top: 1rem;">
                                Note: File must be in CSV format, comma delimited. Maximum file size: 10MB
                            </p>
                        </div>
                    </div>
                    <hr>
                    <!-- Visibility Section -->
                    <div class="settings-section visibility-row">
                        <h3 class="section-title">
                            Visibility
                        </h3>
                        <div class="visibility-options ml-8">
                            <label class="visibility-item visibility-visible">
                                <input
                                    type="radio"
                                    name="visibility"
                                    value="visible"
                                    checked
                                >
                                <div class="visibility-icon">
                                    <i class="fal fa-eye"></i>
                                </div>
                                <span>Visible</span>
                            </label>
                            <label class="visibility-item visibility-hidden">
                                <input type="radio" name="visibility" value="hidden">
                                <div class="visibility-icon">
                                    <i class="fal fa-eye-slash"></i>
                                </div>
                                <span>Hidden</span>
                            </label>
                            <label class="visibility-item visibility-disabled">
                                <input type="radio" name="visibility" value="disabled">
                                <div class="visibility-icon">
                                    <i class="fal fa-ban"></i>
                                </div>
                                <span>Disabled</span>
                            </label>
                        </div>
                    </div>
                    <hr>
                    <!-- Keywords / Save to library -->
                    <div class="settings-section">
                        <div style="display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap;">
                            <button class="btn btn-secondary" style="display:inline-flex; align-items:center; gap:0.5rem;">
                                <i class="fal fa-save"></i>
                                Save question to library
                            </button>
                            <div style="display:flex; align-items:center; gap:1rem;">
                                <div class="keywords-label">
                                    <i class="fal fa-tags"></i>
                                    Keywords
                                    <span class="keywords-count">0</span>
                                    <span class="info-tooltip" data-tooltip="Add keywords to help categorize and find this question later">
                                        <i class="fal fa-question-circle"></i>
                                    </span>
                                </div>
                                <div class="keywords-input" aria-hidden="true">
                                    <div class="keywords-chips"></div>
                                    <input type="text" placeholder="Add a keyword">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="footer-actions">
                        <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                        <button class="btn btn-primary">
                            Apply
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Upload Modal -->
        <div id="uploadModal" class="modal-overlay">
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <h2 class="modal-title">
                            <div class="w-10 h-10 bg-sun-to-br from-orange-100 to-orange-100 rounded-full flex items-center justify-center">
                                <i class="fal fa-upload text-orange-600 text-lg"></i>
                            </div>
                            Upload answer options for auto-suggest list
                        </h2>
                    </div>
                    <button class="modal-close" onclick="closeUploadModal()" aria-label="Close modal">
                        <i class="fal fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <h3 class="section-title">
                            <i class="fal fa-download"></i>
                            Download template
                        </h3>
                        <p style="margin-bottom: 1rem; color: var(--neutral-600);">
                            Start with our template to ensure proper formatting
                        </p>
                        <button class="btn btn-secondary" onclick="downloadTemplate()">
                            <i class="fal fa-download"></i>
                            Get template file
                        </button>
                    </div>
                    <hr>
                    <div class="settings-section">
                        <h3 class="section-title">
                            <i class="fal fa-upload"></i>
                            Upload template
                        </h3>
                        <p style="margin-bottom: 1rem; color: var(--neutral-600);">
                            Note: must be in CSV format, comma delimited
                        </p>
                        <div class="file-upload-section">
                            <div class="file-upload-icon">
                                <i class="fal fa-cloud-upload"></i>
                            </div>
                            <p style="margin-bottom: 1rem;">
                                <strong>Choose File</strong>
                                or drag and drop your CSV file here
                            </p>
                            <input
                                type="file"
                                id="csvFile"
                                accept=".csv"
                                style="display: none;"
                            >
                            <div style="display: flex; gap: 0.5rem; align-items: center; justify-content: center;">
                                <button id="chooseFileBtn" class="btn btn-secondary" onclick="document.getElementById('csvFile').click()">
                                    <i class="fal fa-folder-open" style="margin-right: 0.5rem;"></i>
                                    Choose File
                                </button>
                                <button id="uploadBtn" class="btn btn-primary" onclick="performUpload()" disabled>
                                    <i class="fal fa-cloud-upload" style="margin-right: 0.5rem; color: white;"></i>
                                    Upload
                                </button>
                            </div>
                            <div id="fileName" style="margin-top: 1rem; font-weight: var(--font-weight-medium); color: var(--primary-600);"></div>
                            <button id="removeFileBtn" class="btn" style="display: none; margin-top: 0.75rem; background: var(--neutral-50); border: none; color: var(--neutral-500); padding: 0.625rem; border-radius: 50%; cursor: pointer; transition: all 0.2s ease; width: 2.5rem; height: 2.5rem; align-items: center; justify-content: center;" onclick="removeSelectedFile()" onmouseover="this.querySelector('i').style.color='#dc2626'" onmouseout="this.querySelector('i').style.color='#6b7280'">
                                <i class="fal fa-trash" style="font-size: 1rem; transition: color 0.2s ease; color: #6b7280;"></i>
                            </button>
                        </div>
                    </div>
                    <div class="settings-section">
                        <button id="removeStoredBtn" class="btn btn-secondary" onclick="removeAutoSuggest()" disabled>
                            <i class="fal fa-trash" style="margin-right: 0.5rem;"></i>
                            Remove uploaded auto-suggest list
                    </div>
                <div class="modal-footer">
                    <div></div>
                    <div class="footer-actions">
                        <button class="btn btn-secondary" onclick="closeUploadModal()">Cancel</button>
                        <button id="applyBtn" class="btn btn-primary" onclick="applyAndClose()" disabled>
                            Apply
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <script>
        // Modal functionality
        function openModal() {
            document.getElementById('settingsModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('settingsModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        function openUploadModal() {
            document.getElementById('uploadModal').classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Check if there are uploaded files and set Apply button state
            const mainUploadStatus = document.getElementById('mainUploadStatus');
            const applyBtn = document.getElementById('applyBtn');
            
            if (applyBtn) {
                // Enable Apply if there are uploaded files, disable if not
                const hasUploadedFile = mainUploadStatus && mainUploadStatus.innerHTML.includes('fa-file-csv');
                applyBtn.disabled = !hasUploadedFile;
            }
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        // File upload functionality
        document.getElementById('csvFile').addEventListener('change', function (e) {
            const file = e.target.files[0];
            const fileNameDiv = document.getElementById('fileName');
            const uploadBtn = document.getElementById('uploadBtn');
            const chooseFileBtn = document.getElementById('chooseFileBtn');
            const removeFileBtn = document.getElementById('removeFileBtn');
            const removeStoredBtn = document.getElementById('removeStoredBtn');

            if (file) {
                fileNameDiv.innerHTML = `<i class="fal fa-file-csv"></i> ${file.name} (${(file.size / 1024).toFixed(1)} KB)`;
                uploadBtn.disabled = false;
                uploadBtn.innerHTML = '<i class="fal fa-cloud-upload" style="margin-right: 0.5rem; color: white;"></i>Upload';
                
                // Reset choose file button text if it was previously "Replace File"
                if (chooseFileBtn && chooseFileBtn.innerHTML.includes('Replace File')) {
                    chooseFileBtn.innerHTML = '<i class="fal fa-folder-open" style="margin-right: 0.5rem;"></i>Choose File';
                }
                
                if (removeFileBtn) {
                    removeFileBtn.style.display = 'inline-flex';
                    removeFileBtn.style.alignItems = 'center';
                    removeFileBtn.style.justifyContent = 'center';
                }

                // Simulate file validation
                setTimeout(() => {
                    fileNameDiv.innerHTML += ` <span style="color: var(--success-600);"><i class="fal fa-check-circle"></i> Validated</span>`;
                    // Enable remove stored button after validation (simulates that a file is now uploaded)
                    if (removeStoredBtn) removeStoredBtn.disabled = false;
                }, 1000);
            } else {
                fileNameDiv.innerHTML = '';
                uploadBtn.disabled = true;
                uploadBtn.innerHTML = '<i class="fal fa-cloud-upload" style="margin-right: 0.5rem; color: white;"></i>Upload';
                
                // Reset choose file button text
                if (chooseFileBtn) {
                    chooseFileBtn.innerHTML = '<i class="fal fa-folder-open" style="margin-right: 0.5rem;"></i>Choose File';
                }
                
                if (removeFileBtn) removeFileBtn.style.display = 'none';
                if (removeStoredBtn) removeStoredBtn.disabled = true;
            }
        });

        // Allow removing a selected file before uploading (clears input and UI)
        function removeSelectedFile() {
            const input = document.getElementById('csvFile');
            const fileNameDiv = document.getElementById('fileName');
            const uploadBtn = document.getElementById('uploadBtn');
            const chooseFileBtn = document.getElementById('chooseFileBtn');
            const removeFileBtn = document.getElementById('removeFileBtn');
            const removeStoredBtn = document.getElementById('removeStoredBtn');

            if (!input) return;

            // Clear the input value (works for file inputs)
            input.value = '';

            // Reset UI
            if (fileNameDiv) fileNameDiv.innerHTML = '';
            if (uploadBtn) {
                uploadBtn.disabled = true;
                uploadBtn.innerHTML = '<i class="fal fa-cloud-upload" style="margin-right: 0.5rem; color: white;"></i>Upload';
            }
            if (chooseFileBtn) {
                chooseFileBtn.innerHTML = '<i class="fal fa-folder-open" style="margin-right: 0.5rem;"></i>Choose File';
            }
            if (removeFileBtn) removeFileBtn.style.display = 'none';
            if (removeStoredBtn) removeStoredBtn.disabled = true;
        }

        // Radio button interactions
        document.querySelectorAll('.radio-item').forEach(item => {
            item.addEventListener('click', function () {
                const radio = this.querySelector('input[type="radio"]');
                if (radio) {
                    // Remove active class from siblings
                    const siblings = this.closest('.radio-group').querySelectorAll('.radio-item');
                    siblings.forEach(sibling => sibling.classList.remove('active'));

                    // Add active class to clicked item
                    this.classList.add('active');
                    radio.checked = true;
                }
            });
        });

        // Checkbox interactions
        document.getElementById('showDescription').addEventListener('change', function () {
            const placementOptions = document.getElementById('placementOptions');
            placementOptions.style.display = this.checked ? 'block' : 'none';
        });

        // Template download
        function downloadTemplate() {
            // Simulate template download
            const csvContent = "Answer Option,Category,Description\nOption 1,Category A,Description for option 1\nOption 2,Category B,Description for option 2";
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'autosuggest-template.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Remove auto-suggest
        function removeAutoSuggest() {
            const removeStoredBtn = document.getElementById('removeStoredBtn');
            if (!removeStoredBtn || removeStoredBtn.disabled) return;

            if (confirm('Are you sure you want to remove the auto-suggest list? This action cannot be undone.')) {
                // Simulate removal
                alert('Auto-suggest list removed successfully.');
                
                // Update main modal status
                const mainUploadStatus = document.getElementById('mainUploadStatus');
                if (mainUploadStatus) {
                    mainUploadStatus.innerHTML = `
                        <span class="info-tooltip" data-tooltip="When uploading an AutoSuggest file with more than 1,000 options, it will be placed into a processing queue. While processing you won't be able to send out your survey. Once complete, you'll receive an email notification.">
                            <i class="fal fa-question-circle"></i>
                        </span>
                        No file uploaded
                    `;
                }
                
                // Disable the button after removal since there's no stored list anymore
                if (removeStoredBtn) removeStoredBtn.disabled = true;
                
                // Also clear any selected file
                removeSelectedFile();
                
                closeUploadModal();
            }
        }

        // Perform file upload
        function performUpload() {
            const uploadBtn = document.getElementById('uploadBtn');
            const chooseFileBtn = document.getElementById('chooseFileBtn');
            const csvFile = document.getElementById('csvFile');
            const mainUploadStatus = document.getElementById('mainUploadStatus');
            
            if (!csvFile.files[0] || uploadBtn.disabled) return;
            
            const file = csvFile.files[0];
            
            // Simulate upload process
            uploadBtn.disabled = true;
            uploadBtn.innerHTML = '<i class="fal fa-spinner fa-spin" style="margin-right: 0.5rem; color: white;"></i> Uploading...';
            
            setTimeout(() => {
                // Update main modal status
                if (mainUploadStatus) {
                    mainUploadStatus.innerHTML = `
                        <i class="fal fa-file-csv" style="color: var(--success-600);"></i>
                        ${file.name} (${(file.size / 1024).toFixed(1)} KB)
                        <button class="btn delete-btn" style="margin-left: 0.75rem; background: var(--neutral-50); border: none; color: var(--neutral-500); padding: 0.5rem; border-radius: 50%; cursor: pointer; transition: all 0.2s ease; width: 2rem; height: 2rem; display: inline-flex; align-items: center; justify-content: center;" onclick="removeUploadedFile()">
                            <i class="fal fa-trash" style="font-size: 0.875rem; transition: color 0.2s ease; color: #6b7280;"></i>
                        </button>
                    `;
                }
                
                // Reset upload button to success state
                uploadBtn.innerHTML = '<i class="fal fa-check" style="margin-right: 0.5rem; color: white;"></i>Uploaded';
                uploadBtn.disabled = true;
                
                // Change choose file button to replace file
                if (chooseFileBtn) {
                    chooseFileBtn.innerHTML = '<i class="fal fa-sync" style="margin-right: 0.5rem;"></i>Replace File';
                }
                
                // Enable Apply button since file is now uploaded
                const applyBtn = document.getElementById('applyBtn');
                if (applyBtn) applyBtn.disabled = false;
                
                // Keep modal open - user will press Apply to close
            }, 2000); // 2 second upload simulation
        }

        // Apply changes and close modal
        function applyAndClose() {
            closeUploadModal();
        }

        // Remove uploaded file from main modal
        function removeUploadedFile() {
            const mainUploadStatus = document.getElementById('mainUploadStatus');
            const removeStoredBtn = document.getElementById('removeStoredBtn');
            const applyBtn = document.getElementById('applyBtn');
            
            if (confirm('Are you sure you want to remove the uploaded auto-suggest file?')) {
                if (mainUploadStatus) {
                    mainUploadStatus.innerHTML = 'No file uploaded';
                }
                
                // Disable the remove stored button since no file is uploaded
                if (removeStoredBtn) removeStoredBtn.disabled = true;
                
                // Disable Apply button since no file is uploaded
                if (applyBtn) applyBtn.disabled = true;
                
                alert('File removed successfully!');
            }
        }

        // Close modals with Escape key
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeModal();
                closeUploadModal();
            }
        });

        // Close modals when clicking outside
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function (e) {
                if (e.target === this) {
                    closeModal();
                    closeUploadModal();
                }
            });
        });

        // Floating tooltips: append tooltip element to body to avoid clipping
        (function () {
            let tipEl = null;

            function showTip(target) {
                const text = target.getAttribute('data-tooltip');
                if (!text) return;
                if (!tipEl) {
                    tipEl = document.createElement('div');
                    tipEl.className = 'floating-tooltip';
                    document.body.appendChild(tipEl);
                }
                tipEl.innerText = text;
                tipEl.classList.add('visible');

                // Positioning
                const rect = target.getBoundingClientRect();
                const tipRect = tipEl.getBoundingClientRect();
                const spaceAbove = rect.top;
                const spaceBelow = window.innerHeight - rect.bottom;

                // Prefer above, but flip if not enough space
                let top = rect.top - tipRect.height - 10; // 10px offset
                let left = rect.left + (rect.width / 2) - (tipRect.width / 2);
                if (spaceAbove < tipRect.height + 12 && spaceBelow > spaceAbove) {
                    top = rect.bottom + 10;
                }

                // keep within viewport
                left = Math.max(8, Math.min(left, window.innerWidth - tipRect.width - 8));
                top = Math.max(8, Math.min(top, window.innerHeight - tipRect.height - 8));

                tipEl.style.left = left + 'px';
                tipEl.style.top = top + 'px';
            }

            function hideTip() {
                if (tipEl) {
                    tipEl.classList.remove('visible');
                }
            }

            document.querySelectorAll('.info-tooltip').forEach(el => {
                el.addEventListener('mouseenter', () => showTip(el));
                el.addEventListener('focus', () => showTip(el));
                el.addEventListener('mouseleave', hideTip);
                el.addEventListener('blur', hideTip);
            });

            // Reposition on resize/scroll
            window.addEventListener('resize', () => { if (tipEl && tipEl.classList.contains('visible')) tipEl.classList.remove('visible'); });
            window.addEventListener('scroll', () => { if (tipEl && tipEl.classList.contains('visible')) tipEl.classList.remove('visible'); }, true);
        })();

        // Auto-open modal on page load
        document.addEventListener('DOMContentLoaded', function () {
            openModal();
        });

        // Keywords input behaviour (ported from mywebropol/library.html)
        (function () {
            const MAX_KEYWORDS = 20;
            const MAX_KEYWORD_LENGTH = 50;
            let keywords = [];

            const input = document.querySelector('.keywords-input input[type="text"]');
            const chipsContainer = document.querySelector('.keywords-chips');
            const countEl = document.querySelector('.keywords-count');

            function updateCount() {
                if (countEl) countEl.textContent = String(keywords.length);
            }

            function renderChips() {
                if (!chipsContainer) return;
                chipsContainer.innerHTML = '';
                keywords.forEach(k => {
                    const chip = document.createElement('span');
                    chip.className = 'keyword-chip';
                    chip.setAttribute('role', 'listitem');
                    chip.textContent = k;

                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.setAttribute('aria-label', `Remove keyword ${k}`);
                    removeBtn.style.marginLeft = '0.4rem';
                    removeBtn.style.background = 'transparent';
                    removeBtn.style.border = 'none';
                    removeBtn.style.cursor = 'pointer';
                    removeBtn.innerHTML = '<i class="fal fa-times"></i>';
                    removeBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        removeKeyword(k);
                    });

                    chip.appendChild(removeBtn);
                    chipsContainer.appendChild(chip);
                });
                updateCount();
            }

            function addKeywordFromString(raw) {
                if (!raw) return;
                const candidate = raw.trim();
                if (!candidate) return;
                if (candidate.length > MAX_KEYWORD_LENGTH) {
                    alert('Keyword too long (max ' + MAX_KEYWORD_LENGTH + ' characters)');
                    return;
                }
                if (keywords.includes(candidate)) return;
                if (keywords.length >= MAX_KEYWORDS) {
                    alert('Maximum number of keywords (' + MAX_KEYWORDS + ') reached');
                    return;
                }
                keywords.push(candidate);
                renderChips();
            }

            function addKeywordFromInput() {
                if (!input) return;
                const value = input.value || '';
                // Allow comma-separated values or single
                const parts = value.split(',').map(p => p.trim()).filter(Boolean);
                parts.forEach(p => addKeywordFromString(p));
                input.value = '';
            }

            function removeKeyword(keyword) {
                keywords = keywords.filter(k => k !== keyword);
                renderChips();
            }

            if (input) {
                input.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' || e.key === ',') {
                        e.preventDefault();
                        addKeywordFromInput();
                    }
                });

                // Support pasting comma separated lists
                input.addEventListener('paste', function (e) {
                    const paste = (e.clipboardData || window.clipboardData).getData('text');
                    if (paste && paste.includes(',')) {
                        e.preventDefault();
                        const parts = paste.split(',').map(p => p.trim()).filter(Boolean);
                        parts.forEach(p => addKeywordFromString(p));
                    }
                });
            }

            // Expose small API for potential future use
            window.autoSuggestKeywords = {
                get: () => [...keywords],
                add: (kw) => { addKeywordFromString(kw); },
                remove: (kw) => { removeKeyword(kw); }
            };

            // Initial render
            renderChips();
        })();
        </script>
    </body>
</html>
