<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surveys - Webropol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="../design-system/webropol-standalone.js"></script>
    <script src="../design-system/components/navigation/Sidebar.js" type="module"></script>
    <script src="../design-system/components/navigation/Header.js" type="module"></script>
    <script src="../design-system/components/navigation/Breadcrumbs.js" type="module"></script>
    <script src="../design-system/components/interactive/FloatingButton.js" type="module"></script>
    <script src="../design-system/components/modals/Modal.js" type="module"></script>
    <script src="../design-system/components/modals/SettingsModal.js" type="module"></script>
    <script src="../design-system/utils/theme-manager.js" type="module"></script>
    <script src="../design-system/utils/global-settings-manager.js" type="module"></script>
    <script defer src="../design-system/components/tabs/unified-tabs.js"></script>
    
    <!-- Import Global Design Tokens -->
    <link rel="stylesheet" href="../design-system/styles/tokens.css">
    <link rel="stylesheet" href="../design-system/styles/tabs.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'webropol-primary': { 50: '#f0fdff', 100: '#ccf7fe', 200: '#99effd', 300: '#66e0fa', 400: '#22ccf1', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 800: '#155e75', 900: '#164e63' },
                        'webropol-gray': { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="../design-system/styles/animations.css" rel="stylesheet">
    <style>
        :root {
            --primary-50: #f0fdff;
            --primary-100: #ccf7fe;
            --primary-200: #99effd;
            --primary-300: #66e0fa;
            --primary-400: #22ccf1;
            --primary-500: #06b6d4;
            --primary-600: #0891b2;
            --primary-700: #0e7490;
            --primary-800: #155e75;
            --primary-900: #164e63;
            
            --neutral-0: #ffffff;
            --neutral-50: #f8fafc;
            --neutral-100: #f1f5f9;
            --neutral-200: #e2e8f0;
            --neutral-300: #cbd5e1;
            --neutral-400: #94a3b8;
            --neutral-500: #64748b;
            --neutral-600: #475569;
            --neutral-700: #334155;
            --neutral-800: #1e293b;
            --neutral-900: #0f172a;
            
            --shadow-soft: 0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04);
            --shadow-medium: 0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-lg: 0 10px 40px -10px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 50px -12px rgba(0, 0, 0, 0.25);
            
            --border-radius-full: 9999px;
            --font-weight-medium: 500;
            --font-size-xs: 0.75rem;
        }

        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }

        .hover-lift {
            transition: all 0.2s ease;
        }

        .hover-lift:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.15);
        }

        /* Status badges */
        .status-draft {
            background-color: #fef3c7;
            color: #d97706;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-published {
            background-color: #dcfce7;
            color: #16a34a;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-closed {
            background-color: #f1f5f9;
            color: #64748b;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Unified Rounded Tab System */
        .webropol-tabs-wrapper {
            display: inline-flex;
            background: var(--primary-50, #eefbfd);
            padding: 6px;
            border-radius: 12px;
            box-shadow: 0 2px 15px -3px rgba(0, 0, 0, 0.07);
            border: 1px solid var(--primary-100, #d5f4f8);
            gap: 4px;
        }

        .webropol-tab {
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.875rem;
            text-align: center;
            min-width: 80px;
            cursor: pointer;
            border: none;
            background: transparent;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--neutral-600, #787f81);
        }

        .webropol-tab.active {
            background: var(--primary-600, #1d809d);
            color: white;
            box-shadow: 0 4px 12px rgba(29, 128, 157, 0.3);
            transform: scale(1.02);
        }

        .webropol-tab:not(.active):hover {
            color: var(--primary-700, #1e6880);
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transform: scale(1.01);
        }

        .webropol-tab:focus-visible {
            outline: 2px solid var(--primary-300, #79d6e7);
            outline-offset: 2px;
        }

        /* Table row hover */
        .table-row:hover {
            background-color: #f8fafc;
        }

        /* Checkbox styling */
        .custom-checkbox {
            width: 1rem;
            height: 1rem;
            color: #0891b2;
            background-color: #f1f5f9;
            border-color: #cbd5e1;
            border-radius: 0.25rem;
        }

        .custom-checkbox:focus {
            outline: 2px solid rgba(8, 145, 178, 0.5);
            outline-offset: 2px;
        }

        .modern-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow-soft);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-medium);
        }

        .search-modern {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.2s ease;
        }

        .search-modern:focus {
            background: rgba(255, 255, 255, 0.95);
            border-color: var(--primary-400);
            box-shadow: 0 0 0 3px rgba(var(--primary-400), 0.1);
        }
    </style>
    
    <!-- Global Analytics Tracker -->
    <script src="../scripts/analytics-global-tracker.js"></script>
</head>

<body x-data="surveysListApp()" @click="showContextMenu = null">
    <div class="flex h-screen">
        <webropol-sidebar x-show="interfaceMode === 'classic'" 
                         x-transition:enter="transition ease-out duration-500"
                         x-transition:enter-start="opacity-0 transform -translate-x-full scale-95"
                         x-transition:enter-end="opacity-100 transform translate-x-0 scale-100"
                         x-transition:leave="transition ease-in duration-300"
                         x-transition:leave-start="opacity-100 transform translate-x-0 scale-100"
                         x-transition:leave-end="opacity-0 transform -translate-x-full scale-95"
                         class="sidebar-transition"
                         active="surveys" base="../"></webropol-sidebar>
        <div class="flex-1 flex flex-col overflow-hidden main-content-transition xl:ml-0 ml-0" 
             :class="interfaceMode === 'prompt' ? 'w-full' : ''">
            <webropol-header username="Ali Al-Zuhairi" show-notifications="true" show-help="true" show-user-menu="true" show-theme-selector="true"></webropol-header>
            <div id="breadcrumbs-fix-wrapper" class="bg-white/70 backdrop-blur px-0 sm:px-4"
                 :class="interfaceMode === 'prompt' ? 'px-8 sm:px-8' : ''">
                <webropol-breadcrumbs :trail="interfaceMode === 'prompt' ? 
                    '[{\"label\":\"Home\",\"url\":\"../index.html\"},{\"label\":\"Surveys\",\"url\":\"index.html\"},{\"label\":\"Magic\",\"url\":\"#\"}]' : 
                    '[{\"label\":\"Home\",\"url\":\"../index.html\"},{\"label\":\"Surveys\",\"url\":\"index.html\"}]'"></webropol-breadcrumbs>
            </div>

            <!-- Page Content -->
            <main class="flex-1 overflow-y-auto px-4 py-4 lg:px-8 min-h-screen pb-24"
                  :class="interfaceMode === 'prompt' ? 'px-8 lg:px-16 xl:px-24' : ''"
                  role="main">
                <div class="mx-auto" :class="interfaceMode === 'prompt' ? 'max-w-6xl' : ''">
                    <!-- Page Header -->
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <h1 class="page-title">Surveys</h1>
                        </div>
                        <a href="../create/index.html?type=survey" class="bg-webropol-primary-600 hover:bg-webropol-primary-600 text-white px-4 py-2 rounded-full font-medium transition-all flex items-center space-x-2 hover-lift">
                            <i class="fal fa-plus"></i>
                            <span>Create new</span>
                        </a>
                    </div>

                    <!-- Main Layout with Sidebar and Content -->
                    <div class="flex gap-6">
                        <!-- Folder Sidebar -->
                        <div class="w-80 flex-shrink-0">
                            <!-- Folders Card -->
                            <div class="modern-card rounded-xl">
                                <!-- Folders Header -->
                                <div class="p-6 border-b border-neutral-100">
                                    <div class="flex items-center justify-between mb-4">
                                        <h2 class="text-lg font-semibold text-neutral-900 flex items-center">
                                            <i class="fas fa-folder-open text-primary-500 mr-2"></i>
                                            Folders
                                        </h2>
                                        <button class="w-10 h-10 bg-gradient-to-br brand-gradient-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white rounded-xl flex items-center justify-center transition-all duration-200 hover:scale-105 shadow-md hover:shadow-lg">
                                            <i class="fas fa-plus text-sm"></i>
                                        </button>
                                    </div>

                                    <!-- Search Folders -->
                                    <div class="relative">
                                        <input type="text" x-model="folderSearchTerm" placeholder="Search folders..."
                                            class="search-modern w-full pl-11 pr-4 py-3 rounded-xl focus:outline-none text-sm">
                                        <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-neutral-400 text-sm"></i>
                                    </div>
                                </div>

                                <!-- Folders List -->
                                <div class="flex-1 overflow-y-auto max-h-96">
                                    <div class="p-4">
                                        <!-- Survey Folder Management -->
                                        <div class="space-y-3">
                                            <!-- Root Level Items -->
                                            <div class="space-y-2">
                                                <template x-for="folder in getFilteredFolders()" :key="folder.id">
                                                    <div class="group">
                                                        <!-- Main Folder Header -->
                                                        <div @click="toggleFolder(folder.id)"
                                                            class="flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all duration-200"
                                                            :class="selectedFolderId === folder.id ? 'bg-gradient-to-r from-primary-100 to-primary-100 text-primary-800 ring-2 ring-primary-300' :
                                                                    expandedFolders.includes(folder.id) ? 'bg-gradient-to-r from-primary-50 to-primary-50 text-primary-700' : 'hover:bg-neutral-50'">
                                                            <div class="flex items-center">
                                                                <div class="w-8 h-8 flex items-center justify-center rounded-lg mr-3"
                                                                    :class="selectedFolderId === folder.id ? 'bg-primary-200' :
                                                                            expandedFolders.includes(folder.id) ? 'bg-primary-100' : 'bg-neutral-100 group-hover:bg-primary-50'">
                                                                    <i :class="folder.name === 'Organizational' ? 'fas fa-building text-primary-600' :
                                                                          folder.name === 'My Surveys' ? 'fas fa-user text-primary-600' :
                                                                          'fas fa-folder text-primary-600'"></i>
                                                                </div>
                                                                <span class="font-medium" x-text="folder.name"></span>
                                                            </div>
                                                            <div class="flex items-center space-x-2">
                                                                <span
                                                                    class="text-xs bg-neutral-200 text-neutral-700 rounded-full px-2 py-1 font-medium"
                                                                    x-text="getTotalFolderItemCount(folder)"></span>
                                                                <div class="relative">
                                                                    <button @click.stop="toggleContextMenu('folder-' + folder.id, 'folder')"
                                                                        class="opacity-0 group-hover:opacity-100 w-6 h-6 flex items-center justify-center text-neutral-400 hover:text-neutral-600 rounded transition-all">
                                                                        <i class="fas fa-ellipsis-v text-xs"></i>
                                                                    </button>
                                                                    <!-- Context Menu for Main Folder -->
                                                                    <div x-show="showContextMenu === 'folder-' + folder.id"
                                                                        @click.stop
                                                                        x-transition:enter="transition ease-out duration-100"
                                                                        x-transition:enter-start="transform opacity-0 scale-95"
                                                                        x-transition:enter-end="transform opacity-100 scale-100"
                                                                        x-transition:leave="transition ease-in duration-75"
                                                                        x-transition:leave-start="transform opacity-100 scale-100"
                                                                        x-transition:leave-end="transform opacity-0 scale-95"
                                                                        class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-neutral-200 z-30">
                                                                        <div class="py-1">
                                                                            <button @click="openAddSubfolderModal(folder.id)"
                                                                                class="flex items-center w-full px-4 py-2 text-sm text-black hover:bg-neutral-50 transition-colors">
                                                                                <i class="fas fa-folder-plus mr-3 text-black"></i>
                                                                                Add Sub Folder
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <i class="fas fa-chevron-right text-xs transition-transform"
                                                                    :class="expandedFolders.includes(folder.id) ? 'rotate-90' : ''"></i>
                                                            </div>
                                                        </div>

                                                        <!-- Nested Subfolders -->
                                                        <div x-show="expandedFolders.includes(folder.id)" x-collapse class="ml-4">
                                                            <template x-for="subfolder in folder.children" :key="subfolder.id">
                                                                <div class="mt-2">
                                                                    <!-- Level 1 Subfolder -->
                                                                    <div @click="toggleFolder(subfolder.id)"
                                                                        class="flex items-center justify-between p-2 pl-6 rounded-lg cursor-pointer transition-all duration-200 group"
                                                                        :class="selectedFolderId === subfolder.id ? 'bg-gradient-to-r from-primary-100/70 to-primary-100/70 text-primary-800 ring-2 ring-primary-300' :
                                                                                expandedFolders.includes(subfolder.id) ? 'bg-gradient-to-r from-primary-50/70 to-primary-50/70 text-primary-700' : 'hover:bg-neutral-50'">
                                                                        <div class="flex items-center">
                                                                            <div class="w-6 h-6 flex items-center justify-center rounded-md mr-3"
                                                                                :class="selectedFolderId === subfolder.id ? 'bg-primary-200' :
                                                                                        expandedFolders.includes(subfolder.id) ? 'bg-primary-100' : 'bg-neutral-100 group-hover:bg-primary-50'">
                                                                                <i class="fas fa-folder text-primary-600"></i>
                                                                            </div>
                                                                            <span class="text-sm font-medium" x-text="subfolder.name"></span>
                                                                        </div>
                                                                        <div class="flex items-center space-x-2">
                                                                            <span
                                                                                class="text-xs bg-neutral-200 text-neutral-700 rounded-full px-2 py-0.5 font-medium"
                                                                                x-text="getTotalFolderItemCount(subfolder)"></span>
                                                                            <i class="fas fa-chevron-right text-xs transition-transform"
                                                                                :class="expandedFolders.includes(subfolder.id) ? 'rotate-90' : ''"></i>
                                                                        </div>
                                                                    </div>

                                                                    <!-- Level 2 Subfolders -->
                                                                    <div x-show="expandedFolders.includes(subfolder.id)" x-collapse class="ml-6">
                                                                        <template x-for="subsubfolder in subfolder.children" :key="subsubfolder.id">
                                                                            <div class="mt-2">
                                                                                <!-- Level 2 Subfolder -->
                                                                                <div @click="toggleFolder(subsubfolder.id)"
                                                                                    class="flex items-center justify-between p-2 pl-6 rounded-lg cursor-pointer transition-all duration-200 group"
                                                                                    :class="selectedFolderId === subsubfolder.id ? 'bg-gradient-to-r from-primary-100/50 to-primary-100/50 text-primary-800 ring-2 ring-primary-300' : 'hover:bg-neutral-50'">
                                                                                    <div class="flex items-center">
                                                                                        <div class="w-6 h-6 flex items-center justify-center rounded-md mr-3"
                                                                                            :class="selectedFolderId === subsubfolder.id ? 'bg-primary-200' : 'bg-neutral-100 group-hover:bg-primary-50'">
                                                                                            <i class="fas fa-folder text-primary-600"></i>
                                                                                        </div>
                                                                                        <span class="text-sm font-medium" x-text="subsubfolder.name"></span>
                                                                                    </div>
                                                                                    <div class="flex items-center space-x-2">
                                                                                        <span
                                                                                            class="text-xs bg-neutral-200 text-neutral-700 rounded-full px-1.5 py-0.5 font-medium"
                                                                                            x-text="getTotalFolderItemCount(subsubfolder)"></span>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </template>
                                                                    </div>
                                                                </div>
                                                            </template>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Survey List Container -->
                        <div class="flex-1">
                            <!-- Content Container -->
                            <div class="bg-white rounded-2xl shadow-soft border border-webropol-gray-100/80 overflow-hidden">
                                <!-- Filter Tabs -->
                                <div class="border-b border-gray-200 px-6 py-4">
                                    <div class="flex items-center justify-between">
                                        <div class="webropol-tabs-unified webropol-tabs-rounded-container" role="tablist" aria-label="Survey filter">
                                            <button class="webropol-unified-tab webropol-tab-rounded size-sm active" role="tab" aria-selected="true">
                                                <i class="fas fa-list mr-2"></i>
                                                All
                                            </button>
                                            <button class="webropol-unified-tab webropol-tab-rounded size-sm" role="tab" aria-selected="false">
                                                <i class="fas fa-edit mr-2"></i>
                                                Drafts
                                            </button>
                                            <button class="webropol-unified-tab webropol-tab-rounded size-sm" role="tab" aria-selected="false">
                                                <i class="fas fa-globe mr-2"></i>
                                                Published
                                            </button>
                                            <button class="webropol-unified-tab webropol-tab-rounded size-sm" role="tab" aria-selected="false">
                                                <i class="fas fa-lock mr-2"></i>
                                                Closed
                                            </button>
                                        </div>
                                        <div class="flex items-center space-x-4">
                                            <!-- Search -->
                                            <div class="relative">
                                                <input type="text" placeholder="Search surveys"
                                                       class="w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-webropol-primary-500/20 focus:border-webropol-primary-500 text-sm">
                                                <i class="fal fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            </div>
                                            <!-- Show only mine toggle -->
                                            <div class="flex items-center space-x-2">
                                                <label class="relative inline-flex items-center cursor-pointer">
                                                    <input type="checkbox" class="sr-only peer">
                                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-webropol-primary-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-webropol-primary-600"></div>
                                                </label>
                                                <span class="text-sm text-gray-600">Show only mine</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Table -->
                                <div class="px-6 py-4">
                                    <div class="overflow-x-auto mobile-hide-table">
                                    <table class="w-full min-w-[720px]">
                                        <thead>
                                            <tr class="border-b border-gray-200">
                                                <th class="text-left py-3 text-sm font-medium text-gray-700 w-8">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </th>
                                                <th class="text-left py-3 text-sm font-medium text-gray-700">Name</th>
                                                <th class="text-left py-3 text-sm font-medium text-gray-700">Answers</th>
                                                <th class="text-left py-3 text-sm font-medium text-gray-700">
                                                    <div class="flex items-center space-x-1">
                                                        <span>Last edited</span>
                                                        <i class="fal fa-chevron-down text-xs"></i>
                                                    </div>
                                                </th>
                                                <th class="text-left py-3 text-sm font-medium text-gray-700">Created by</th>
                                                <th class="text-left py-3 text-sm font-medium text-gray-700">Status</th>
                                                <th class="text-left py-3 text-sm font-medium text-gray-700 w-8"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="table-row border-b border-gray-100 cursor-pointer">
                                                <td class="py-3">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </td>
                                                <td class="py-3">
                                                    <a href="edit.html?id=1" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">
                                                        Customer Satisfaction Survey
                                                    </a>
                                                </td>
                                                <td class="py-3 text-gray-700">156</td>
                                                <td class="py-3 text-gray-600 text-sm">20.01.2024 14:22</td>
                                                <td class="py-3 text-gray-700">Ali Al-Zuhairi</td>
                                                <td class="py-3">
                                                    <span class="status-published">Published</span>
                                                </td>
                                                <td class="py-3">
                                                    <button class="text-gray-400 hover:text-gray-600">
                                                        <i class="fal fa-ellipsis-v"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr class="table-row border-b border-gray-100 cursor-pointer">
                                                <td class="py-3">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </td>
                                                <td class="py-3">
                                                    <a href="edit.html?id=2" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">
                                                        Employee Engagement Survey 2024
                                                    </a>
                                                </td>
                                                <td class="py-3 text-gray-700">89</td>
                                                <td class="py-3 text-gray-600 text-sm">18.01.2024 09:15</td>
                                                <td class="py-3 text-gray-700">Jane Smith</td>
                                                <td class="py-3">
                                                    <span class="status-published">Published</span>
                                                </td>
                                                <td class="py-3">
                                                    <button class="text-gray-400 hover:text-gray-600">
                                                        <i class="fal fa-ellipsis-v"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr class="table-row border-b border-gray-100 cursor-pointer">
                                                <td class="py-3">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </td>
                                                <td class="py-3">
                                                    <a href="edit.html?id=3" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">
                                                        Product Feedback - Mobile App
                                                    </a>
                                                </td>
                                                <td class="py-3 text-gray-700">0</td>
                                                <td class="py-3 text-gray-600 text-sm">22.01.2024 16:45</td>
                                                <td class="py-3 text-gray-700">Mike Johnson</td>
                                                <td class="py-3">
                                                    <span class="status-draft">Draft</span>
                                                </td>
                                                <td class="py-3">
                                                    <button class="text-gray-400 hover:text-gray-600">
                                                        <i class="fal fa-ellipsis-v"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr class="table-row border-b border-gray-100 cursor-pointer">
                                                <td class="py-3">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </td>
                                                <td class="py-3">
                                                    <a href="edit.html?id=4" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">
                                                        Market Research - Q1 2024
                                                    </a>
                                                </td>
                                                <td class="py-3 text-gray-700">234</td>
                                                <td class="py-3 text-gray-600 text-sm">08.01.2024 11:30</td>
                                                <td class="py-3 text-gray-700">Sarah Wilson</td>
                                                <td class="py-3">
                                                    <span class="status-published">Published</span>
                                                </td>
                                                <td class="py-3">
                                                    <button class="text-gray-400 hover:text-gray-600">
                                                        <i class="fal fa-ellipsis-v"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr class="table-row border-b border-gray-100 cursor-pointer">
                                                <td class="py-3">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </td>
                                                <td class="py-3">
                                                    <a href="edit.html?id=5" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">
                                                        Event Feedback - Annual Conference
                                                    </a>
                                                </td>
                                                <td class="py-3 text-gray-700">67</td>
                                                <td class="py-3 text-gray-600 text-sm">30.11.2023 13:20</td>
                                                <td class="py-3 text-gray-700">David Brown</td>
                                                <td class="py-3">
                                                    <span class="status-closed">Closed</span>
                                                </td>
                                                <td class="py-3">
                                                    <button class="text-gray-400 hover:text-gray-600">
                                                        <i class="fal fa-ellipsis-v"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr class="table-row cursor-pointer">
                                                <td class="py-3">
                                                    <input type="checkbox" class="custom-checkbox">
                                                </td>
                                                <td class="py-3">
                                                    <a href="#/surveys/aita" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">
                                                        AI Text Analysis Survey
                                                    </a>
                                                </td>
                                                <td class="py-3 text-gray-700">12</td>
                                                <td class="py-3 text-gray-600 text-sm">25.01.2024 10:05</td>
                                                <td class="py-3 text-gray-700">Ali Al-Zuhairi</td>
                                                <td class="py-3">
                                                    <span class="status-published">Published</span>
                                                </td>
                                                <td class="py-3">
                                                    <button class="text-gray-400 hover:text-gray-600">
                                                        <i class="fal fa-ellipsis-v"></i>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    </div>

                                    <!-- Mobile card list (shown only on small screens) -->
                                    <div class="mobile-show-cards" style="display:none">
                                        <!-- Card 1 -->
                                        <div class="mobile-card">
                                            <div class="mobile-card-header">
                                                <a href="edit.html?id=1" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">Customer Satisfaction Survey</a>
                                            </div>
                                            <div class="mobile-card-content">
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Answers</span>
                                                    <span class="mobile-card-value">156</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Last edited</span>
                                                    <span class="mobile-card-value">20.01.2024 14:22</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Created by</span>
                                                    <span class="mobile-card-value">Ali Al-Zuhairi</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Status</span>
                                                    <span class="mobile-card-value"><span class="status-published">Published</span></span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Card 2 -->
                                        <div class="mobile-card">
                                            <div class="mobile-card-header">
                                                <a href="edit.html?id=2" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">Employee Engagement Survey 2024</a>
                                            </div>
                                            <div class="mobile-card-content">
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Answers</span>
                                                    <span class="mobile-card-value">89</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Last edited</span>
                                                    <span class="mobile-card-value">18.01.2024 09:15</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Created by</span>
                                                    <span class="mobile-card-value">Jane Smith</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Status</span>
                                                    <span class="mobile-card-value"><span class="status-published">Published</span></span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Card 3 -->
                                        <div class="mobile-card">
                                            <div class="mobile-card-header">
                                                <a href="edit.html?id=3" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">Product Feedback - Mobile App</a>
                                            </div>
                                            <div class="mobile-card-content">
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Answers</span>
                                                    <span class="mobile-card-value">0</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Last edited</span>
                                                    <span class="mobile-card-value">22.01.2024 16:45</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Created by</span>
                                                    <span class="mobile-card-value">Mike Johnson</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Status</span>
                                                    <span class="mobile-card-value"><span class="status-draft">Draft</span></span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Card 4 -->
                                        <div class="mobile-card">
                                            <div class="mobile-card-header">
                                                <a href="#/surveys/aita" class="text-webropol-primary-600 hover:text-webropol-primary-700 font-medium">AI Text Analysis Survey</a>
                                            </div>
                                            <div class="mobile-card-content">
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Answers</span>
                                                    <span class="mobile-card-value">12</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Last edited</span>
                                                    <span class="mobile-card-value">25.01.2024 10:05</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Created by</span>
                                                    <span class="mobile-card-value">Ali Al-Zuhairi</span>
                                                </div>
                                                <div class="mobile-card-row">
                                                    <span class="mobile-card-label">Status</span>
                                                    <span class="mobile-card-value"><span class="status-published">Published</span></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Pagination -->
                                    <div class="flex items-center justify-between mt-6">
                                        <div class="flex items-center space-x-2">
                                            <select class="border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-webropol-primary-500/20 focus:border-webropol-primary-500">
                                                <option>20 rows</option>
                                                <option>50 rows</option>
                                                <option>100 rows</option>
                                            </select>
                                        </div>
                                        <div class="flex items-center space-x-1">
                                            <button class="w-8 h-8 bg-webropol-primary-500 text-white rounded-lg flex items-center justify-center text-sm font-medium">
                                                1
                                            </button>
                                            <button class="w-8 h-8 hover:bg-gray-100 rounded-lg flex items-center justify-center text-sm font-medium text-gray-700">
                                                2
                                            </button>
                                            <button class="w-8 h-8 hover:bg-gray-100 rounded-lg flex items-center justify-center text-sm font-medium text-gray-700">
                                                3
                                            </button>
                                            <button class="w-8 h-8 hover:bg-gray-100 rounded-lg flex items-center justify-center text-sm font-medium text-gray-700">
                                                4
                                            </button>
                                            <span class="text-gray-500 text-sm px-2">...</span>
                                            <button class="w-8 h-8 hover:bg-gray-100 rounded-lg flex items-center justify-center text-sm font-medium text-gray-700">
                                                12
                                            </button>
                                            <button class="w-8 h-8 hover:bg-gray-100 rounded-lg flex items-center justify-center text-sm font-medium text-gray-700">
                                                <i class="fal fa-chevron-right"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Floating Create Button Component -->
    <webropol-floating-button></webropol-floating-button>

    <script>
        function surveysListApp() {
            return {
                // Interface modes
                interfaceMode: 'classic', // 'classic' or 'prompt'
                showContextMenu: null,
                
                // Survey list specific
                selectedSurveys: [],
                showOnlyMine: false,
                currentTab: 'all',
                searchQuery: '',
                folderSearchTerm: '',
                selectedFolderId: null,
                expandedFolders: [],
                
                // Sample survey folders data structure
                folders: [
                    { 
                        id: 1, 
                        name: 'Organizational', 
                        description: 'Company-wide surveys and organizational activities',
                        level: 0,
                        parentId: null,
                        children: [
                            {
                                id: 11,
                                name: 'Employee Surveys',
                                description: 'HR and employee feedback surveys',
                                level: 1,
                                parentId: 1,
                                children: [
                                    {
                                        id: 111,
                                        name: 'Performance Reviews',
                                        description: 'Employee performance evaluation surveys',
                                        level: 2,
                                        parentId: 11,
                                        children: []
                                    },
                                    {
                                        id: 112,
                                        name: 'Satisfaction Surveys',
                                        description: 'Employee satisfaction and engagement surveys',
                                        level: 2,
                                        parentId: 11,
                                        children: []
                                    }
                                ]
                            },
                            {
                                id: 12,
                                name: 'Customer Surveys',
                                description: 'Customer feedback and satisfaction surveys',
                                level: 1,
                                parentId: 1,
                                children: [
                                    {
                                        id: 121,
                                        name: 'Product Feedback',
                                        description: 'Product-specific feedback surveys',
                                        level: 2,
                                        parentId: 12,
                                        children: []
                                    }
                                ]
                            },
                            {
                                id: 13,
                                name: 'Training Surveys',
                                description: 'Training and development surveys',
                                level: 1,
                                parentId: 1,
                                children: []
                            }
                        ]
                    },
                    { 
                        id: 2, 
                        name: 'My Surveys', 
                        description: 'Personal surveys and private activities',
                        level: 0,
                        parentId: null,
                        children: [
                            {
                                id: 21,
                                name: 'Research Projects',
                                description: 'Academic and research survey projects',
                                level: 1,
                                parentId: 2,
                                children: []
                            },
                            {
                                id: 22,
                                name: 'Personal Projects',
                                description: 'Personal survey projects and experiments',
                                level: 1,
                                parentId: 2,
                                children: []
                            }
                        ]
                    }
                ],
                
                init() {
                    console.log('Surveys List initialized');
                    
                    // Initialize interface mode from localStorage or default to classic
                    this.interfaceMode = localStorage.getItem('interfaceMode') || 'classic';
                },
                
                // Interface mode management
                toggleInterfaceMode() {
                    this.interfaceMode = this.interfaceMode === 'classic' ? 'prompt' : 'classic';
                    localStorage.setItem('interfaceMode', this.interfaceMode);
                },
                
                setInterfaceMode(mode) {
                    this.interfaceMode = mode;
                    localStorage.setItem('interfaceMode', mode);
                },
                
                // Folder management functions
                toggleFolder(folderId) {
                    // Handle folder expansion/collapse
                    if (this.expandedFolders.includes(folderId)) {
                        this.expandedFolders = this.expandedFolders.filter(id => id !== folderId);
                    } else {
                        this.expandedFolders.push(folderId);
                    }
                    
                    // Handle folder selection for content filtering
                    if (this.selectedFolderId === folderId) {
                        // If clicking the same folder, deselect it to show all content
                        this.selectedFolderId = null;
                    } else {
                        // Select the folder to filter content
                        this.selectedFolderId = folderId;
                    }
                },

                getFilteredFolders() {
                    return this.folders.filter(folder => {
                        return folder.level === 0;
                    });
                },

                // Helper function to recursively count items in folder and subfolders
                getTotalFolderItemCount(folder) {
                    let count = 0;
                    
                    // Count direct items in this folder (simulated survey count)
                    // In a real app, this would count actual surveys in the folder
                    count = Math.floor(Math.random() * 15) + 1; // Random count for demo
                    
                    // Recursively count items in children
                    if (folder.children && folder.children.length > 0) {
                        folder.children.forEach(child => {
                            count += this.getTotalFolderItemCount(child);
                        });
                    }
                    
                    return count;
                },

                // Helper function to find folder by ID (searches recursively)
                findFolderById(folderId, folders = this.folders) {
                    for (let folder of folders) {
                        if (folder.id === folderId) {
                            return folder;
                        }
                        if (folder.children && folder.children.length > 0) {
                            const found = this.findFolderById(folderId, folder.children);
                            if (found) return found;
                        }
                    }
                    return null;
                },

                // Context menu methods
                toggleContextMenu(itemId, itemType) {
                    if (this.showContextMenu === itemId) {
                        this.showContextMenu = null;
                    } else {
                        this.showContextMenu = itemId;
                    }
                },

                // Modal and action stubs
                openAddSubfolderModal(folderId) {
                    console.log('Open add subfolder modal for folder:', folderId);
                },
                
                // Survey list functionality
                selectAllSurveys() {
                    // Toggle select all functionality
                },
                
                switchTab(tab) {
                    this.currentTab = tab;
                    // Filter surveys based on tab
                },
                
                searchSurveys() {
                    // Search functionality
                },
                
                toggleShowOnlyMine() {
                    this.showOnlyMine = !this.showOnlyMine;
                    // Filter surveys by current user
                }
            }
        }

        // Handle floating button navigation
        document.addEventListener('DOMContentLoaded', function() {
            const floatingButton = document.querySelector('webropol-floating-button');
            if (floatingButton) {
                    floatingButton.addEventListener('create-item', function(e) {
                        if (e.detail.type === 'surveys') {
                            // Navigate via SPA to Create (survey)
                            if (window.WebropolSPA && typeof window.WebropolSPA.navigate === 'function') {
                                window.WebropolSPA.navigate('/create?type=survey');
                            } else {
                                // Fallback if opened directly
                                window.location.href = '../index.html#/create?type=survey';
                            }
                        }
                    });
            }

            // Listen for theme changes
            document.addEventListener('theme-changed', function(e) {
                console.log('Theme changed to:', e.detail.theme);
                // You can add any additional theme change handling here
            });
        });
    </script>
</body>
</html>
