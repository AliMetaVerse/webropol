<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create New Survey - Webropol</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'webropol-primary': { 50: '#f0fdff', 100: '#ccf7fe', 200: '#99effd', 300: '#66e0fa', 400: '#22ccf1', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 800: '#155e75', 900: '#164e63' },
            'webropol-gray': { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' },
            'webropol-green': { 50: '#f0fdf4', 500: '#22c55e', 700: '#15803d' },
            'webropol-red': { 50: '#fef2f2', 500: '#ef4444', 700: '#dc2626' }
          },
          fontFamily: {
            'sans': ['Inter', 'system-ui', 'sans-serif'],
          },
          boxShadow: {
            'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
            'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
            'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
          }
        }
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../design-system/styles/tokens.css">
  <link href="../../design-system/styles/animations.css" rel="stylesheet">
  <style>
    [x-cloak] {
      display: none !important;
    }

    body {
      font-family: 'Inter', sans-serif;
    }

    .glass-effect {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.9);
    }

    .hover-lift {
      transition: all 0.2s ease;
    }

    .hover-lift:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.15);
    }

    .template-card {
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      border: 2px solid #e2e8f0;
      background: #ffffff;
    }

    /* Default state - clean, subtle appearance */
    .template-card:not(.selected):not(:hover):not(:focus-within) {
      transform: translateY(0);
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      border-color: #e2e8f0;
      background: #ffffff;
    }

    /* Hover state - subtle lift and shadow enhancement */
    .template-card:hover:not(.selected) {
      transform: translateY(-2px);
      box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      border-color: #cbd5e1;
      background: #fefefe;
    }

    /* Focus state - clear focus ring like the image */
    .template-card:focus-within:not(.selected) {
      transform: translateY(-1px);
      box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.04), 0 0 0 3px rgba(6, 182, 212, 0.3);
      border-color: #06b6d4;
      outline: none;
      background: #ffffff;
    }

    /* Active/pressed state */
    .template-card:active:not(.selected) {
      transform: translateY(0);
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      border-color: #06b6d4;
      transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Selected state - matches the image with checkmark */
    .template-card.selected {
      border-color: #06b6d4;
      box-shadow: 0 4px 25px -5px rgba(6, 182, 212, 0.25), 0 10px 10px -5px rgba(6, 182, 212, 0.08);
      transform: translateY(-1px);
      background: #ffffff;
    }

    /* Selected hover state */
    .template-card.selected:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px -5px rgba(6, 182, 212, 0.3), 0 15px 15px -5px rgba(6, 182, 212, 0.1);
      border-color: #0891b2;
    }

    /* Selected focus state */
    .template-card.selected:focus-within {
      box-shadow: 0 8px 30px -5px rgba(6, 182, 212, 0.3), 0 15px 15px -5px rgba(6, 182, 212, 0.1), 0 0 0 3px rgba(6, 182, 212, 0.3);
      outline: none;
    }

    /* Disabled state (if needed) */
    .template-card.disabled {
      cursor: not-allowed;
      opacity: 0.5;
      filter: grayscale(0.3);
      pointer-events: none;
      transform: none !important;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06) !important;
    }

    /* Loading state overlay */
    .template-card.loading::after {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(2px);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      z-index: 10;
    }

    /* Selection indicator - blue circle background */
    .template-card.selected::before {
      content: '';
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      background: #06b6d4;
      border-radius: 50%;
      z-index: 5;
      opacity: 1;
      transform: scale(1);
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* Checkmark icon */
    .template-card.selected::after {
      content: 'âœ“';
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      font-size: 11px;
      font-weight: 700;
      z-index: 6;
      opacity: 1;
      transform: scale(1);
      transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      line-height: 1;
    }

    /* Dark mode states */
    .dark .template-card {
      background: #1e293b;
      border-color: #334155;
      box-shadow: 0 1px 3px 0 rgba(0,0,0,0.3), 0 1px 2px 0 rgba(0,0,0,0.2);
    }

    .dark .template-card:hover:not(.selected) {
      border-color: #475569;
      box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.25), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
      background: #334155;
    }

    .dark .template-card:focus-within:not(.selected) {
      box-shadow: 0 4px 25px -5px rgba(0, 0, 0, 0.25), 0 10px 10px -5px rgba(0, 0, 0, 0.1), 0 0 0 3px rgba(6, 182, 212, 0.4);
      border-color: #06b6d4;
    }

    .dark .template-card.selected {
      border-color: #06b6d4;
      background: #1e293b;
      box-shadow: 0 4px 25px -5px rgba(6, 182, 212, 0.3), 0 10px 10px -5px rgba(6, 182, 212, 0.1);
    }

    .dark .template-card.selected:hover {
      box-shadow: 0 8px 30px -5px rgba(6, 182, 212, 0.4), 0 15px 15px -5px rgba(6, 182, 212, 0.15);
      border-color: #22d3ee;
    }







    .carousel-container {
      scroll-behavior: smooth;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .carousel-container::-webkit-scrollbar {
      display: none;
    }

    .date-picker-input {
      position: relative;
    }

    .calendar-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      z-index: 50;
    }
  </style>
  <script src="../../design-system/components/navigation/Sidebar.js" type="module"></script>
  <script src="../../design-system/components/navigation/Header.js" type="module"></script>
  <script src="../../design-system/components/navigation/Breadcrumbs.js" type="module"></script>
  <script src="../../design-system/utils/theme-manager.js" type="module"></script>
  <script src="../../design-system/utils/global-settings-manager.js" type="module"></script>
</head>
<body x-data="createSurveyApp()" x-cloak>
  <div class="flex h-screen">
    <webropol-sidebar active="surveys" base="../../"></webropol-sidebar>
    <div class="flex-1 flex flex-col overflow-hidden">
      <webropol-header username="Ali Al-Zuhairi" show-notifications="true" show-help="true" show-user-menu="true" show-theme-selector="true"></webropol-header>
      <div class="bg-white/70 backdrop-blur px-0 sm:px-4">
        <webropol-breadcrumbs trail='[{"label":"Home","url":"../../index.html"},{"label":"Surveys","url":"../index.html"},{"label":"Create New Survey","url":"create-legacy.html"}]'></webropol-breadcrumbs>
      </div>
      <main class="flex-1 overflow-y-auto px-6 py-8 pb-24" role="main">
        <div class="max-w-5xl mx-auto">
          <div class="mb-8">
            <h1 class="text-3xl font-bold text-webropol-gray-900 mb-2">Create new survey</h1>
          </div>

          <!-- Survey Details Form -->
          <div class="bg-white/90 backdrop-blur-lg rounded-2xl p-8 shadow-xl border border-webropol-gray-100/80 mb-8">
            <form @submit.prevent="createSurvey">
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Survey Title -->
                <div class="lg:col-span-1">
                  <label for="surveyTitle" class="block text-sm font-semibold text-webropol-gray-900 mb-3">
                    Survey title<span class="text-webropol-red-500 ml-1">*</span>
                  </label>
                  <input 
                    type="text" 
                    id="surveyTitle" 
                    x-model="form.title"
                    class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-primary-500 focus:border-transparent transition-all"
                    placeholder="Enter survey title"
                    required
                  >
                </div>

                <!-- Survey Folder -->
                <div class="lg:col-span-1">
                  <label for="surveyFolder" class="block text-sm font-semibold text-webropol-gray-900 mb-3">
                    Survey folder
                  </label>
                  <div class="relative">
                    <input 
                      type="text" 
                      id="surveyFolder" 
                      x-model="form.folder"
                      class="w-full px-4 py-3 pr-20 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-primary-500 focus:border-transparent transition-all bg-webropol-gray-50"
                      placeholder="Root folder"
                      readonly
                    >
                    <button 
                      type="button" 
                      class="absolute right-3 top-1/2 transform -translate-y-1/2 text-webropol-primary-600 hover:text-webropol-primary-700 font-medium text-sm"
                      @click="openFolderPicker"
                    >
                      Change
                    </button>
                  </div>
                </div>

                <!-- Automatic Deletion Date -->
                <div class="lg:col-span-2">
                  <div class="flex items-center space-x-3 mb-4">
                    <input 
                      type="checkbox" 
                      id="automaticDeletion" 
                      x-model="form.automaticDeletion"
                      class="w-5 h-5 text-webropol-primary-600 bg-white border-2 border-webropol-gray-300 rounded focus:ring-webropol-primary-500 focus:ring-2"
                    >
                    <label for="automaticDeletion" class="text-sm font-semibold text-webropol-gray-900">
                      Automatic Deletion Date
                      <i class="fal fa-info-circle text-webropol-gray-400 ml-1"></i>
                    </label>
                  </div>
                  
                  <div x-show="form.automaticDeletion" class="relative">
                    <div class="date-picker-input max-w-xs">
                      <input 
                        type="text" 
                        x-model="form.deletionDate"
                        @click="showCalendar = !showCalendar"
                        class="w-full px-4 py-3 pr-12 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-primary-500 focus:border-transparent transition-all cursor-pointer"
                        placeholder="Select date"
                        readonly
                      >
                      <button 
                        type="button" 
                        @click="showCalendar = !showCalendar"
                        class="absolute right-3 top-1/2 transform -translate-y-1/2 text-webropol-gray-400 hover:text-webropol-gray-600"
                      >
                        <i class="fal fa-calendar"></i>
                      </button>
                      
                      <!-- Calendar Dropdown -->
                      <div x-show="showCalendar" x-transition class="calendar-dropdown mt-2" @click.away="showCalendar = false">
                        <div class="p-4">
                          <div class="flex items-center justify-between mb-4">
                            <button type="button" @click="previousMonth" class="p-2 hover:bg-webropol-gray-100 rounded-lg">
                              <i class="fal fa-chevron-left text-webropol-gray-600"></i>
                            </button>
                            <h3 class="font-semibold text-webropol-gray-900" x-text="currentMonthYear"></h3>
                            <button type="button" @click="nextMonth" class="p-2 hover:bg-webropol-gray-100 rounded-lg">
                              <i class="fal fa-chevron-right text-webropol-gray-600"></i>
                            </button>
                          </div>
                          <div class="grid grid-cols-7 gap-1 mb-2">
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">Mo</div>
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">Tu</div>
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">We</div>
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">Th</div>
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">Fr</div>
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">Sa</div>
                            <div class="text-center text-xs font-medium text-webropol-gray-500 py-2">Su</div>
                          </div>
                          <div class="grid grid-cols-7 gap-1">
                            <template x-for="day in calendarDays" :key="day.date">
                              <button 
                                type="button"
                                @click="selectDate(day)"
                                :class="day.isCurrentMonth ? 'text-webropol-gray-900 hover:bg-webropol-primary-50' : 'text-webropol-gray-300'"
                                :class="day.isToday ? 'bg-webropol-primary-600 text-white hover:bg-webropol-primary-700' : ''"
                                :class="day.isSelected ? 'bg-webropol-primary-600 text-white' : ''"
                                class="w-8 h-8 text-sm rounded-lg transition-colors flex items-center justify-center"
                                :disabled="!day.isCurrentMonth"
                                x-text="day.day"
                              ></button>
                            </template>
                          </div>
                        </div>
                      </div>
                    </div>
                    <p class="text-sm text-webropol-gray-500 mt-2">
                      Survey will be automatically deleted after this date.
                    </p>
                  </div>
                </div>
              </div>
            </form>
          </div>

          <!-- Layout Template Section -->
          <div class="bg-white/90 backdrop-blur-lg rounded-2xl p-8 shadow-xl border border-webropol-gray-100/80 mb-8">
            <div class="flex items-center space-x-2 mb-6">
              <h2 class="text-xl font-bold text-webropol-gray-900">Layout template</h2>
              <i class="fal fa-info-circle text-webropol-gray-400"></i>
            </div>

            <!-- Template Tabs -->
            <div class="flex border-b border-webropol-gray-200 mb-6">
              <button 
                @click="activeTab = 'webropol'"
                :class="activeTab === 'webropol' ? 'border-webropol-primary-500 text-webropol-primary-600' : 'border-transparent text-webropol-gray-500 hover:text-webropol-gray-700'"
                class="py-3 px-4 border-b-2 font-medium text-sm transition-colors"
              >
                Webropol templates (43)
              </button>
              <button 
                @click="activeTab = 'my'"
                :class="activeTab === 'my' ? 'border-webropol-primary-500 text-webropol-primary-600' : 'border-transparent text-webropol-gray-500 hover:text-webropol-gray-700'"
                class="py-3 px-4 border-b-2 font-medium text-sm transition-colors"
              >
                My templates (4)
              </button>
              <button 
                @click="activeTab = 'shared'"
                :class="activeTab === 'shared' ? 'border-webropol-primary-500 text-webropol-primary-600' : 'border-transparent text-webropol-gray-500 hover:text-webropol-gray-700'"
                class="py-3 px-4 border-b-2 font-medium text-sm transition-colors"
              >
                Shared templates (2)
              </button>
            </div>

            <!-- Templates Grid with Carousel -->
            <div class="relative" role="group" aria-label="Template selection gallery">
              <div 
                class="carousel-container flex space-x-6 overflow-x-auto p-2" 
                x-ref="carousel"
                role="listbox"
                :aria-label="'Available ' + activeTab + ' templates'"
                aria-orientation="horizontal"
              >
                <template x-for="template in currentTemplates" :key="template.id">
                  <div 
                    class="template-card flex-shrink-0 w-48 h-40 rounded-xl overflow-hidden flex flex-col"
                    :class="selectedTemplate === template.id ? 'selected' : ''"
                    :style="'background-image: url(' + template.image + ')'"
                    @click="selectTemplate(template)"
                    @keydown="(e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); selectTemplate(template); } }"
                    tabindex="0"
                    :aria-label="'Select template: ' + template.name"
                    :aria-selected="selectedTemplate === template.id"
                    role="option"
                  >
                    <!-- White semi-transparent content area -->
                    <div class="flex-1 bg-white/80 rounded-lg flex items-center justify-center m-4 mb-2">
                      <!-- Centered content lines -->
                      <div class="w-3/4">
                        <div class="w-full h-1 bg-gray-600 rounded-full mb-2"></div>
                        <div class="w-4/5 h-1 bg-gray-600 rounded-full mb-2 mx-auto"></div>
                        <div class="w-3/5 h-1 bg-gray-600 rounded-full mx-auto"></div>
                      </div>
                    </div>
                    
                    <!-- Template name footer - full width with bottom rounded corners -->
                    <div class="bg-white px-4 py-3 text-center rounded-b-xl">
                      <div class="text-gray-700 text-sm font-medium" x-text="template.name"></div>
                    </div>
                  </div>
                </template>
              </div>

              <!-- Carousel Navigation -->
              <button 
                @click="scrollCarousel('left')"
                class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 bg-white/95 backdrop-blur-sm rounded-full p-3 shadow-medium border border-webropol-gray-200/60 hover:bg-white hover:shadow-lg hover:border-webropol-primary-300 focus:outline-none focus:ring-4 focus:ring-webropol-primary-200 transition-all z-10"
                aria-label="Scroll templates left"
                tabindex="0"
              >
                <i class="fal fa-chevron-left text-webropol-gray-600 hover:text-webropol-primary-600 transition-colors"></i>
              </button>
              <button 
                @click="scrollCarousel('right')"
                class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 bg-white/95 backdrop-blur-sm rounded-full p-3 shadow-medium border border-webropol-gray-200/60 hover:bg-white hover:shadow-lg hover:border-webropol-primary-300 focus:outline-none focus:ring-4 focus:ring-webropol-primary-200 transition-all z-10"
                aria-label="Scroll templates right"
                tabindex="0"
              >
                <i class="fal fa-chevron-right text-webropol-gray-600 hover:text-webropol-primary-600 transition-colors"></i>
              </button>
            </div>

            <!-- Pagination Dots -->
            <div class="flex justify-center space-x-2 mt-6" role="tablist" aria-label="Template pages">
              <template x-for="(dot, index) in paginationDots" :key="index">
                <button 
                  @click="goToPage(index)"
                  :class="index === currentPage ? 'bg-webropol-primary-600 ring-2 ring-webropol-primary-200' : 'bg-webropol-gray-300 hover:bg-webropol-gray-400'"
                  class="w-3 h-3 rounded-full transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-webropol-primary-200"
                  :aria-label="'Go to page ' + (index + 1)"
                  :aria-selected="index === currentPage"
                  role="tab"
                  tabindex="0"
                ></button>
              </template>
            </div>
          </div>

          <!-- Create Button -->
          <div class="flex justify-end">
            <button 
              @click="createSurvey"
              :disabled="!canCreateSurvey"
              :class="canCreateSurvey ? 'bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 cursor-pointer' : 'bg-webropol-gray-300 cursor-not-allowed'"
              class="px-8 py-3 text-white font-semibold rounded-xl shadow-medium transition-all text-lg"
            >
              Create Survey
            </button>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script>
    function createSurveyApp() {
      return {
        // Form data
        form: {
          title: '',
          folder: 'Root folder',
          automaticDeletion: true,
          deletionDate: '18.09.2028'
        },
        
        // Template selection
        activeTab: 'webropol',
        selectedTemplate: 1,
        currentPage: 0,
        
        // Calendar
        showCalendar: false,
        currentMonth: 8, // September (0-indexed)
        currentYear: 2028,
        
        // Templates data
        templates: {
          webropol: [
            { id: 1, name: 'Default template', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRTJFOEYwIi8+Cjwvc3ZnPg==' },
            { id: 2, name: 'A Default Dark', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjQ0JENUUxIi8+Cjwvc3ZnPg==' },
            { id: 3, name: 'A Default Light Blue', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRERGNEZGIi8+Cjwvc3ZnPg==' },
            { id: 4, name: 'AI: Happy', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjBGREZGIi8+Cjwvc3ZnPg==' },
            { id: 5, name: 'AI: Mountain Summer', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjBGOUZGIi8+Cjwvc3ZnPg==' },
            { id: 6, name: 'AI: Mountain Winter', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRUZGNkZGIi8+Cjwvc3ZnPg==' },
            { id: 7, name: 'AI: Sea', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjBGREZGIi8+Cjwvc3ZnPg==' }
          ],
          my: [
            { id: 101, name: 'Forest Shadow 1', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjFGNUY5Ii8+Cjwvc3ZnPg==' },
            { id: 102, name: 'Party 1', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjhGQUZDIi8+Cjwvc3ZnPg==' },
            { id: 103, name: 'Pet Time 1', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjBGOUZGIi8+Cjwvc3ZnPg==' },
            { id: 104, name: 'The Beach 1', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRURGNEZGIi8+Cjwvc3ZnPg==' }
          ],
          shared: [
            { id: 201, name: 'Corporate Blue', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRERGNEZGIi8+Cjwvc3ZnPg==' },
            { id: 202, name: 'Modern Green', image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE5MiAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTI4IiBmaWxsPSIjRjBGOUZGIi8+Cjwvc3ZnPg==' }
          ]
        },

        init() {
          // Set default deletion date to 1 year from now
          const futureDate = new Date();
          futureDate.setFullYear(futureDate.getFullYear() + 1);
          this.form.deletionDate = this.formatDate(futureDate);
          this.generateCalendar();
        },

        get currentTemplates() {
          return this.templates[this.activeTab] || [];
        },

        get paginationDots() {
          const templatesPerPage = 5;
          const totalPages = Math.ceil(this.currentTemplates.length / templatesPerPage);
          return Array.from({ length: totalPages }, (_, i) => i);
        },

        get currentMonthYear() {
          const months = ['January', 'February', 'March', 'April', 'May', 'June',
                         'July', 'August', 'September', 'October', 'November', 'December'];
          return `${months[this.currentMonth]} ${this.currentYear}`;
        },

        get calendarDays() {
          const firstDay = new Date(this.currentYear, this.currentMonth, 1);
          const lastDay = new Date(this.currentYear, this.currentMonth + 1, 0);
          const startDate = new Date(firstDay);
          startDate.setDate(startDate.getDate() - ((firstDay.getDay() + 6) % 7)); // Start from Monday

          const days = [];
          const today = new Date();
          const selectedDate = this.form.deletionDate ? this.parseDate(this.form.deletionDate) : null;

          for (let i = 0; i < 42; i++) {
            const date = new Date(startDate);
            date.setDate(startDate.getDate() + i);
            
            days.push({
              day: date.getDate(),
              date: date.toISOString().split('T')[0],
              isCurrentMonth: date.getMonth() === this.currentMonth,
              isToday: date.toDateString() === today.toDateString(),
              isSelected: selectedDate && date.toDateString() === selectedDate.toDateString()
            });
          }

          return days;
        },

        get canCreateSurvey() {
          return this.form.title.trim().length > 0 && this.selectedTemplate;
        },

        selectTemplate(template) {
          this.selectedTemplate = template.id;
        },

        scrollCarousel(direction) {
          const carousel = this.$refs.carousel;
          const scrollAmount = 200;
          if (direction === 'left') {
            carousel.scrollLeft -= scrollAmount;
          } else {
            carousel.scrollLeft += scrollAmount;
          }
        },

        goToPage(pageIndex) {
          this.currentPage = pageIndex;
          const carousel = this.$refs.carousel;
          const templateWidth = 200; // Width + margin
          carousel.scrollLeft = pageIndex * templateWidth * 5;
        },

        generateCalendar() {
          // Calendar is generated via computed property calendarDays
        },

        previousMonth() {
          if (this.currentMonth === 0) {
            this.currentMonth = 11;
            this.currentYear--;
          } else {
            this.currentMonth--;
          }
        },

        nextMonth() {
          if (this.currentMonth === 11) {
            this.currentMonth = 0;
            this.currentYear++;
          } else {
            this.currentMonth++;
          }
        },

        selectDate(day) {
          if (day.isCurrentMonth) {
            const date = new Date(this.currentYear, this.currentMonth, day.day);
            this.form.deletionDate = this.formatDate(date);
            this.showCalendar = false;
          }
        },

        formatDate(date) {
          const day = String(date.getDate()).padStart(2, '0');
          const month = String(date.getMonth() + 1).padStart(2, '0');
          const year = date.getFullYear();
          return `${day}.${month}.${year}`;
        },

        parseDate(dateString) {
          const [day, month, year] = dateString.split('.').map(Number);
          return new Date(year, month - 1, day);
        },

        openFolderPicker() {
          // Implementation for folder picker modal
          alert('Folder picker would open here');
        },

        createSurvey() {
          if (this.canCreateSurvey) {
            // Simulate survey creation
            const surveyData = {
              title: this.form.title,
              folder: this.form.folder,
              template: this.selectedTemplate,
              automaticDeletion: this.form.automaticDeletion,
              deletionDate: this.form.automaticDeletion ? this.form.deletionDate : null
            };
            
            console.log('Creating survey with data:', surveyData);
            
            // Redirect to survey editor (this would be handled by SPA router in real app)
            alert(`Survey "${this.form.title}" created successfully! Redirecting to editor...`);
            
            // In a real app, navigate to survey editor
            setTimeout(() => {
              window.location.href = '../edit.html?new=true&title=' + encodeURIComponent(this.form.title);
            }, 1000);
          }
        }
      }
    }

    // Initialize theme management
    document.addEventListener('DOMContentLoaded', function() {
      // Listen for theme changes
      document.addEventListener('theme-changed', function(e) {
        console.log('Theme changed to:', e.detail.theme);
      });
    });
  </script>
</body>
</html>
