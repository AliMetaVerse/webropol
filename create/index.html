<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title x-text="`Create New ${contentConfig.title} - Webropol`">Create New - Webropol</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'webropol-teal': { 50: '#f0fdff', 100: '#ccf7fe', 200: '#99effd', 300: '#66e0fa', 400: '#22ccf1', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490', 800: '#155e75', 900: '#164e63' },
            'webropol-gray': { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' },
            'webropol-teal-': { 50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd', 400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 800: '#1e40af', 900: '#1e3a8a' },
          },
          fontFamily: {
            'sans': ['Inter', 'system-ui', 'sans-serif'],
          },
          boxShadow: {
            'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
            'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
            'card': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
            'xl': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
          }
        }
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="../design-system/styles/animations.css" rel="stylesheet">
  <style>
    [x-cloak] {
      display: none !important;
    }

    body {
      scrollbar-width: thin;
      scrollbar-color: #cbd5e1 #f8fafc;
      font-family: 'Inter', sans-serif;
    }

    body::-webkit-scrollbar {
      width: 6px;
    }

    body::-webkit-scrollbar-track {
      background: #f8fafc;
    }

    body::-webkit-scrollbar-thumb {
      background-color: #cbd5e1;
      border-radius: 6px;
    }

    .glass-effect {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.9);
    }

    .template-card {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .template-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    .template-card.selected {
      border: 2px solid #06b6d4;
      box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.1);
    }

    .preview-container {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      position: relative;
      overflow: hidden;
    }

    .preview-form {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .step-indicator {
      transition: all 0.3s ease;
    }

    .step-indicator.active {
      background: linear-gradient(135deg, #06b6d4, #0891b2);
      color: white;
    }

    .step-indicator.completed {
      background: #10b981;
      color: white;
    }

    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .template-gradient-1 {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .template-gradient-2 {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .template-gradient-3 {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .template-gradient-4 {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }

    .template-gradient-5 {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }

    .template-gradient-6 {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    }

    .floating-particles {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      animation: float 20s infinite linear;
    }

    @keyframes float {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
    }
  </style>
  <script src="../design-system/components/navigation/Sidebar.js" type="module"></script>
  <script src="../design-system/components/navigation/Header.js" type="module"></script>
  <script src="../design-system/components/navigation/Breadcrumbs.js" type="module"></script>
  <script src="../design-system/components/modals/Modal.js" type="module"></script>
  <script src="../design-system/components/modals/SettingsModal.js" type="module"></script>
  <script src="../design-system/utils/theme-manager.js" type="module"></script>
  <script src="../design-system/utils/global-settings-manager.js" type="module"></script>
</head>
<body class="bg-gradient-to-br from-webropol-teal-50 to-webropol-teal-50/30" style="background-color: #ebf4f7;" x-data="universalCreateApp()">
  <div class="flex h-screen">
    <webropol-sidebar :active="contentConfig.sidebarActive" base="../"></webropol-sidebar>
    <div class="flex-1 flex flex-col overflow-hidden">
      <webropol-header username="Ali Al-Zuhairi" show-notifications="true" show-help="true" show-user-menu="true"></webropol-header>
      <div class="bg-white/70 backdrop-blur px-0 sm:px-4">
        <webropol-breadcrumbs :trail="breadcrumbTrail"></webropol-breadcrumbs>
      </div>
      
      <main class="flex-1 overflow-hidden" role="main">
        <div class="h-full flex">
          <!-- Left Panel - Creation Form -->
          <div class="w-1/2 overflow-y-auto px-8 py-8 bg-white/50">
            <div class="max-w-2xl mx-auto">
              <!-- Header -->
              <div class="mb-8">
                <h1 class="text-3xl font-bold text-webropol-gray-900 mb-3" x-text="`Create a New ${contentConfig.title}`"></h1>
                <p class="text-webropol-gray-600" x-text="contentConfig.description"></p>
              </div>

              <!-- Step Indicator -->
              <div class="flex items-center mb-8" x-show="contentConfig.showSteps">
                <div class="step-indicator active w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold mr-3">1</div>
                <div class="flex-1 h-px bg-webropol-gray-200 mr-3"></div>
                <div class="step-indicator w-8 h-8 rounded-full bg-webropol-gray-200 flex items-center justify-center text-sm font-semibold mr-3">2</div>
                <div class="flex-1 h-px bg-webropol-gray-200 mr-3"></div>
                <div class="step-indicator w-8 h-8 rounded-full bg-webropol-gray-200 flex items-center justify-center text-sm font-semibold">3</div>
              </div>

              <!-- Basic Details -->
              <div class="bg-white rounded-2xl p-6 shadow-soft mb-6 fade-in">
                <h2 class="text-xl font-semibold text-webropol-gray-900 mb-4" x-text="`${contentConfig.title} Details`"></h2>
                
                <div class="space-y-6">
                  <!-- Title -->
                  <div>
                    <label class="block text-sm font-medium text-webropol-gray-700 mb-2" x-text="`${contentConfig.title} Title *`"></label>
                    <input 
                      type="text" 
                      x-model="formData.title"
                      :placeholder="`Enter your ${contentConfig.title.toLowerCase()} title...`"
                      class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                    >
                  </div>

                  <!-- Description -->
                  <div>
                    <label class="block text-sm font-medium text-webropol-gray-700 mb-2">Description (Optional)</label>
                    <textarea 
                      x-model="formData.description"
                      :placeholder="`Brief description of your ${contentConfig.title.toLowerCase()}...`"
                      rows="3"
                      class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                    ></textarea>
                  </div>

                  <!-- Content-specific fields -->
                  <template x-for="field in contentConfig.customFields" :key="field.name">
                    <div>
                      <label class="block text-sm font-medium text-webropol-gray-700 mb-2" x-text="field.label + (field.required ? ' *' : '')"></label>
                      <template x-if="field.type === 'select'">
                        <select 
                          x-model="formData[field.name]"
                          class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                        >
                          <template x-for="option in field.options" :key="option.value">
                            <option :value="option.value" x-text="option.label"></option>
                          </template>
                        </select>
                      </template>
                      <template x-if="field.type === 'date'">
                        <input 
                          type="date"
                          x-model="formData[field.name]"
                          class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                        >
                      </template>
                      <template x-if="field.type === 'time'">
                        <input 
                          type="time"
                          x-model="formData[field.name]"
                          class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                        >
                      </template>
                      <template x-if="field.type === 'textarea'">
                        <textarea 
                          x-model="formData[field.name]"
                          :placeholder="field.placeholder"
                          :rows="field.rows || 3"
                          class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                        ></textarea>
                      </template>
                      <template x-if="field.type === 'number'">
                        <input 
                          type="number"
                          x-model="formData[field.name]"
                          :placeholder="field.placeholder"
                          :min="field.min"
                          :max="field.max"
                          class="w-full px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                        >
                      </template>
                    </div>
                  </template>

                  <!-- Auto-delete Settings (for applicable content types) -->
                  <div x-show="contentConfig.showAutoDelete" class="bg-webropol-gray-50 rounded-xl p-4">
                    <div class="flex items-center justify-between mb-3">
                      <label class="flex items-center text-sm font-medium text-webropol-gray-700">
                        <input type="checkbox" x-model="formData.autoDelete" class="mr-2 rounded text-webropol-teal-600">
                        Automatic Deletion Date
                      </label>
                      <i class="fal fa-info-circle text-webropol-gray-400 cursor-help" :title="`${contentConfig.title} will be automatically deleted after this date`"></i>
                    </div>
                    <div x-show="formData.autoDelete" x-transition>
                      <input 
                        type="date" 
                        x-model="formData.deleteDate"
                        class="w-full px-4 py-2 border border-webropol-gray-200 rounded-lg focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all"
                      >
                      <p class="text-xs text-webropol-gray-500 mt-1" x-text="`${contentConfig.title} will be automatically deleted after this date.`"></p>
                    </div>
                  </div>

                  <!-- Folder Selection (for applicable content types) -->
                  <div x-show="contentConfig.showFolder">
                    <label class="block text-sm font-medium text-webropol-gray-700 mb-2" x-text="`${contentConfig.title} Folder`"></label>
                    <div class="flex gap-2">
                      <select x-model="formData.selectedFolder" class="flex-1 px-4 py-3 border border-webropol-gray-200 rounded-xl focus:ring-2 focus:ring-webropol-teal-500 focus:border-transparent transition-all">
                        <template x-for="folder in contentConfig.folders" :key="folder.value">
                          <option :value="folder.value" x-text="folder.label"></option>
                        </template>
                      </select>
                      <button class="px-4 py-3 border border-webropol-gray-200 rounded-xl hover:bg-webropol-gray-50 transition-all">
                        <i class="fal fa-folder-plus text-webropol-gray-600"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Template Selection (shown only for content types that have templates) -->
              <div x-show="contentConfig.showTemplates" class="bg-white rounded-2xl p-6 shadow-soft fade-in">
                <h2 class="text-xl font-semibold text-webropol-gray-900 mb-4">Choose a Template</h2>
                
                <!-- Template Categories -->
                <div class="flex gap-2 mb-6">
                  <template x-for="(category, index) in contentConfig.templateCategories" :key="index">
                    <button 
                      @click="activeCategory = category.id"
                      :class="activeCategory === category.id ? 'bg-webropol-teal-500 text-white' : 'bg-webropol-gray-100 text-webropol-gray-700 hover:bg-webropol-gray-200'"
                      class="px-4 py-2 rounded-lg font-medium transition-all text-sm"
                      x-text="category.name + ' (' + category.count + ')'"
                    ></button>
                  </template>
                </div>

                <!-- Template Grid -->
                <div class="grid grid-cols-2 gap-4">
                  <template x-for="(template, index) in filteredTemplates" :key="index">
                    <div 
                      @click="formData.selectedTemplate = template.id"
                      :class="formData.selectedTemplate === template.id ? 'template-card selected' : 'template-card'"
                      class="border border-webropol-gray-200 rounded-xl p-4 cursor-pointer"
                    >
                      <div :class="template.gradient" class="w-full h-24 rounded-lg mb-3 flex items-center justify-center">
                        <i :class="template.icon" class="text-white text-2xl"></i>
                      </div>
                      <h3 class="font-semibold text-webropol-gray-900 mb-1" x-text="template.name"></h3>
                      <p class="text-xs text-webropol-gray-600" x-text="template.description"></p>
                      <div class="mt-2">
                        <button 
                          class="w-full py-2 text-sm font-medium rounded-lg transition-all"
                          :class="formData.selectedTemplate === template.id ? 'bg-webropol-teal-500 text-white' : 'bg-webropol-gray-100 text-webropol-gray-700 hover:bg-webropol-gray-200'"
                        >
                          <span x-text="formData.selectedTemplate === template.id ? 'Selected' : 'Select'"></span>
                        </button>
                      </div>
                    </div>
                  </template>
                </div>
              </div>

              <!-- Action Buttons -->
              <div class="flex gap-4 mt-8">
                <button 
                  @click="createItem()"
                  :disabled="!isFormValid"
                  :class="!isFormValid ? 'opacity-50 cursor-not-allowed' : 'hover:from-webropol-teal-600 hover:to-webropol-teal-700'"
                  class="flex-1 py-4 bg-gradient-to-r from-webropol-teal-500 to-webropol-teal-600 text-white font-semibold rounded-xl shadow-medium transition-all"
                >
                  <i :class="contentConfig.icon" class="mr-2"></i>
                  <span x-text="`Create Your ${contentConfig.title}`"></span>
                </button>
                <button class="px-6 py-4 border border-webropol-gray-200 text-webropol-gray-700 font-semibold rounded-xl hover:bg-webropol-gray-50 transition-all">
                  Save as Draft
                </button>
              </div>
            </div>
          </div>

          <!-- Right Panel - Live Preview -->
          <div class="w-1/2 preview-container relative">
            <!-- Floating Particles -->
            <div class="floating-particles">
              <div class="particle" style="left: 10%; width: 8px; height: 8px; animation-delay: 0s;"></div>
              <div class="particle" style="left: 20%; width: 12px; height: 12px; animation-delay: 2s;"></div>
              <div class="particle" style="left: 35%; width: 6px; height: 6px; animation-delay: 4s;"></div>
              <div class="particle" style="left: 50%; width: 10px; height: 10px; animation-delay: 6s;"></div>
              <div class="particle" style="left: 65%; width: 8px; height: 8px; animation-delay: 8s;"></div>
              <div class="particle" style="left: 80%; width: 14px; height: 14px; animation-delay: 10s;"></div>
              <div class="particle" style="left: 90%; width: 6px; height: 6px; animation-delay: 12s;"></div>
            </div>

            <div class="flex items-center justify-center h-full p-8">
              <div class="preview-form w-full max-w-md p-8">
                <div class="text-center mb-6">
                  <h3 class="text-2xl font-bold text-webropol-gray-900 mb-2">Live Preview</h3>
                  <p class="text-webropol-gray-600" x-text="`See how your ${contentConfig.title.toLowerCase()} will look`"></p>
                </div>

                <!-- Dynamic Preview Content -->
                <div class="space-y-6" x-html="previewContent">
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script>
    function universalCreateApp() {
      return {
        // Content type from URL parameter
        contentType: new URLSearchParams(window.location.search).get('type') || 'survey',
        activeCategory: 'webropol',
        
        // Form data
        formData: {
          title: '',
          description: '',
          autoDelete: false,
          deleteDate: '',
          selectedFolder: 'root',
          selectedTemplate: 'blank'
        },

        // Content configurations
        contentConfigs: {
          survey: {
            title: 'Survey',
            description: 'Build engaging surveys with our intuitive tools and templates',
            icon: 'fal fa-chart-bar',
            sidebarActive: 'surveys',
            showSteps: true,
            showTemplates: true,
            showAutoDelete: true,
            showFolder: true,
            folders: [
              { value: 'root', label: 'Root' },
              { value: 'employee-surveys', label: 'Employee Surveys' },
              { value: 'customer-feedback', label: 'Customer Feedback' },
              { value: 'market-research', label: 'Market Research' }
            ],
            customFields: [],
            templateCategories: [
              { id: 'webropol', name: 'Webropol Templates', count: 8 },
              { id: 'my', name: 'My Templates', count: 3 },
              { id: 'shared', name: 'Shared Templates', count: 12 }
            ],
            templates: [
              { id: 'blank', category: 'webropol', name: 'Blank Template', description: 'Start from scratch', icon: 'fal fa-file-alt', gradient: 'template-gradient-1' },
              { id: 'customer-satisfaction', category: 'webropol', name: 'Customer Satisfaction', description: 'Measure customer happiness', icon: 'fal fa-smile', gradient: 'template-gradient-2' },
              { id: 'employee-engagement', category: 'webropol', name: 'Employee Engagement', description: 'Assess workplace satisfaction', icon: 'fal fa-users', gradient: 'template-gradient-3' },
              { id: 'market-research', category: 'webropol', name: 'Market Research', description: 'Gather market insights', icon: 'fal fa-chart-line', gradient: 'template-gradient-4' },
              { id: 'event-feedback', category: 'webropol', name: 'Event Feedback', description: 'Post-event evaluation', icon: 'fal fa-calendar-alt', gradient: 'template-gradient-5' },
              { id: 'product-feedback', category: 'webropol', name: 'Product Feedback', description: 'Product improvement insights', icon: 'fal fa-star', gradient: 'template-gradient-6' },
              { id: 'nps', category: 'webropol', name: 'Net Promoter Score', description: 'Measure customer loyalty', icon: 'fal fa-thumbs-up', gradient: 'template-gradient-1' },
              { id: 'training-evaluation', category: 'webropol', name: 'Training Evaluation', description: 'Assess training effectiveness', icon: 'fal fa-graduation-cap', gradient: 'template-gradient-2' }
            ]
          },
          event: {
            title: 'Event',
            description: 'Create and manage events with registration and tracking capabilities',
            icon: 'fal fa-calendar-alt',
            sidebarActive: 'events',
            showSteps: true,
            showTemplates: true,
            showAutoDelete: false,
            showFolder: true,
            folders: [
              { value: 'root', label: 'Root' },
              { value: 'conferences', label: 'Conferences' },
              { value: 'workshops', label: 'Workshops' },
              { value: 'webinars', label: 'Webinars' }
            ],
            customFields: [
              { name: 'eventDate', label: 'Event Date', type: 'date', required: true },
              { name: 'eventTime', label: 'Event Time', type: 'time', required: true },
              { name: 'location', label: 'Location', type: 'textarea', placeholder: 'Event location or online meeting details', rows: 2 },
              { name: 'maxAttendees', label: 'Maximum Attendees', type: 'number', min: 1, max: 10000, placeholder: 'Enter maximum number of attendees' }
            ],
            templateCategories: [
              { id: 'webropol', name: 'Event Templates', count: 6 },
              { id: 'my', name: 'My Templates', count: 2 }
            ],
            templates: [
              { id: 'conference', category: 'webropol', name: 'Conference', description: 'Large scale conferences', icon: 'fal fa-users', gradient: 'template-gradient-1' },
              { id: 'workshop', category: 'webropol', name: 'Workshop', description: 'Interactive workshops', icon: 'fal fa-tools', gradient: 'template-gradient-2' },
              { id: 'webinar', category: 'webropol', name: 'Webinar', description: 'Online presentations', icon: 'fal fa-video', gradient: 'template-gradient-3' },
              { id: 'meetup', category: 'webropol', name: 'Meetup', description: 'Casual gatherings', icon: 'fal fa-coffee', gradient: 'template-gradient-4' },
              { id: 'training', category: 'webropol', name: 'Training Session', description: 'Educational events', icon: 'fal fa-graduation-cap', gradient: 'template-gradient-5' },
              { id: 'networking', category: 'webropol', name: 'Networking Event', description: 'Professional networking', icon: 'fal fa-handshake', gradient: 'template-gradient-6' }
            ]
          },
          exw: {
            title: 'Employee Experience Survey',
            description: 'Create employee satisfaction and engagement surveys',
            icon: 'fal fa-user-chart',
            sidebarActive: 'exw',
            showSteps: true,
            showTemplates: true,
            showAutoDelete: true,
            showFolder: true,
            folders: [
              { value: 'root', label: 'Root' },
              { value: 'engagement', label: 'Engagement Surveys' },
              { value: 'pulse', label: 'Pulse Surveys' },
              { value: 'exit', label: 'Exit Interviews' }
            ],
            customFields: [
              { name: 'department', label: 'Target Department', type: 'select', options: [
                { value: 'all', label: 'All Departments' },
                { value: 'hr', label: 'Human Resources' },
                { value: 'it', label: 'Information Technology' },
                { value: 'sales', label: 'Sales' },
                { value: 'marketing', label: 'Marketing' }
              ]}
            ],
            templateCategories: [
              { id: 'webropol', name: 'EXW Templates', count: 5 }
            ],
            templates: [
              { id: 'engagement', category: 'webropol', name: 'Employee Engagement', description: 'Measure engagement levels', icon: 'fal fa-heart', gradient: 'template-gradient-1' },
              { id: 'pulse', category: 'webropol', name: 'Pulse Survey', description: 'Quick pulse checks', icon: 'fal fa-pulse', gradient: 'template-gradient-2' },
              { id: 'satisfaction', category: 'webropol', name: 'Job Satisfaction', description: 'Overall job satisfaction', icon: 'fal fa-smile', gradient: 'template-gradient-3' },
              { id: 'exit', category: 'webropol', name: 'Exit Interview', description: 'Departing employee feedback', icon: 'fal fa-door-open', gradient: 'template-gradient-4' },
              { id: 'onboarding', category: 'webropol', name: 'Onboarding Feedback', description: 'New hire experience', icon: 'fal fa-user-plus', gradient: 'template-gradient-5' }
            ]
          },
          'case-management': {
            title: 'Case',
            description: 'Create and manage support cases and customer inquiries',
            icon: 'fal fa-briefcase',
            sidebarActive: 'case-management',
            showSteps: false,
            showTemplates: false,
            showAutoDelete: false,
            showFolder: true,
            folders: [
              { value: 'root', label: 'Root' },
              { value: 'support', label: 'Support Cases' },
              { value: 'bugs', label: 'Bug Reports' },
              { value: 'features', label: 'Feature Requests' }
            ],
            customFields: [
              { name: 'priority', label: 'Priority', type: 'select', required: true, options: [
                { value: 'low', label: 'Low' },
                { value: 'medium', label: 'Medium' },
                { value: 'high', label: 'High' },
                { value: 'critical', label: 'Critical' }
              ]},
              { name: 'category', label: 'Category', type: 'select', required: true, options: [
                { value: 'technical', label: 'Technical Issue' },
                { value: 'billing', label: 'Billing' },
                { value: 'feature', label: 'Feature Request' },
                { value: 'bug', label: 'Bug Report' },
                { value: 'other', label: 'Other' }
              ]},
              { name: 'assignee', label: 'Assign To', type: 'select', options: [
                { value: '', label: 'Unassigned' },
                { value: 'john', label: 'John Smith' },
                { value: 'jane', label: 'Jane Doe' },
                { value: 'mike', label: 'Mike Johnson' }
              ]}
            ]
          },
          sms: {
            title: '2-Way SMS Campaign',
            description: 'Create interactive SMS campaigns and messaging workflows',
            icon: 'fal fa-sms',
            sidebarActive: 'sms',
            showSteps: false,
            showTemplates: false, // This is the key change - no templates for SMS
            showAutoDelete: true,
            showFolder: true,
            folders: [
              { value: 'root', label: 'Root' },
              { value: 'marketing', label: 'Marketing Campaigns' },
              { value: 'notifications', label: 'Notifications' },
              { value: 'surveys', label: 'SMS Surveys' }
            ],
            customFields: [
              { name: 'recipientList', label: 'Recipient List', type: 'select', required: true, options: [
                { value: 'all', label: 'All Contacts' },
                { value: 'customers', label: 'Customers' },
                { value: 'prospects', label: 'Prospects' },
                { value: 'employees', label: 'Employees' }
              ]},
              { name: 'sendTime', label: 'Send Time', type: 'select', options: [
                { value: 'now', label: 'Send Now' },
                { value: 'scheduled', label: 'Schedule for Later' }
              ]},
              { name: 'message', label: 'SMS Message', type: 'textarea', rows: 4, placeholder: 'Enter your SMS message (max 160 characters)', required: true }
            ]
          }
        },

        // Computed properties
        get contentConfig() {
          return this.contentConfigs[this.contentType] || this.contentConfigs.survey;
        },

        get breadcrumbTrail() {
          const basePath = this.contentType === 'survey' ? 'surveys' : 
                          this.contentType === 'event' ? 'events' :
                          this.contentType === 'exw' ? 'exw' :
                          this.contentType === 'case-management' ? 'case-management' :
                          this.contentType === 'sms' ? 'sms' : 'surveys';
          
          return JSON.stringify([
            {"label":"Home","url":"../index.html"},
            {"label":this.contentConfig.title + "s","url":`../${basePath}/index.html`},
            {"label":`Create New ${this.contentConfig.title}`,"url":"index.html"}
          ]);
        },

        get filteredTemplates() {
          if (!this.contentConfig.templates) return [];
          return this.contentConfig.templates.filter(template => template.category === this.activeCategory);
        },

        get isFormValid() {
          if (!this.formData.title) return false;
          if (this.contentConfig.showTemplates && !this.formData.selectedTemplate) return false;
          
          // Check required custom fields
          for (const field of this.contentConfig.customFields) {
            if (field.required && !this.formData[field.name]) return false;
          }
          
          return true;
        },

        get previewContent() {
          return this.generatePreviewContent();
        },

        // Methods
        generatePreviewContent() {
          const title = this.formData.title || `Your ${this.contentConfig.title} Title`;
          const description = this.formData.description || `${this.contentConfig.title} description will appear here`;

          switch (this.contentType) {
            case 'survey':
              return this.generateSurveyPreview(title, description);
            case 'event':
              return this.generateEventPreview(title, description);
            case 'exw':
              return this.generateExwPreview(title, description);
            case 'case-management':
              return this.generateCasePreview(title, description);
            case 'sms':
              return this.generateSmsPreview(title, description);
            default:
              return this.generateSurveyPreview(title, description);
          }
        },

        generateSurveyPreview(title, description) {
          return `
            <div class="text-center">
              <h4 class="text-lg font-semibold text-webropol-gray-900 mb-2">${title}</h4>
              <p class="text-sm text-webropol-gray-600">${description}</p>
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <h5 class="font-medium text-webropol-gray-900 mb-3">1. How satisfied are you with our service?</h5>
              <div class="space-y-2">
                <label class="flex items-center">
                  <input type="radio" name="q1" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Very Satisfied</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="q1" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Satisfied</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="q1" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Neutral</span>
                </label>
              </div>
            </div>
            <div class="mt-6">
              <div class="flex justify-between text-xs text-webropol-gray-600 mb-2">
                <span>Progress</span>
                <span>1 of 5 questions</span>
              </div>
              <div class="w-full bg-webropol-gray-200 rounded-full h-2">
                <div class="bg-gradient-to-r from-webropol-teal-500 to-webropol-teal-600 h-2 rounded-full" style="width: 20%"></div>
              </div>
            </div>
          `;
        },

        generateEventPreview(title, description) {
          const eventDate = this.formData.eventDate ? new Date(this.formData.eventDate).toLocaleDateString() : 'Event Date';
          const eventTime = this.formData.eventTime || 'Event Time';
          const location = this.formData.location || 'Event Location';
          
          return `
            <div class="text-center">
              <h4 class="text-lg font-semibold text-webropol-gray-900 mb-2">${title}</h4>
              <p class="text-sm text-webropol-gray-600">${description}</p>
            </div>
            <div class="bg-white/70 rounded-xl p-4 space-y-3">
              <div class="flex items-center">
                <i class="fal fa-calendar text-webropol-teal-600 mr-3"></i>
                <span class="text-sm font-medium">${eventDate}</span>
              </div>
              <div class="flex items-center">
                <i class="fal fa-clock text-webropol-teal-600 mr-3"></i>
                <span class="text-sm">${eventTime}</span>
              </div>
              <div class="flex items-start">
                <i class="fal fa-map-marker-alt text-webropol-teal-600 mr-3 mt-1"></i>
                <span class="text-sm">${location}</span>
              </div>
              ${this.formData.maxAttendees ? `
                <div class="flex items-center">
                  <i class="fal fa-users text-webropol-teal-600 mr-3"></i>
                  <span class="text-sm">Max ${this.formData.maxAttendees} attendees</span>
                </div>
              ` : ''}
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <button class="w-full py-2 bg-gradient-to-r from-webropol-teal-500 to-webropol-teal-600 text-white rounded-lg font-medium">
                Register for Event
              </button>
            </div>
          `;
        },

        generateExwPreview(title, description) {
          return `
            <div class="text-center">
              <h4 class="text-lg font-semibold text-webropol-gray-900 mb-2">${title}</h4>
              <p class="text-sm text-webropol-gray-600">${description}</p>
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <h5 class="font-medium text-webropol-gray-900 mb-3">How engaged do you feel at work?</h5>
              <div class="space-y-2">
                <label class="flex items-center">
                  <input type="radio" name="engagement" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Highly Engaged</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="engagement" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Engaged</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="engagement" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Neutral</span>
                </label>
                <label class="flex items-center">
                  <input type="radio" name="engagement" class="mr-3 text-webropol-teal-600">
                  <span class="text-sm">Disengaged</span>
                </label>
              </div>
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <h5 class="font-medium text-webropol-gray-900 mb-3">Additional Comments</h5>
              <textarea class="w-full px-3 py-2 border border-webropol-gray-200 rounded-lg text-sm" rows="3" placeholder="Share your thoughts..."></textarea>
            </div>
          `;
        },

        generateCasePreview(title, description) {
          const priority = this.formData.priority || 'medium';
          const category = this.formData.category || 'technical';
          
          return `
            <div class="text-center">
              <h4 class="text-lg font-semibold text-webropol-gray-900 mb-2">${title}</h4>
              <p class="text-sm text-webropol-gray-600">${description}</p>
            </div>
            <div class="bg-white/70 rounded-xl p-4 space-y-3">
              <div class="flex justify-between">
                <span class="text-sm font-medium">Priority:</span>
                <span class="text-sm px-2 py-1 rounded-full ${priority === 'critical' ? 'bg-red-100 text-red-800' : priority === 'high' ? 'bg-orange-100 text-orange-800' : priority === 'medium' ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'}">${priority.charAt(0).toUpperCase() + priority.slice(1)}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-sm font-medium">Category:</span>
                <span class="text-sm">${category.charAt(0).toUpperCase() + category.slice(1)}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-sm font-medium">Status:</span>
                <span class="text-sm px-2 py-1 bg-blue-100 text-blue-800 rounded-full">New</span>
              </div>
              ${this.formData.assignee ? `
                <div class="flex justify-between">
                  <span class="text-sm font-medium">Assigned to:</span>
                  <span class="text-sm">${this.formData.assignee}</span>
                </div>
              ` : ''}
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <h5 class="font-medium text-webropol-gray-900 mb-3">Case Details</h5>
              <textarea class="w-full px-3 py-2 border border-webropol-gray-200 rounded-lg text-sm" rows="4" placeholder="Describe the issue or request..."></textarea>
            </div>
          `;
        },

        generateSmsPreview(title, description) {
          const message = this.formData.message || 'Your SMS message will appear here...';
          const recipientList = this.formData.recipientList || 'all';
          
          return `
            <div class="text-center">
              <h4 class="text-lg font-semibold text-webropol-gray-900 mb-2">${title}</h4>
              <p class="text-sm text-webropol-gray-600">${description}</p>
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <div class="flex items-center mb-3">
                <i class="fal fa-mobile-alt text-webropol-teal-600 mr-2"></i>
                <span class="text-sm font-medium">SMS Preview</span>
              </div>
              <div class="bg-webropol-gray-100 rounded-lg p-3 text-sm">
                ${message}
              </div>
              <div class="flex justify-between mt-3 text-xs text-webropol-gray-500">
                <span>Characters: ${message.length}/160</span>
                <span>Recipients: ${recipientList.charAt(0).toUpperCase() + recipientList.slice(1)}</span>
              </div>
            </div>
            <div class="bg-white/70 rounded-xl p-4">
              <h5 class="font-medium text-webropol-gray-900 mb-3">Campaign Settings</h5>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span>Send Time:</span>
                  <span>${this.formData.sendTime || 'now'}</span>
                </div>
                <div class="flex justify-between">
                  <span>Auto-replies:</span>
                  <span>Enabled</span>
                </div>
              </div>
            </div>
          `;
        },

        createItem() {
          if (!this.isFormValid) return;

          // Simulate creation
          alert(`${this.contentConfig.title} created successfully! Redirecting to ${this.contentConfig.title.toLowerCase()} management...`);
          
          // In a real app, this would redirect to the appropriate management page
          // window.location.href = `/${this.contentType === 'survey' ? 'surveys' : this.contentType}/`;
        },

        init() {
          // Set default date to 30 days from now for auto-delete
          const futureDate = new Date();
          futureDate.setDate(futureDate.getDate() + 30);
          this.formData.deleteDate = futureDate.toISOString().split('T')[0];

          // Initialize custom fields in form data
          for (const field of this.contentConfig.customFields) {
            if (field.type === 'select' && field.options.length > 0) {
              this.formData[field.name] = field.options[0].value;
            } else {
              this.formData[field.name] = '';
            }
          }

          // Set default folder
          if (this.contentConfig.folders && this.contentConfig.folders.length > 0) {
            this.formData.selectedFolder = this.contentConfig.folders[0].value;
          }

          // Set default template if templates are shown
          if (this.contentConfig.showTemplates && this.contentConfig.templates && this.contentConfig.templates.length > 0) {
            this.formData.selectedTemplate = this.contentConfig.templates[0].id;
          }
        }
      }
    }
  </script>
</body>
</html>
