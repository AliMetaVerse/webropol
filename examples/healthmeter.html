<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Meter Example</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/50ef2d3cf8.js" crossorigin="anonymous"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Tailwind config with Webropol tokens -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'webropol-primary': { 50: '#f0fdff', 500: '#06b6d4', 700: '#0e7490', 900: '#164e63' },
                        'webropol-gray': { 50: '#f8fafc', 500: '#64748b', 900: '#0f172a' }
                    },
                    fontFamily: { 'sans': ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>
    
    <!-- Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Design system components -->
    <script src="../design-system/components/navigation/Sidebar.js" type="module"></script>
    <script src="../design-system/components/navigation/Header.js" type="module"></script>
    <script src="../design-system/components/navigation/Breadcrumbs.js" type="module"></script>
</head>
<body x-data="moduleApp()" @toggle-fullscreen.window="fullscreen = $event.detail">
    <div class="flex h-screen bg-webropol-gray-50">
        <webropol-sidebar active="examples" base="../" x-show="!fullscreen" class="transition-all duration-300"></webropol-sidebar>
        
        <div class="flex-1 flex flex-col overflow-hidden">
            <webropol-header username="User" show-notifications show-help show-user-menu show-theme-selector 
                             x-show="!fullscreen" class="transition-all duration-300"></webropol-header>
            
            <div class="bg-white/70 backdrop-blur px-0 sm:px-4 transition-all duration-300"
                 x-show="!fullscreen">
                <webropol-breadcrumbs trail='[{"label":"Home","url":"../index.html"},{"label":"Examples","url":"#"}, {"label":"Health Meter","url":"#"}]'></webropol-breadcrumbs>
            </div>
            
            <main class="flex-1 overflow-y-auto px-4 py-6 md:px-6 md:py-12" role="main">
                
                <!-- Use 'x-cloak' to avoid flicker but we removed it per instructions unless styled. 
                     We will manage state via Alpine. -->
                
                <!-- Health Meter App Container -->
                <div class="max-w-6xl mx-auto" x-data="healthSlider()">

                    <!-- Top Bar: Mode Switcher & Settings -->
                    <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
                        <!-- Mode Tabs -->
                        <div class="bg-webropol-gray-100 p-1 rounded-lg inline-flex">
                            <button @click="mode = 'edit'; $dispatch('toggle-fullscreen', false)" 
                                    :class="mode === 'edit' ? 'bg-white shadow-sm text-webropol-primary-700 font-semibold' : 'text-webropol-gray-500 hover:text-webropol-gray-700'"
                                    class="px-4 py-2 rounded-md text-sm transition-all duration-200">
                                <i class="fa-light fa-pen-to-square mr-2"></i>Edit
                            </button>
                            <button @click="mode = 'respond'; $dispatch('toggle-fullscreen', true)" 
                                    :class="mode === 'respond' ? 'bg-white shadow-sm text-webropol-primary-700 font-semibold' : 'text-webropol-gray-500 hover:text-webropol-gray-700'"
                                    class="px-4 py-2 rounded-md text-sm transition-all duration-200">
                                <i class="fa-light fa-eye mr-2"></i>Respond
                            </button>
                        </div>

                        <!-- Settings Button -->
                        <button @click="showSettings = true" class="text-webropol-gray-400 hover:text-webropol-primary-600 transition-colors p-2">
                            <i class="fa-light fa-gear text-xl"></i>
                        </button>
                    </div>

                    <!-- Main Card -->
                    <div class="bg-white p-6 md:p-12 rounded-3xl shadow-xl transition-all duration-300 ring-1 ring-black/5 hover:shadow-2xl">
                        
                        <!-- Header Section -->
                        <div class="mb-10 pl-2">
                            <!-- Edit Mode: Inputs -->
                            <template x-if="mode === 'edit'">
                                <div class="space-y-4">
                                    <input type="text" x-model="texts.title" class="w-full text-2xl md:text-4xl font-extrabold text-webropol-gray-900 tracking-tight border-b-2 border-transparent hover:border-webropol-primary-100 focus:border-webropol-primary-500 focus:outline-none transition-all duration-200 bg-transparent placeholder-webropol-gray-300 pb-2">
                                    <input type="text" x-model="texts.subtitle" class="w-full text-webropol-primary-600 font-semibold text-base md:text-lg border-b-2 border-transparent hover:border-webropol-primary-100 focus:border-webropol-primary-500 focus:outline-none transition-all duration-200 bg-transparent pb-1">
                                </div>
                            </template>
                            <!-- Respond Mode: Text -->
                            <template x-if="mode === 'respond'">
                                <div class="space-y-2">
                                    <h1 class="text-2xl md:text-4xl font-extrabold text-webropol-gray-900 tracking-tight leading-tight" x-text="texts.title"></h1>
                                    <p class="text-webropol-primary-600 font-semibold text-base md:text-lg" x-text="texts.subtitle"></p>
                                </div>
                            </template>
                        </div>

                        <!-- Content Area (Flex determines layout) -->
                        <div class="flex gap-8 md:gap-16 transition-all duration-500"
                             :class="orientation === 'vertical' ? 'flex-col md:flex-row' : 'flex-col'">
                            
                            <!-- Instructions & Display Box -->
                            <div class="flex-1 pt-4 flex transition-all duration-500"
                                 :class="orientation === 'vertical' ? 'flex-col' : 'flex-col md:flex-row justify-between items-start gap-8 md:gap-12'">
                                
                                <!-- Instructions List -->
                                <div class="prose prose-base md:prose-lg text-webropol-gray-600 max-w-none transition-opacity duration-300"
                                     :class="orientation === 'horizontal' ? 'flex-1' : ''">
                                    
                                    <!-- Edit Mode: Single Textarea -->
                                    <div x-show="mode === 'edit'" class="w-full relative group">
                                        <textarea x-model="texts.instructions" 
                                                  class="w-full min-h-[300px] bg-gray-50/50 border-2 border-transparent hover:border-webropol-primary-200 focus:border-webropol-primary-500 rounded-xl p-6 resize-none focus:outline-none leading-loose text-webropol-gray-700 transition-all duration-200 shadow-inner"
                                                  placeholder="Enter instructions, one per line..."></textarea>
                                        <div class="absolute top-4 right-4 text-xs font-semibold text-webropol-primary-400 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none uppercase tracking-wide">Editable Text</div>
                                    </div>

                                    <!-- Respond Mode: List -->
                                    <ul x-show="mode === 'respond'" class="list-none pl-2 space-y-5">
                                        <template x-for="(item, index) in texts.instructions ? texts.instructions.split('\n') : []" :key="index">
                                            <li x-show="item.trim().length > 0" class="flex items-start gap-4 group">
                                                <div class="w-2 h-2 rounded-full bg-webropol-primary-400 mt-2.5 flex-shrink-0 group-hover:scale-125 group-hover:bg-webropol-primary-500 transition-all duration-300 shadow-sm ring-2 ring-transparent group-hover:ring-webropol-primary-100"></div>
                                                <div x-html="item" class="text-webropol-gray-700 leading-relaxed font-medium transition-colors group-hover:text-webropol-gray-900"></div>
                                            </li>
                                        </template>
                                    </ul>
                                </div>

                                <!-- "Your Health" Black Box Display -->
                                <div class="bg-[#1a0b2e] border-2 border-[#4c1d95] text-white flex flex-col items-center justify-center shadow-2xl transition-all duration-500 flex-shrink-0 relative overflow-hidden group rounded-xl"
                                     :class="orientation === 'vertical' ? 'mt-8 md:mt-12 w-full max-w-[14rem] md:w-56 h-72 mx-auto md:mx-0' : 'mt-8 md:mt-0 w-full max-w-[16rem] md:w-64 h-56 py-8 mx-auto md:mx-0'">
                                    
                                    <!-- Subtle gradient overlay for depth without losing pure black feel -->
                                    <div class="absolute inset-0 bg-gradient-to-br from-[#7c3aed]/20 to-transparent pointer-events-none"></div>

                                    <template x-if="mode === 'edit'">
                                        <div class="flex flex-col items-center text-center relative z-10">
                                            <input x-model="texts.boxLabel1" class="bg-transparent text-center text-white/90 text-sm font-bold tracking-[0.25em] mb-2 w-36 border-b border-transparent hover:border-white/40 focus:border-white focus:outline-none transition-all uppercase placeholder-white/30">
                                            <input x-model="texts.boxLabel2" class="bg-transparent text-center text-white/90 text-sm font-bold tracking-[0.25em] mb-2 w-36 border-b border-transparent hover:border-white/40 focus:border-white focus:outline-none transition-all uppercase placeholder-white/30">
                                            <input x-model="texts.boxLabel3" class="bg-transparent text-center text-white/90 text-sm font-bold tracking-[0.25em] mb-6 w-36 border-b border-transparent hover:border-white/40 focus:border-white focus:outline-none transition-all uppercase placeholder-white/30">
                                        </div>
                                    </template>
                                    <template x-if="mode === 'respond'">
                                        <div class="flex flex-col items-center text-center relative z-10 transition-transform duration-300 group-hover:-translate-y-1">
                                            <span class="text-xs font-bold tracking-[0.3em] mb-2 text-white/90 uppercase" x-text="texts.boxLabel1"></span>
                                            <span class="text-xs font-bold tracking-[0.3em] mb-2 text-white/90 uppercase" x-text="texts.boxLabel2"></span>
                                            <span class="text-xs font-bold tracking-[0.3em] text-white/90 uppercase" :class="orientation === 'vertical' ? 'mb-12' : 'mb-6'" x-text="texts.boxLabel3"></span>
                                        </div>
                                    </template>

                                    <!-- Number Input / Display -->
                                    <div class="relative z-10 w-full px-4">
                                        <input type="number" 
                                               x-model="value"
                                               placeholder="&mdash;"
                                               @input="if($el.value > 100) value = 100; if($el.value < 0) value = 0;"
                                               class="bg-transparent text-white font-bold tabular-nums leading-none tracking-tighter text-center w-full focus:outline-none border-b-2 border-transparent transition-all duration-200 p-0 shadow-none ring-0 appearance-none font-inter placeholder-white/20"
                                               :class="[
                                                    orientation === 'vertical' ? 'text-5xl md:text-7xl' : 'text-5xl md:text-7xl',
                                                    mode === 'respond' ? 'hover:text-white focus:border-webropol-primary-400 cursor-text' : 'pointer-events-none'
                                               ]">
                                    </div>
                                </div>
                            </div>

                            <!-- Scale Section -->
                            <div class="flex-shrink-0 select-none transition-all duration-500 ease-in-out"
                                 :class="orientation === 'vertical' ? 'w-full md:w-80 pt-2' : 'w-full mt-8 md:mt-12'">
                                
                                <!-- Vertical Layout -->
                                <template x-if="orientation === 'vertical'">
                                    <div>
                                        <!-- Top Label (Best) -->
                                        <div class="flex items-center justify-end gap-4 mb-8 pr-2 group">
                                            <div class="flex flex-col items-end text-webropol-primary-700 font-bold text-xs tracking-widest uppercase leading-tight">
                                                <template x-if="mode === 'edit'">
                                                    <div class="flex flex-col items-end gap-1">
                                                        <input x-model="texts.bestLabel1" class="text-right bg-transparent border-b border-transparent hover:border-webropol-primary-200 focus:outline-none w-24">
                                                        <input x-model="texts.bestLabel2" class="text-right bg-transparent border-b border-transparent hover:border-webropol-primary-200 focus:outline-none w-24">
                                                        <input x-model="texts.bestLabel3" class="text-right bg-transparent border-b border-transparent hover:border-webropol-primary-200 focus:outline-none w-24">
                                                    </div>
                                                </template>
                                                <template x-if="mode === 'respond'">
                                                    <div class="flex flex-col items-end">
                                                        <span x-text="texts.bestLabel1"></span>
                                                        <span x-text="texts.bestLabel2"></span>
                                                        <span x-text="texts.bestLabel3"></span>
                                                    </div>
                                                </template>
                                            </div>
                                            <div class="w-12 h-12 rounded-full bg-webropol-primary-50 text-webropol-primary-700 flex items-center justify-center border border-webropol-primary-100 shadow-sm transition-transform group-hover:scale-105">
                                                <i class="fa-regular fa-face-smile text-2xl"></i>
                                            </div>
                                        </div>
                                        
                                        <!-- Vertical Track -->
                                        <div class="relative h-[400px] sm:h-[600px] w-full" 
                                             @mousedown="startDrag"
                                             @touchstart.prevent="startDrag"
                                             x-ref="trackVertical">
                                            
                                            <!-- Interaction Hint -->
                                            <div x-show="value === null" 
                                                 class="absolute right-28 top-1/2 -translate-y-1/2 pointer-events-none transition-opacity duration-500 hidden sm:block"
                                                 x-transition:leave="duration-500">
                                                <div class="text-webropol-gray-400 font-bold tracking-[0.25em] text-xs uppercase opacity-70 animate-pulse" 
                                                     style="writing-mode: vertical-rl; transform: rotate(180deg);">
                                                    Tap scale to select value
                                                </div>
                                            </div>

                                            <!-- Ticks -->
                                            <template x-for="i in 101">
                                                <div class="absolute right-0 w-full flex items-center justify-end pointer-events-none"
                                                     :style="`top: ${100 - (i-1)}%; transform: translateY(-50%);`">
                                                    <span x-show="(i-1) % 10 === 0" class="mr-4 text-webropol-gray-500 font-medium text-lg w-8 text-right tabular-nums select-none" x-text="i-1"></span>
                                                    <div class="h-px bg-gray-400" :class="(i-1) % 10 === 0 ? 'w-8 bg-gray-500' : 'w-4'"></div>
                                                </div>
                                            </template>

                                            <!-- Click Area -->
                                            <div class="absolute inset-y-0 right-0 w-32 cursor-pointer z-10"
                                                 @mousemove="onDrag" @touchmove.prevent="onDrag" @mouseup.window="stopDrag" @touchend.window="stopDrag" @click="updateValue"></div>

                                            <!-- Vertical Indicators -->
                                            <div x-show="value !== null" class="absolute w-full pointer-events-none transition-all duration-75 ease-out z-20"
                                                 :style="`top: ${100 - (value ?? 50)}%; transform: translateY(-50%);`">
                                                <div class="absolute right-4 top-1/2 -translate-y-1/2 w-48 border-t-2 border-webropol-gray-400 border-dotted"></div>
                                                <div class="absolute right-[190px] top-1/2 -translate-y-1/2 text-5xl text-[#5c7ae0] font-medium pr-1 flex items-center gap-1">
                                                    <span x-text="Math.round(value)"></span>
                                                    <div class="w-0 h-0 border-t-[8px] border-t-transparent border-b-[8px] border-b-transparent border-l-[14px] border-l-[#5c7ae0]"></div>
                                                </div>
                                                <div class="absolute right-[4px] top-1/2 -translate-y-1/2 w-6 h-6 bg-[#ee4036] rounded-full shadow-[0_4px_6px_rgba(0,0,0,0.3)] z-30 ring-2 ring-white scale-125 transition-transform hover:scale-150"></div>
                                            </div>
                                        </div>
                                        
                                        <!-- Bottom Label (Worst) -->
                                        <div class="flex items-center justify-end gap-4 mt-8 pr-2 group">
                                            <div class="flex flex-col items-end text-webropol-gray-500 font-bold text-xs tracking-widest uppercase leading-tight">
                                                <template x-if="mode === 'edit'">
                                                    <div class="flex flex-col items-end gap-1">
                                                        <input x-model="texts.worstLabel1" class="text-right bg-transparent border-b border-transparent hover:border-webropol-gray-300 focus:outline-none w-24">
                                                        <input x-model="texts.worstLabel2" class="text-right bg-transparent border-b border-transparent hover:border-webropol-gray-300 focus:outline-none w-24">
                                                        <input x-model="texts.worstLabel3" class="text-right bg-transparent border-b border-transparent hover:border-webropol-gray-300 focus:outline-none w-24">
                                                    </div>
                                                </template>
                                                <template x-if="mode === 'respond'">
                                                    <div class="flex flex-col items-end">
                                                        <span x-text="texts.worstLabel1"></span>
                                                        <span x-text="texts.worstLabel2"></span>
                                                        <span x-text="texts.worstLabel3"></span>
                                                    </div>
                                                </template>
                                            </div>
                                            <div class="w-12 h-12 rounded-full bg-webropol-gray-50 text-webropol-gray-900 flex items-center justify-center border border-webropol-gray-200 shadow-sm transition-transform group-hover:scale-105">
                                                <i class="fa-regular fa-face-frown text-2xl"></i>
                                            </div>
                                        </div>
                                    </div>
                                </template>

                                <!-- Horizontal Layout -->
                                <template x-if="orientation === 'horizontal'">
                                    <div class="w-full pt-10 px-4 md:px-16 relative">
                                        <!-- Horizontal Label Row for Icons -->
                                        <div class="flex justify-between items-end mb-4 relative z-0">
                                            <!-- Worst Label (Left) -->
                                            <div class="flex flex-col items-center gap-2 ml-0 md:-ml-8">
                                                <div class="w-12 h-12 rounded-full bg-webropol-gray-50 text-webropol-gray-900 flex items-center justify-center border border-webropol-gray-200 shadow-sm">
                                                    <i class="fa-regular fa-face-frown text-2xl"></i>
                                                </div>
                                                <div class="flex flex-col items-center text-webropol-gray-500 font-bold text-xs tracking-widest uppercase leading-tight text-center">
                                                    <span x-text="texts.worstLabel1"></span>
                                                    <span x-text="texts.worstLabel2"></span>
                                                    <span x-text="texts.worstLabel3"></span>
                                                </div>
                                            </div>
                                            
                                            <!-- Best Label (Right) -->
                                            <div class="flex flex-col items-center gap-2 mr-0 md:-mr-8">
                                                <div class="w-12 h-12 rounded-full bg-webropol-primary-50 text-webropol-primary-700 flex items-center justify-center border border-webropol-primary-100 shadow-sm">
                                                    <i class="fa-regular fa-face-smile text-2xl"></i>
                                                </div>
                                                <div class="flex flex-col items-center text-webropol-primary-700 font-bold text-xs tracking-widest uppercase leading-tight text-center">
                                                    <span x-text="texts.bestLabel1"></span>
                                                    <span x-text="texts.bestLabel2"></span>
                                                    <span x-text="texts.bestLabel3"></span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Horizontal Track -->
                                        <div class="relative w-full h-32" 
                                             @mousedown="startDragHorizontal"
                                             @touchstart.prevent="startDragHorizontal"
                                             x-ref="trackHorizontal">
                                            
                                            <!-- Interaction Hint -->
                                            <div x-show="value === null" 
                                                 class="absolute top-24 left-1/2 -translate-x-1/2 pointer-events-none transition-opacity duration-500"
                                                 x-transition:leave="duration-500">
                                                <div class="text-webropol-gray-400 font-bold tracking-[0.25em] text-xs uppercase opacity-70 animate-pulse whitespace-nowrap">
                                                    Tap scale to select value
                                                </div>
                                            </div>

                                            <!-- Ticks -->
                                            <template x-for="i in 101">
                                                <div class="absolute top-0 h-full flex flex-col items-center pointer-events-none"
                                                     :style="`left: ${(i-1)}%; transform: translateX(-50%);`"> <!-- 0 is left -->
                                                    <!-- Tick Mark -->
                                                    <div class="w-px bg-gray-400" :class="(i-1) % 10 === 0 ? 'h-8 bg-gray-500' : 'h-4'"></div>
                                                    <!-- Number -->
                                                    <span x-show="(i-1) % 10 === 0" class="mt-2 text-webropol-gray-500 font-medium text-lg text-center tabular-nums select-none" x-text="i-1"></span>
                                                </div>
                                            </template>

                                            <!-- Click Area -->
                                            <div class="absolute -inset-x-4 inset-y-0 cursor-pointer z-10"
                                                 @mousemove="onDragHorizontal" @touchmove.prevent="onDragHorizontal" @mouseup.window="stopDrag" @touchend.window="stopDrag" @click="updateValueHorizontal"></div>

                                            <!-- Horizontal Indicators -->
                                            <div x-show="value !== null" class="absolute h-full pointer-events-none transition-all duration-75 ease-out z-20"
                                                 :style="`left: ${value ?? 50}%; transform: translateX(-50%);`"> <!-- 0 is left -->
                                                
                                                <!-- Dotted line up -->
                                                <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 h-24 border-l-2 border-webropol-gray-400 border-dotted"></div>
                                                
                                                <!-- Value Box -->
                                                <div class="absolute bottom-[232px] left-1/2 -translate-x-1/2 flex flex-col items-center">
                                                    <div class="text-5xl text-[#5c7ae0] font-medium flex items-center gap-1 bg-white px-2 py-1 rounded shadow-sm border border-gray-50">
                                                        <span x-text="Math.round(value)"></span>
                                                    </div>
                                                    <!-- Triangle Pointing Down -->
                                                    <div class="w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-transparent border-t-[14px] border-t-[#5c7ae0]"></div>
                                                </div>

                                                <!-- Handle Red Dot -->
                                                <div class="absolute top-0 left-1/2 -translate-x-1/2 -mt-[4px] w-6 h-6 bg-[#ee4036] rounded-full shadow-md z-30 ring-2 ring-white scale-125"></div>
                                            </div>
                                        </div>
                                    </div>
                                </template>

                            </div>
                        </div>
                    </div>

                <!-- Settings Modal -->
                <div x-show="showSettings" 
                     class="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm transition-opacity"
                     x-transition.opacity
                     style="display: none;">
                    
                    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden scale-100 transition-transform"
                         @click.away="showSettings = false">
                        <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                            <h3 class="font-bold text-lg text-webropol-gray-900">Health Meter Settings</h3>
                            <button @click="showSettings = false" class="text-gray-400 hover:text-gray-600"><i class="fa-light fa-times text-xl"></i></button>
                        </div>
                        
                        <div class="p-6">
                            <label class="block text-sm font-semibold text-webropol-gray-700 mb-4 uppercase tracking-wider">Scale Orientation</label>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <label class="cursor-pointer group">
                                    <input type="radio" name="orientation" value="vertical" x-model="orientation" class="hidden peer">
                                    <div class="border-2 border-gray-200 peer-checked:border-webropol-primary-500 rounded-lg p-4 flex flex-col items-center gap-3 transition-all bg-white hover:bg-gray-50 peer-checked:bg-webropol-primary-50">
                                        <div class="h-16 w-6 border-r border-gray-400 border-dashed"></div>
                                        <span class="font-medium text-gray-600 peer-checked:text-webropol-primary-700">Vertical</span>
                                    </div>
                                </label>
                                
                                <label class="cursor-pointer group">
                                    <input type="radio" name="orientation" value="horizontal" x-model="orientation" class="hidden peer">
                                    <div class="border-2 border-gray-200 peer-checked:border-webropol-primary-500 rounded-lg p-4 flex flex-col items-center gap-3 transition-all bg-white hover:bg-gray-50 peer-checked:bg-webropol-primary-50">
                                        <div class="w-16 h-6 border-b border-gray-400 border-dashed"></div>
                                        <span class="font-medium text-gray-600 peer-checked:text-webropol-primary-700">Horizontal</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                        
                        <div class="px-6 py-4 bg-gray-50 border-t border-gray-100 text-right">
                            <button @click="showSettings = false" class="px-4 py-2 bg-webropol-primary-600 hover:bg-webropol-primary-700 text-white rounded-lg font-medium transition-colors">Done</button>
                        </div>
                    </div>
                </div>
                </div>

            </main>
        </div>
    </div>

    <!-- Override modal z-index when active per instructions -->
    <style>
        /* Hide number input spinners */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        body:has(.fixed.z-\[100\]) webropol-header,
        body:has(.fixed.z-\[100\]) webropol-sidebar {
            z-index: 1 !important;
        }
    </style>

    <script>
        function moduleApp() {
            return {
                fullscreen: false,
                init() { console.log('App initialized'); }
            }
        }

        function healthSlider() {
            return {
                mode: 'edit', // 'edit' | 'respond'
                orientation: 'vertical', // 'vertical' | 'horizontal'
                value: null,
                dragging: false,
                showSettings: false,
                
                texts: {
                    title: 'Health State Today',
                    subtitle: 'EQ-5D Visual Analogue Scale',
                    instructions: `We would like to know how good or bad your health is TODAY.
You will see a scale numbered from 0 to 100.
100 means the best health you can imagine.
0 means the worst health you can imagine.
Please indicate on the scale how your health is TODAY.`,
                    boxLabel1: 'YOUR',
                    boxLabel2: 'HEALTH',
                    boxLabel3: 'TODAY',
                    bestLabel1: 'Best health',
                    bestLabel2: 'you can',
                    bestLabel3: 'imagine',
                    worstLabel1: 'Worst health',
                    worstLabel2: 'you can',
                    worstLabel3: 'imagine'
                },
                
                // Vertical Logic
                updateFromEvent(e) {
                    const track = this.$refs.trackVertical;
                    if (!track) return;
                    const rect = track.getBoundingClientRect();
                    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                    
                    let relativeY = clientY - rect.top;
                    if (relativeY < 0) relativeY = 0;
                    if (relativeY > rect.height) relativeY = rect.height;
                    
                    const percent = 100 - (relativeY / rect.height * 100);
                    this.value = Math.round(percent);
                },

                // Horizontal Logic
                updateFromEventHorizontal(e) {
                    const track = this.$refs.trackHorizontal;
                    if (!track) return;
                    const rect = track.getBoundingClientRect();
                    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                    
                    // Left is 0, Right is 100
                    let relativeX = clientX - rect.left;
                    if (relativeX < 0) relativeX = 0;
                    if (relativeX > rect.width) relativeX = rect.width;
                    
                    const percent = (relativeX / rect.width * 100);
                    this.value = Math.round(percent);
                },
                
                startDrag(e) { this.dragging = true; this.updateFromEvent(e); },
                startDragHorizontal(e) { this.dragging = true; this.updateFromEventHorizontal(e); },
                
                onDrag(e) { if (!this.dragging) return; this.updateFromEvent(e); },
                onDragHorizontal(e) { if (!this.dragging) return; this.updateFromEventHorizontal(e); },
                
                stopDrag() { this.dragging = false; },
                
                updateValue(e) { this.updateFromEvent(e); },
                updateValueHorizontal(e) { this.updateFromEventHorizontal(e); }
            }
        }
    </script>
</body>
</html>

</body>
</html>
